{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": false
   },
   "source": [
    "\n",
    "# 一、赛题介绍\n",
    "## 1. 赛题简介\n",
    "PALM病理性近视预测常规赛的重点是研究和发展与病理性近视诊断相关的算法。该常规赛的目标是评估和比较在一个常见的视网膜眼底图像数据集上检测病理性近视的自动算法。具体任务是将提供的图像分为病理性近视眼底彩照和非病理性近视眼底彩照，其中，非病理性近视眼底彩照包括正常眼底和高度近视眼底彩照。\n",
    "\n",
    " ![](https://ai.bdstatic.com/file/EB6E1DA97ECE4AE79697FD6F6A25F679)\n",
    "\n",
    "## 2.数据简介\n",
    "PALM病理性近视预测常规赛由中山大学中山眼科中心提供800张带病理性近视分类标注的眼底彩照供选手训练模型，另提供400张带标注数据供平台进行模型测试。\n",
    "\n",
    "## 3. 数据说明\n",
    "本次常规赛提供的病理性近视分类金标准是从临床报告中获取，不仅基于眼底彩照，还结合了OCT、视野检查等结果。\n",
    "\n",
    "## 4. 训练数据集\n",
    "文件名称：Train\n",
    "Train文件夹里有一个fundus_image文件夹和一个Classification.xlsx文件。fundus_image文件夹中数据均为眼底彩照，分辨率为1444×1444，或2124×2056。命名形如N0001.jpg、H0001.jpg、P0001.jpg和V0001.jpg。Classification.xlsx文件中为各眼底图像是否属于病理性近视，属于为1，不属于为0。\n",
    "\n",
    "## 5.测试数据集\n",
    "文件名称：PALM-Testing400-Images 文件夹里包含400张眼底彩照，命名形如T0001.jpg。\n",
    "\n",
    "## 6.提交内容及格式\n",
    "分类结果应在一个名为“Classification_Results.csv”的CSV文件中提供，第一列对应测试眼底图像的文件名(包括扩展名“.jpg”)，对应title为FileName；第二列包含诊断为PM的患者图像的分类预测概率(值从0.0到1.0)，对应title为PM Risk。示例如下：\n",
    "\n",
    "![](https://ai.bdstatic.com/file/9B4E52D17D184A0893853C7A3A726BFA)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": false
   },
   "source": [
    "# 二、数据处理"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": false
   },
   "source": [
    "## 1.获取数据\n",
    "* 解压缩\n",
    "* 重命名文件夹\n",
    "* 删除临时文件夹"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "!unzip -oq /home/aistudio/data/data93479/PALM.zip"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "!mv '常规赛：PALM病理性近视预测' dataset"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "!rm __MACOSX/ -rf"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": false
   },
   "source": [
    "## 2.GPU设置、包引入"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Looking in indexes: https://mirror.baidu.com/pypi/simple\n",
      "Collecting paddlex\n",
      "\u001b[?25l  Downloading https://mirror.baidu.com/pypi/packages/d6/a2/07435f4aa1e51fe22bdf06c95d03bf1b78b7bc6625adbb51e35dc0804cc7/paddlex-1.3.11-py3-none-any.whl (516kB)\n",
      "\u001b[K     |████████████████████████████████| 522kB 15.7MB/s eta 0:00:01\n",
      "\u001b[?25hRequirement already satisfied: visualdl>=2.0.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlex) (2.2.0)\n",
      "Requirement already satisfied: flask-cors in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlex) (3.0.8)\n",
      "Collecting paddlehub==2.1.0 (from paddlex)\n",
      "\u001b[?25l  Downloading https://mirror.baidu.com/pypi/packages/7a/29/3bd0ca43c787181e9c22fe44b944b64d7fcb14ce66d3bf4602d9ad2ac76c/paddlehub-2.1.0-py3-none-any.whl (211kB)\n",
      "\u001b[K     |████████████████████████████████| 215kB 50.5MB/s eta 0:00:01\n",
      "\u001b[?25hCollecting shapely>=1.7.0 (from paddlex)\n",
      "\u001b[?25l  Downloading https://mirror.baidu.com/pypi/packages/98/f8/db4d3426a1aba9d5dfcc83ed5a3e2935d2b1deb73d350642931791a61c37/Shapely-1.7.1-cp37-cp37m-manylinux1_x86_64.whl (1.0MB)\n",
      "\u001b[K     |████████████████████████████████| 1.0MB 18.2MB/s eta 0:00:01\n",
      "\u001b[?25hCollecting paddleslim==1.1.1 (from paddlex)\n",
      "\u001b[?25l  Downloading https://mirror.baidu.com/pypi/packages/d1/77/e257227bed9a70ff0d35a4a3c4e70ac2d2362c803834c4c52018f7c4b762/paddleslim-1.1.1-py2.py3-none-any.whl (145kB)\n",
      "\u001b[K     |████████████████████████████████| 153kB 21.7MB/s eta 0:00:01\n",
      "\u001b[?25hRequirement already satisfied: psutil in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlex) (5.7.2)\n",
      "Requirement already satisfied: tqdm in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlex) (4.36.1)\n",
      "Requirement already satisfied: sklearn in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlex) (0.0)\n",
      "Requirement already satisfied: colorama in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlex) (0.4.4)\n",
      "Requirement already satisfied: pyyaml in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlex) (5.1.2)\n",
      "Collecting pycocotools; platform_system != \"Windows\" (from paddlex)\n",
      "  Downloading https://mirror.baidu.com/pypi/packages/de/df/056875d697c45182ed6d2ae21f62015896fdb841906fe48e7268e791c467/pycocotools-2.0.2.tar.gz\n",
      "Requirement already satisfied: opencv-python in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlex) (4.1.1.26)\n",
      "Collecting xlwt (from paddlex)\n",
      "\u001b[?25l  Downloading https://mirror.baidu.com/pypi/packages/44/48/def306413b25c3d01753603b1a222a011b8621aed27cd7f89cbc27e6b0f4/xlwt-1.3.0-py2.py3-none-any.whl (99kB)\n",
      "\u001b[K     |████████████████████████████████| 102kB 27.0MB/s ta 0:00:01\n",
      "\u001b[?25hRequirement already satisfied: matplotlib in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from visualdl>=2.0.0->paddlex) (2.2.3)\n",
      "Requirement already satisfied: Pillow>=7.0.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from visualdl>=2.0.0->paddlex) (7.1.2)\n",
      "Requirement already satisfied: Flask-Babel>=1.0.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from visualdl>=2.0.0->paddlex) (1.0.0)\n",
      "Requirement already satisfied: flake8>=3.7.9 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from visualdl>=2.0.0->paddlex) (3.8.2)\n",
      "Requirement already satisfied: pandas in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from visualdl>=2.0.0->paddlex) (1.1.5)\n",
      "Requirement already satisfied: numpy in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from visualdl>=2.0.0->paddlex) (1.20.3)\n",
      "Requirement already satisfied: flask>=1.1.1 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from visualdl>=2.0.0->paddlex) (1.1.1)\n",
      "Requirement already satisfied: shellcheck-py in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from visualdl>=2.0.0->paddlex) (0.7.1.1)\n",
      "Requirement already satisfied: requests in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from visualdl>=2.0.0->paddlex) (2.22.0)\n",
      "Requirement already satisfied: bce-python-sdk in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from visualdl>=2.0.0->paddlex) (0.8.53)\n",
      "Requirement already satisfied: six>=1.14.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from visualdl>=2.0.0->paddlex) (1.15.0)\n",
      "Requirement already satisfied: protobuf>=3.11.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from visualdl>=2.0.0->paddlex) (3.14.0)\n",
      "Requirement already satisfied: pre-commit in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from visualdl>=2.0.0->paddlex) (1.21.0)\n",
      "Requirement already satisfied: rarfile in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub==2.1.0->paddlex) (3.1)\n",
      "Requirement already satisfied: colorlog in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub==2.1.0->paddlex) (4.1.0)\n",
      "Requirement already satisfied: gunicorn>=19.10.0; sys_platform != \"win32\" in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub==2.1.0->paddlex) (20.0.4)\n",
      "Collecting paddle2onnx>=0.5.1 (from paddlehub==2.1.0->paddlex)\n",
      "\u001b[?25l  Downloading https://mirror.baidu.com/pypi/packages/37/80/aa6134b5f36aea45dc1b363e7af941dccabe4d7e167ac391ff046f34baf1/paddle2onnx-0.7-py3-none-any.whl (94kB)\n",
      "\u001b[K     |████████████████████████████████| 102kB 29.7MB/s ta 0:00:01\n",
      "\u001b[?25hRequirement already satisfied: easydict in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub==2.1.0->paddlex) (1.9)\n",
      "Requirement already satisfied: paddlenlp>=2.0.0rc5 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub==2.1.0->paddlex) (2.0.0rc7)\n",
      "Requirement already satisfied: gitpython in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub==2.1.0->paddlex) (3.1.14)\n",
      "Requirement already satisfied: filelock in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub==2.1.0->paddlex) (3.0.12)\n",
      "Requirement already satisfied: pyzmq in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub==2.1.0->paddlex) (18.1.1)\n",
      "Requirement already satisfied: packaging in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub==2.1.0->paddlex) (20.9)\n",
      "Requirement already satisfied: scikit-learn in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from sklearn->paddlex) (0.24.2)\n",
      "Requirement already satisfied: setuptools>=18.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from pycocotools; platform_system != \"Windows\"->paddlex) (56.2.0)\n",
      "Requirement already satisfied: cython>=0.27.3 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from pycocotools; platform_system != \"Windows\"->paddlex) (0.29)\n",
      "Requirement already satisfied: pytz in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from matplotlib->visualdl>=2.0.0->paddlex) (2019.3)\n",
      "Requirement already satisfied: cycler>=0.10 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from matplotlib->visualdl>=2.0.0->paddlex) (0.10.0)\n",
      "Requirement already satisfied: kiwisolver>=1.0.1 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from matplotlib->visualdl>=2.0.0->paddlex) (1.1.0)\n",
      "Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,>=2.0.1 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from matplotlib->visualdl>=2.0.0->paddlex) (2.4.2)\n",
      "Requirement already satisfied: python-dateutil>=2.1 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from matplotlib->visualdl>=2.0.0->paddlex) (2.8.0)\n",
      "Requirement already satisfied: Babel>=2.3 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from Flask-Babel>=1.0.0->visualdl>=2.0.0->paddlex) (2.8.0)\n",
      "Requirement already satisfied: Jinja2>=2.5 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from Flask-Babel>=1.0.0->visualdl>=2.0.0->paddlex) (2.10.1)\n",
      "Requirement already satisfied: mccabe<0.7.0,>=0.6.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from flake8>=3.7.9->visualdl>=2.0.0->paddlex) (0.6.1)\n",
      "Requirement already satisfied: pyflakes<2.3.0,>=2.2.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from flake8>=3.7.9->visualdl>=2.0.0->paddlex) (2.2.0)\n",
      "Requirement already satisfied: pycodestyle<2.7.0,>=2.6.0a1 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from flake8>=3.7.9->visualdl>=2.0.0->paddlex) (2.6.0)\n",
      "Requirement already satisfied: importlib-metadata; python_version < \"3.8\" in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from flake8>=3.7.9->visualdl>=2.0.0->paddlex) (0.23)\n",
      "Requirement already satisfied: click>=5.1 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from flask>=1.1.1->visualdl>=2.0.0->paddlex) (7.0)\n",
      "Requirement already satisfied: itsdangerous>=0.24 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from flask>=1.1.1->visualdl>=2.0.0->paddlex) (1.1.0)\n",
      "Requirement already satisfied: Werkzeug>=0.15 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from flask>=1.1.1->visualdl>=2.0.0->paddlex) (0.16.0)\n",
      "Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from requests->visualdl>=2.0.0->paddlex) (1.25.6)\n",
      "Requirement already satisfied: certifi>=2017.4.17 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from requests->visualdl>=2.0.0->paddlex) (2019.9.11)\n",
      "Requirement already satisfied: chardet<3.1.0,>=3.0.2 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from requests->visualdl>=2.0.0->paddlex) (3.0.4)\n",
      "Requirement already satisfied: idna<2.9,>=2.5 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from requests->visualdl>=2.0.0->paddlex) (2.8)\n",
      "Requirement already satisfied: pycryptodome>=3.8.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from bce-python-sdk->visualdl>=2.0.0->paddlex) (3.9.9)\n",
      "Requirement already satisfied: future>=0.6.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from bce-python-sdk->visualdl>=2.0.0->paddlex) (0.18.0)\n",
      "Requirement already satisfied: virtualenv>=15.2 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from pre-commit->visualdl>=2.0.0->paddlex) (16.7.9)\n",
      "Requirement already satisfied: identify>=1.0.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from pre-commit->visualdl>=2.0.0->paddlex) (1.4.10)\n",
      "Requirement already satisfied: aspy.yaml in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from pre-commit->visualdl>=2.0.0->paddlex) (1.3.0)\n",
      "Requirement already satisfied: cfgv>=2.0.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from pre-commit->visualdl>=2.0.0->paddlex) (2.0.1)\n",
      "Requirement already satisfied: nodeenv>=0.11.1 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from pre-commit->visualdl>=2.0.0->paddlex) (1.3.4)\n",
      "Requirement already satisfied: toml in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from pre-commit->visualdl>=2.0.0->paddlex) (0.10.0)\n",
      "Requirement already satisfied: h5py in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlenlp>=2.0.0rc5->paddlehub==2.1.0->paddlex) (2.9.0)\n",
      "Requirement already satisfied: seqeval in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlenlp>=2.0.0rc5->paddlehub==2.1.0->paddlex) (1.2.2)\n",
      "Requirement already satisfied: jieba in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlenlp>=2.0.0rc5->paddlehub==2.1.0->paddlex) (0.42.1)\n",
      "Requirement already satisfied: gitdb<5,>=4.0.1 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from gitpython->paddlehub==2.1.0->paddlex) (4.0.5)\n",
      "Requirement already satisfied: scipy>=0.19.1 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from scikit-learn->sklearn->paddlex) (1.6.3)\n",
      "Requirement already satisfied: threadpoolctl>=2.0.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from scikit-learn->sklearn->paddlex) (2.1.0)\n",
      "Requirement already satisfied: joblib>=0.11 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from scikit-learn->sklearn->paddlex) (0.14.1)\n",
      "Requirement already satisfied: MarkupSafe>=0.23 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from Jinja2>=2.5->Flask-Babel>=1.0.0->visualdl>=2.0.0->paddlex) (1.1.1)\n",
      "Requirement already satisfied: zipp>=0.5 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from importlib-metadata; python_version < \"3.8\"->flake8>=3.7.9->visualdl>=2.0.0->paddlex) (0.6.0)\n",
      "Requirement already satisfied: smmap<4,>=3.0.1 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from gitdb<5,>=4.0.1->gitpython->paddlehub==2.1.0->paddlex) (3.0.5)\n",
      "Requirement already satisfied: more-itertools in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from zipp>=0.5->importlib-metadata; python_version < \"3.8\"->flake8>=3.7.9->visualdl>=2.0.0->paddlex) (7.2.0)\n",
      "Building wheels for collected packages: pycocotools\n",
      "  Building wheel for pycocotools (setup.py) ... \u001b[?25ldone\n",
      "\u001b[?25h  Created wheel for pycocotools: filename=pycocotools-2.0.2-cp37-cp37m-linux_x86_64.whl size=278366 sha256=9b7621d158c86291bb9ab1cbc3adc69d9abf81a634ff606e8b8780b61aa1774c\n",
      "  Stored in directory: /home/aistudio/.cache/pip/wheels/fb/44/67/8baa69040569b1edbd7776ec6f82c387663e724908aaa60963\n",
      "Successfully built pycocotools\n",
      "Installing collected packages: paddle2onnx, paddlehub, shapely, paddleslim, pycocotools, xlwt, paddlex\n",
      "  Found existing installation: paddlehub 2.0.4\n",
      "    Uninstalling paddlehub-2.0.4:\n",
      "      Successfully uninstalled paddlehub-2.0.4\n",
      "Successfully installed paddle2onnx-0.7 paddlehub-2.1.0 paddleslim-1.1.1 paddlex-1.3.11 pycocotools-2.0.2 shapely-1.7.1 xlwt-1.3.0\n"
     ]
    }
   ],
   "source": [
    "#安装paddlex\r\n",
    "! pip install paddlex -i https://mirror.baidu.com/pypi/simple"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/paddle/fluid/layers/utils.py:26: DeprecationWarning: `np.int` is a deprecated alias for the builtin `int`. To silence this warning, use `int` by itself. Doing this will not modify any behavior and is safe. When replacing `np.int`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.\n",
      "Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations\n",
      "  def convert_to_list(value, n, name, dtype=np.int):\n"
     ]
    }
   ],
   "source": [
    "# 设置使用0号GPU卡（如无GPU，执行此代码后仍然会使用CPU训练模型）\r\n",
    "import matplotlib\r\n",
    "matplotlib.use('Agg') \r\n",
    "import os\r\n",
    "os.environ['CUDA_VISIBLE_DEVICES'] = '0'\r\n",
    "import paddlex as pdx"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": false
   },
   "source": [
    "## 3.划分训练集和测试集"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "# 划分训练集和测试集\r\n",
    "\r\n",
    "import pandas as pd\r\n",
    "import random\r\n",
    "\r\n",
    "train_excel_file = 'dataset/Train/Classification.xlsx'\r\n",
    "pd_list=pd.read_excel(train_excel_file)\r\n",
    "\r\n",
    "pd_list_lenght=len(pd_list)\r\n",
    "# 乱序\r\n",
    "pd_list=pd_list.sample(frac=1)\r\n",
    "offset=int(pd_list_lenght*0.9)\r\n",
    "trian_list=pd_list[:offset]\r\n",
    "eval_list=pd_list[offset:]\r\n",
    "trian_list.to_csv(\"train_list.txt\", index=None, header=None, sep=' ')\r\n",
    "eval_list.to_csv(\"eval_list.txt\", index=None, header=None, sep=' ')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": false
   },
   "source": [
    "## 4.数据增强"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "\r\n",
    "from paddlex.cls import transforms\r\n",
    "train_transforms = transforms.Compose([\r\n",
    "    transforms.RandomCrop(crop_size=1440),\r\n",
    "    transforms.RandomHorizontalFlip(),\r\n",
    "    transforms.Normalize()\r\n",
    "])\r\n",
    "eval_transforms = transforms.Compose([\r\n",
    "    transforms.ResizeByShort(short_size=1444),\r\n",
    "    transforms.CenterCrop(crop_size=1440),\r\n",
    "    transforms.Normalize()\r\n",
    "])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": false
   },
   "source": [
    "## 5.数据集配置"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2021-07-29 19:26:28 [INFO]\tStarting to read file list from dataset...\n",
      "2021-07-29 19:26:28 [INFO]\t720 samples in file train_list.txt\n",
      "2021-07-29 19:26:28 [INFO]\tStarting to read file list from dataset...\n",
      "2021-07-29 19:26:28 [INFO]\t80 samples in file eval_list.txt\n"
     ]
    }
   ],
   "source": [
    "train_dataset = pdx.datasets.ImageNet(\r\n",
    "    data_dir='dataset/Train/fundus_image',\r\n",
    "    file_list='train_list.txt',\r\n",
    "    label_list='labels.txt',\r\n",
    "    transforms=train_transforms,\r\n",
    "    shuffle=True)\r\n",
    "eval_dataset = pdx.datasets.ImageNet(\r\n",
    "    data_dir='dataset/Train/fundus_image',\r\n",
    "    file_list='eval_list.txt',\r\n",
    "    label_list='labels.txt',\r\n",
    "    transforms=eval_transforms)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": false
   },
   "source": [
    "# 四、开始训练"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/paddle/fluid/framework.py:687: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.\n",
      "Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations\n",
      "  elif dtype == np.bool:\n",
      "/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/paddle/fluid/layers/math_op_patch.py:298: UserWarning: /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/paddlex/cv/nets/mobilenet_v3.py:231\n",
      "The behavior of expression A * B has been unified with elementwise_mul(X, Y, axis=-1) from Paddle 2.0. If your code works well in the older versions but crashes in this version, try to use elementwise_mul(X, Y, axis=0) instead of A * B. This transitional warning will be dropped in the future.\n",
      "  op_type, op_type, EXPRESSION_MAP[method_name]))\n",
      "2021-07-29 19:26:31,993 - INFO - If regularizer of a Parameter has been set by 'fluid.ParamAttr' or 'fluid.WeightNormParamAttr' already. The Regularization[L2Decay, regularization_coeff=0.000100] in Optimizer will not take effect, and it will only be applied to other Parameters!\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2021-07-29 19:26:32 [INFO]\tDecompressing output/mobilenetv3_small_ssld/pretrain/MobileNetV3_small_x1_0_ssld_pretrained.tar...\n",
      "2021-07-29 19:26:38 [INFO]\tLoad pretrain weights from output/mobilenetv3_small_ssld/pretrain/MobileNetV3_small_x1_0_ssld_pretrained.\n",
      "2021-07-29 19:26:38 [WARNING]\t[SKIP] Shape of pretrained weight output/mobilenetv3_small_ssld/pretrain/MobileNetV3_small_x1_0_ssld_pretrained/fc_weights doesn't match.(Pretrained: (1280, 1000), Actual: (1280, 2))\n",
      "2021-07-29 19:26:38 [WARNING]\t[SKIP] Shape of pretrained weight output/mobilenetv3_small_ssld/pretrain/MobileNetV3_small_x1_0_ssld_pretrained/fc_offset doesn't match.(Pretrained: (1000,), Actual: (2,))\n",
      "2021-07-29 19:26:38 [INFO]\tThere are 212 varaibles in output/mobilenetv3_small_ssld/pretrain/MobileNetV3_small_x1_0_ssld_pretrained are loaded.\n",
      "2021-07-29 19:26:46 [INFO]\t[TRAIN] Epoch=1/32, Step=2/90, loss=0.591019, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=4.0s, eta=3:33:10\n",
      "2021-07-29 19:26:49 [INFO]\t[TRAIN] Epoch=1/32, Step=4/90, loss=0.30328, acc1=0.75, acc2=1.0, lr=0.025, time_each_step=2.6s, eta=2:18:27\n",
      "2021-07-29 19:26:51 [INFO]\t[TRAIN] Epoch=1/32, Step=6/90, loss=0.582819, acc1=0.75, acc2=1.0, lr=0.025, time_each_step=2.13s, eta=1:53:28\n",
      "2021-07-29 19:26:53 [INFO]\t[TRAIN] Epoch=1/32, Step=8/90, loss=0.163927, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.89s, eta=1:40:22\n",
      "2021-07-29 19:26:55 [INFO]\t[TRAIN] Epoch=1/32, Step=10/90, loss=0.062989, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.73s, eta=1:32:1\n",
      "2021-07-29 19:26:58 [INFO]\t[TRAIN] Epoch=1/32, Step=12/90, loss=0.644771, acc1=0.75, acc2=1.0, lr=0.025, time_each_step=1.64s, eta=1:27:16\n",
      "2021-07-29 19:27:00 [INFO]\t[TRAIN] Epoch=1/32, Step=14/90, loss=0.314832, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.59s, eta=1:24:10\n",
      "2021-07-29 19:27:03 [INFO]\t[TRAIN] Epoch=1/32, Step=16/90, loss=0.413571, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.53s, eta=1:20:57\n",
      "2021-07-29 19:27:05 [INFO]\t[TRAIN] Epoch=1/32, Step=18/90, loss=1.021871, acc1=0.75, acc2=1.0, lr=0.025, time_each_step=1.48s, eta=1:18:39\n",
      "2021-07-29 19:27:07 [INFO]\t[TRAIN] Epoch=1/32, Step=20/90, loss=0.028718, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.45s, eta=1:16:37\n",
      "2021-07-29 19:27:10 [INFO]\t[TRAIN] Epoch=1/32, Step=22/90, loss=0.032965, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.17s, eta=1:1:59\n",
      "2021-07-29 19:27:12 [INFO]\t[TRAIN] Epoch=1/32, Step=24/90, loss=0.029097, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.17s, eta=1:1:40\n",
      "2021-07-29 19:27:14 [INFO]\t[TRAIN] Epoch=1/32, Step=26/90, loss=0.059069, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.16s, eta=1:1:22\n",
      "2021-07-29 19:27:16 [INFO]\t[TRAIN] Epoch=1/32, Step=28/90, loss=0.13965, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.16s, eta=1:1:5\n",
      "2021-07-29 19:27:19 [INFO]\t[TRAIN] Epoch=1/32, Step=30/90, loss=0.708267, acc1=0.625, acc2=1.0, lr=0.025, time_each_step=1.16s, eta=1:1:31\n",
      "2021-07-29 19:27:21 [INFO]\t[TRAIN] Epoch=1/32, Step=32/90, loss=0.000864, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.16s, eta=1:1:13\n",
      "2021-07-29 19:27:23 [INFO]\t[TRAIN] Epoch=1/32, Step=34/90, loss=0.288017, acc1=0.75, acc2=1.0, lr=0.025, time_each_step=1.14s, eta=1:0:9\n",
      "2021-07-29 19:27:25 [INFO]\t[TRAIN] Epoch=1/32, Step=36/90, loss=0.259115, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.14s, eta=1:0:21\n",
      "2021-07-29 19:27:28 [INFO]\t[TRAIN] Epoch=1/32, Step=38/90, loss=0.565295, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.14s, eta=1:0:6\n",
      "2021-07-29 19:27:30 [INFO]\t[TRAIN] Epoch=1/32, Step=40/90, loss=0.156464, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.14s, eta=1:0:15\n",
      "2021-07-29 19:27:32 [INFO]\t[TRAIN] Epoch=1/32, Step=42/90, loss=0.094822, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.13s, eta=0:59:43\n",
      "2021-07-29 19:27:34 [INFO]\t[TRAIN] Epoch=1/32, Step=44/90, loss=0.416105, acc1=0.75, acc2=1.0, lr=0.025, time_each_step=1.13s, eta=0:59:25\n",
      "2021-07-29 19:27:37 [INFO]\t[TRAIN] Epoch=1/32, Step=46/90, loss=0.180495, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.14s, eta=0:59:55\n",
      "2021-07-29 19:27:40 [INFO]\t[TRAIN] Epoch=1/32, Step=48/90, loss=0.160701, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.16s, eta=1:0:54\n",
      "2021-07-29 19:27:42 [INFO]\t[TRAIN] Epoch=1/32, Step=50/90, loss=0.49644, acc1=0.75, acc2=1.0, lr=0.025, time_each_step=1.17s, eta=1:1:9\n",
      "2021-07-29 19:27:45 [INFO]\t[TRAIN] Epoch=1/32, Step=52/90, loss=0.039021, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.17s, eta=1:1:36\n",
      "2021-07-29 19:27:47 [INFO]\t[TRAIN] Epoch=1/32, Step=54/90, loss=0.74352, acc1=0.75, acc2=1.0, lr=0.025, time_each_step=1.19s, eta=1:2:9\n",
      "2021-07-29 19:27:49 [INFO]\t[TRAIN] Epoch=1/32, Step=56/90, loss=0.040393, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.17s, eta=1:1:32\n",
      "2021-07-29 19:27:51 [INFO]\t[TRAIN] Epoch=1/32, Step=58/90, loss=0.043197, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.17s, eta=1:1:29\n",
      "2021-07-29 19:27:53 [INFO]\t[TRAIN] Epoch=1/32, Step=60/90, loss=0.009115, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.18s, eta=1:1:31\n",
      "2021-07-29 19:27:56 [INFO]\t[TRAIN] Epoch=1/32, Step=62/90, loss=0.004209, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.18s, eta=1:1:42\n",
      "2021-07-29 19:27:58 [INFO]\t[TRAIN] Epoch=1/32, Step=64/90, loss=0.05265, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.18s, eta=1:1:40\n",
      "2021-07-29 19:28:00 [INFO]\t[TRAIN] Epoch=1/32, Step=66/90, loss=0.058213, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.18s, eta=1:1:23\n",
      "2021-07-29 19:28:03 [INFO]\t[TRAIN] Epoch=1/32, Step=68/90, loss=0.034717, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.16s, eta=1:0:33\n",
      "2021-07-29 19:28:05 [INFO]\t[TRAIN] Epoch=1/32, Step=70/90, loss=0.322138, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.15s, eta=1:0:14\n",
      "2021-07-29 19:28:07 [INFO]\t[TRAIN] Epoch=1/32, Step=72/90, loss=0.022238, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.14s, eta=0:59:11\n",
      "2021-07-29 19:28:09 [INFO]\t[TRAIN] Epoch=1/32, Step=74/90, loss=0.13232, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.13s, eta=0:58:50\n",
      "2021-07-29 19:28:12 [INFO]\t[TRAIN] Epoch=1/32, Step=76/90, loss=0.051961, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.14s, eta=0:59:6\n",
      "2021-07-29 19:28:14 [INFO]\t[TRAIN] Epoch=1/32, Step=78/90, loss=0.003948, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.13s, eta=0:59:2\n",
      "2021-07-29 19:28:16 [INFO]\t[TRAIN] Epoch=1/32, Step=80/90, loss=0.05098, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.14s, eta=0:59:1\n",
      "2021-07-29 19:28:18 [INFO]\t[TRAIN] Epoch=1/32, Step=82/90, loss=0.001618, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.13s, eta=0:58:30\n",
      "2021-07-29 19:28:21 [INFO]\t[TRAIN] Epoch=1/32, Step=84/90, loss=0.008981, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.12s, eta=0:58:25\n",
      "2021-07-29 19:28:23 [INFO]\t[TRAIN] Epoch=1/32, Step=86/90, loss=0.032918, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.12s, eta=0:57:53\n",
      "2021-07-29 19:28:25 [INFO]\t[TRAIN] Epoch=1/32, Step=88/90, loss=0.004198, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.1s, eta=0:56:59\n",
      "2021-07-29 19:28:26 [INFO]\t[TRAIN] Epoch=1/32, Step=90/90, loss=0.894207, acc1=0.75, acc2=1.0, lr=0.025, time_each_step=1.05s, eta=0:54:33\n",
      "2021-07-29 19:28:26 [INFO]\t[TRAIN] Epoch 1 finished, loss=0.250633, acc1=0.909722, acc2=1.0, lr=0.025 .\n",
      "2021-07-29 19:28:26 [INFO]\tStart to evaluating(total_samples=80, total_steps=10)...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "  0%|          | 0/10 [00:00<?, ?it/s]share_vars_from is set, scope is ignored.\n",
      "100%|██████████| 10/10 [00:20<00:00,  2.02s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2021-07-29 19:28:46 [INFO]\t[EVAL] Finished, Epoch=1, acc1=0.8625, acc2=1.0 .\n",
      "2021-07-29 19:28:47 [INFO]\tModel saved in output/mobilenetv3_small_ssld/best_model.\n",
      "2021-07-29 19:28:47 [INFO]\tModel saved in output/mobilenetv3_small_ssld/epoch_1.\n",
      "2021-07-29 19:28:47 [INFO]\tCurrent evaluated best model in eval_dataset is epoch_1, acc1=0.8625\n",
      "2021-07-29 19:29:02 [INFO]\t[TRAIN] Epoch=2/32, Step=2/90, loss=0.416239, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.68s, eta=1:7:15\n",
      "2021-07-29 19:29:04 [INFO]\t[TRAIN] Epoch=2/32, Step=4/90, loss=0.003336, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.69s, eta=1:7:12\n",
      "2021-07-29 19:29:06 [INFO]\t[TRAIN] Epoch=2/32, Step=6/90, loss=0.419261, acc1=0.75, acc2=1.0, lr=0.025, time_each_step=1.68s, eta=1:7:8\n",
      "2021-07-29 19:29:08 [INFO]\t[TRAIN] Epoch=2/32, Step=8/90, loss=0.004844, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.67s, eta=1:7:4\n",
      "2021-07-29 19:29:10 [INFO]\t[TRAIN] Epoch=2/32, Step=10/90, loss=0.419386, acc1=0.75, acc2=1.0, lr=0.025, time_each_step=1.65s, eta=1:6:59\n",
      "2021-07-29 19:29:12 [INFO]\t[TRAIN] Epoch=2/32, Step=12/90, loss=0.035353, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.66s, eta=1:6:56\n",
      "2021-07-29 19:29:14 [INFO]\t[TRAIN] Epoch=2/32, Step=14/90, loss=0.18617, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.64s, eta=1:6:52\n",
      "2021-07-29 19:29:16 [INFO]\t[TRAIN] Epoch=2/32, Step=16/90, loss=0.028944, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.64s, eta=1:6:48\n",
      "2021-07-29 19:29:18 [INFO]\t[TRAIN] Epoch=2/32, Step=18/90, loss=0.497202, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.64s, eta=1:6:45\n",
      "2021-07-29 19:29:20 [INFO]\t[TRAIN] Epoch=2/32, Step=20/90, loss=0.739958, acc1=0.75, acc2=1.0, lr=0.025, time_each_step=1.66s, eta=1:6:43\n",
      "2021-07-29 19:29:22 [INFO]\t[TRAIN] Epoch=2/32, Step=22/90, loss=0.054406, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.02s, eta=1:5:56\n",
      "2021-07-29 19:29:24 [INFO]\t[TRAIN] Epoch=2/32, Step=24/90, loss=0.003581, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.0s, eta=1:5:53\n",
      "2021-07-29 19:29:26 [INFO]\t[TRAIN] Epoch=2/32, Step=26/90, loss=0.03565, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.0s, eta=1:5:50\n",
      "2021-07-29 19:29:28 [INFO]\t[TRAIN] Epoch=2/32, Step=28/90, loss=0.896178, acc1=0.75, acc2=1.0, lr=0.025, time_each_step=1.01s, eta=1:5:49\n",
      "2021-07-29 19:29:30 [INFO]\t[TRAIN] Epoch=2/32, Step=30/90, loss=0.085767, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.01s, eta=1:5:47\n",
      "2021-07-29 19:29:32 [INFO]\t[TRAIN] Epoch=2/32, Step=32/90, loss=0.170422, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.0s, eta=1:5:44\n",
      "2021-07-29 19:29:34 [INFO]\t[TRAIN] Epoch=2/32, Step=34/90, loss=0.035717, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.99s, eta=1:5:42\n",
      "2021-07-29 19:29:36 [INFO]\t[TRAIN] Epoch=2/32, Step=36/90, loss=0.184678, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=0.98s, eta=1:5:40\n",
      "2021-07-29 19:29:38 [INFO]\t[TRAIN] Epoch=2/32, Step=38/90, loss=0.182279, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=0.98s, eta=1:5:38\n",
      "2021-07-29 19:29:40 [INFO]\t[TRAIN] Epoch=2/32, Step=40/90, loss=0.040562, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.98s, eta=1:5:36\n",
      "2021-07-29 19:29:42 [INFO]\t[TRAIN] Epoch=2/32, Step=42/90, loss=0.133105, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=0.98s, eta=1:5:34\n",
      "2021-07-29 19:29:44 [INFO]\t[TRAIN] Epoch=2/32, Step=44/90, loss=0.069205, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.98s, eta=1:5:32\n",
      "2021-07-29 19:29:46 [INFO]\t[TRAIN] Epoch=2/32, Step=46/90, loss=0.003523, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.98s, eta=1:5:30\n",
      "2021-07-29 19:29:48 [INFO]\t[TRAIN] Epoch=2/32, Step=48/90, loss=0.070929, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.96s, eta=1:5:27\n",
      "2021-07-29 19:29:50 [INFO]\t[TRAIN] Epoch=2/32, Step=50/90, loss=0.009092, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.96s, eta=1:5:25\n",
      "2021-07-29 19:29:52 [INFO]\t[TRAIN] Epoch=2/32, Step=52/90, loss=0.005921, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.97s, eta=1:5:24\n",
      "2021-07-29 19:29:54 [INFO]\t[TRAIN] Epoch=2/32, Step=54/90, loss=0.042526, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.99s, eta=1:5:22\n",
      "2021-07-29 19:29:56 [INFO]\t[TRAIN] Epoch=2/32, Step=56/90, loss=0.030637, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.01s, eta=1:5:21\n",
      "2021-07-29 19:29:58 [INFO]\t[TRAIN] Epoch=2/32, Step=58/90, loss=0.002419, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.01s, eta=1:5:19\n",
      "2021-07-29 19:30:00 [INFO]\t[TRAIN] Epoch=2/32, Step=60/90, loss=0.064321, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.01s, eta=1:5:17\n",
      "2021-07-29 19:30:02 [INFO]\t[TRAIN] Epoch=2/32, Step=62/90, loss=0.748282, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.02s, eta=1:5:15\n",
      "2021-07-29 19:30:04 [INFO]\t[TRAIN] Epoch=2/32, Step=64/90, loss=0.017566, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.02s, eta=1:5:13\n",
      "2021-07-29 19:30:06 [INFO]\t[TRAIN] Epoch=2/32, Step=66/90, loss=0.479853, acc1=0.625, acc2=1.0, lr=0.025, time_each_step=1.02s, eta=1:5:11\n",
      "2021-07-29 19:30:08 [INFO]\t[TRAIN] Epoch=2/32, Step=68/90, loss=0.419027, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.02s, eta=1:5:9\n",
      "2021-07-29 19:30:10 [INFO]\t[TRAIN] Epoch=2/32, Step=70/90, loss=0.307987, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.02s, eta=1:5:7\n",
      "2021-07-29 19:30:12 [INFO]\t[TRAIN] Epoch=2/32, Step=72/90, loss=0.027241, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.01s, eta=1:5:5\n",
      "2021-07-29 19:30:14 [INFO]\t[TRAIN] Epoch=2/32, Step=74/90, loss=0.138302, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.01s, eta=1:5:3\n",
      "2021-07-29 19:30:16 [INFO]\t[TRAIN] Epoch=2/32, Step=76/90, loss=0.010227, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.99s, eta=1:5:1\n",
      "2021-07-29 19:30:18 [INFO]\t[TRAIN] Epoch=2/32, Step=78/90, loss=0.151197, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=0.99s, eta=1:4:59\n",
      "2021-07-29 19:30:20 [INFO]\t[TRAIN] Epoch=2/32, Step=80/90, loss=0.010242, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.98s, eta=1:4:56\n",
      "2021-07-29 19:30:22 [INFO]\t[TRAIN] Epoch=2/32, Step=82/90, loss=0.008977, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.97s, eta=1:4:54\n",
      "2021-07-29 19:30:24 [INFO]\t[TRAIN] Epoch=2/32, Step=84/90, loss=0.131274, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=0.98s, eta=1:4:53\n",
      "2021-07-29 19:30:26 [INFO]\t[TRAIN] Epoch=2/32, Step=86/90, loss=0.000957, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.98s, eta=1:4:51\n",
      "2021-07-29 19:30:27 [INFO]\t[TRAIN] Epoch=2/32, Step=88/90, loss=0.042059, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.98s, eta=1:4:49\n",
      "2021-07-29 19:30:29 [INFO]\t[TRAIN] Epoch=2/32, Step=90/90, loss=0.202968, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=0.95s, eta=1:4:47\n",
      "2021-07-29 19:30:29 [INFO]\t[TRAIN] Epoch 2 finished, loss=0.182445, acc1=0.930556, acc2=1.0, lr=0.025 .\n",
      "2021-07-29 19:30:29 [INFO]\tStart to evaluating(total_samples=80, total_steps=10)...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 10/10 [00:18<00:00,  1.88s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2021-07-29 19:30:48 [INFO]\t[EVAL] Finished, Epoch=2, acc1=0.65, acc2=1.0 .\n",
      "2021-07-29 19:30:48 [INFO]\tModel saved in output/mobilenetv3_small_ssld/epoch_2.\n",
      "2021-07-29 19:30:48 [INFO]\tCurrent evaluated best model in eval_dataset is epoch_1, acc1=0.8625\n",
      "2021-07-29 19:30:56 [INFO]\t[TRAIN] Epoch=3/32, Step=2/90, loss=0.012566, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.25s, eta=1:0:38\n",
      "2021-07-29 19:30:59 [INFO]\t[TRAIN] Epoch=3/32, Step=4/90, loss=0.001621, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.27s, eta=1:0:37\n",
      "2021-07-29 19:31:01 [INFO]\t[TRAIN] Epoch=3/32, Step=6/90, loss=0.248669, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.28s, eta=1:0:36\n",
      "2021-07-29 19:31:03 [INFO]\t[TRAIN] Epoch=3/32, Step=8/90, loss=0.515389, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.3s, eta=1:0:35\n",
      "2021-07-29 19:31:05 [INFO]\t[TRAIN] Epoch=3/32, Step=10/90, loss=0.069977, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.31s, eta=1:0:33\n",
      "2021-07-29 19:31:07 [INFO]\t[TRAIN] Epoch=3/32, Step=12/90, loss=0.285279, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.32s, eta=1:0:31\n",
      "2021-07-29 19:31:09 [INFO]\t[TRAIN] Epoch=3/32, Step=14/90, loss=0.001614, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.32s, eta=1:0:29\n",
      "2021-07-29 19:31:12 [INFO]\t[TRAIN] Epoch=3/32, Step=16/90, loss=0.009354, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.33s, eta=1:0:27\n",
      "2021-07-29 19:31:13 [INFO]\t[TRAIN] Epoch=3/32, Step=18/90, loss=0.113742, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.34s, eta=1:0:25\n",
      "2021-07-29 19:31:15 [INFO]\t[TRAIN] Epoch=3/32, Step=20/90, loss=0.706414, acc1=0.75, acc2=1.0, lr=0.025, time_each_step=1.37s, eta=1:0:24\n",
      "2021-07-29 19:31:17 [INFO]\t[TRAIN] Epoch=3/32, Step=22/90, loss=0.142301, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.07s, eta=1:0:1\n",
      "2021-07-29 19:31:19 [INFO]\t[TRAIN] Epoch=3/32, Step=24/90, loss=0.208808, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.04s, eta=0:59:56\n",
      "2021-07-29 19:31:21 [INFO]\t[TRAIN] Epoch=3/32, Step=26/90, loss=0.000949, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.02s, eta=0:59:53\n",
      "2021-07-29 19:31:23 [INFO]\t[TRAIN] Epoch=3/32, Step=28/90, loss=0.841108, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.0s, eta=0:59:50\n",
      "2021-07-29 19:31:25 [INFO]\t[TRAIN] Epoch=3/32, Step=30/90, loss=0.049718, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.99s, eta=0:59:48\n",
      "2021-07-29 19:31:27 [INFO]\t[TRAIN] Epoch=3/32, Step=32/90, loss=0.001564, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.99s, eta=0:59:45\n",
      "2021-07-29 19:31:29 [INFO]\t[TRAIN] Epoch=3/32, Step=34/90, loss=0.269356, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=0.98s, eta=0:59:43\n",
      "2021-07-29 19:31:31 [INFO]\t[TRAIN] Epoch=3/32, Step=36/90, loss=0.005974, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.98s, eta=0:59:41\n",
      "2021-07-29 19:31:33 [INFO]\t[TRAIN] Epoch=3/32, Step=38/90, loss=0.048075, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.98s, eta=0:59:39\n",
      "2021-07-29 19:31:35 [INFO]\t[TRAIN] Epoch=3/32, Step=40/90, loss=0.024446, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.98s, eta=0:59:37\n",
      "2021-07-29 19:31:37 [INFO]\t[TRAIN] Epoch=3/32, Step=42/90, loss=0.002572, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.98s, eta=0:59:35\n",
      "2021-07-29 19:31:39 [INFO]\t[TRAIN] Epoch=3/32, Step=44/90, loss=0.01879, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.98s, eta=0:59:33\n",
      "2021-07-29 19:31:41 [INFO]\t[TRAIN] Epoch=3/32, Step=46/90, loss=0.001188, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.99s, eta=0:59:32\n",
      "2021-07-29 19:31:43 [INFO]\t[TRAIN] Epoch=3/32, Step=48/90, loss=0.001531, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.0s, eta=0:59:30\n",
      "2021-07-29 19:31:45 [INFO]\t[TRAIN] Epoch=3/32, Step=50/90, loss=0.00098, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.0s, eta=0:59:28\n",
      "2021-07-29 19:31:47 [INFO]\t[TRAIN] Epoch=3/32, Step=52/90, loss=0.123899, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.0s, eta=0:59:26\n",
      "2021-07-29 19:31:49 [INFO]\t[TRAIN] Epoch=3/32, Step=54/90, loss=0.004064, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.0s, eta=0:59:24\n",
      "2021-07-29 19:31:51 [INFO]\t[TRAIN] Epoch=3/32, Step=56/90, loss=0.154314, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.0s, eta=0:59:22\n",
      "2021-07-29 19:31:53 [INFO]\t[TRAIN] Epoch=3/32, Step=58/90, loss=0.002559, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.99s, eta=0:59:20\n",
      "2021-07-29 19:31:55 [INFO]\t[TRAIN] Epoch=3/32, Step=60/90, loss=0.172174, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=0.99s, eta=0:59:18\n",
      "2021-07-29 19:31:57 [INFO]\t[TRAIN] Epoch=3/32, Step=62/90, loss=0.228723, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=0.99s, eta=0:59:16\n",
      "2021-07-29 19:31:59 [INFO]\t[TRAIN] Epoch=3/32, Step=64/90, loss=0.002503, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.99s, eta=0:59:14\n",
      "2021-07-29 19:32:01 [INFO]\t[TRAIN] Epoch=3/32, Step=66/90, loss=0.011222, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.98s, eta=0:59:12\n",
      "2021-07-29 19:32:03 [INFO]\t[TRAIN] Epoch=3/32, Step=68/90, loss=0.18606, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=0.98s, eta=0:59:10\n",
      "2021-07-29 19:32:05 [INFO]\t[TRAIN] Epoch=3/32, Step=70/90, loss=0.002318, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.99s, eta=0:59:8\n",
      "2021-07-29 19:32:07 [INFO]\t[TRAIN] Epoch=3/32, Step=72/90, loss=0.012448, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.0s, eta=0:59:6\n",
      "2021-07-29 19:32:09 [INFO]\t[TRAIN] Epoch=3/32, Step=74/90, loss=0.345356, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.01s, eta=0:59:4\n",
      "2021-07-29 19:32:11 [INFO]\t[TRAIN] Epoch=3/32, Step=76/90, loss=0.011131, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.02s, eta=0:59:2\n",
      "2021-07-29 19:32:14 [INFO]\t[TRAIN] Epoch=3/32, Step=78/90, loss=0.013228, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.03s, eta=0:59:1\n",
      "2021-07-29 19:32:15 [INFO]\t[TRAIN] Epoch=3/32, Step=80/90, loss=0.103669, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.02s, eta=0:58:58\n",
      "2021-07-29 19:32:17 [INFO]\t[TRAIN] Epoch=3/32, Step=82/90, loss=0.103923, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.02s, eta=0:58:56\n",
      "2021-07-29 19:32:19 [INFO]\t[TRAIN] Epoch=3/32, Step=84/90, loss=0.166835, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.03s, eta=0:58:54\n",
      "2021-07-29 19:32:21 [INFO]\t[TRAIN] Epoch=3/32, Step=86/90, loss=0.033394, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.03s, eta=0:58:52\n",
      "2021-07-29 19:32:23 [INFO]\t[TRAIN] Epoch=3/32, Step=88/90, loss=0.001447, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.02s, eta=0:58:50\n",
      "2021-07-29 19:32:25 [INFO]\t[TRAIN] Epoch=3/32, Step=90/90, loss=0.047252, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.99s, eta=0:58:48\n",
      "2021-07-29 19:32:25 [INFO]\t[TRAIN] Epoch 3 finished, loss=0.136467, acc1=0.952778, acc2=1.0, lr=0.025 .\n",
      "2021-07-29 19:32:25 [INFO]\tStart to evaluating(total_samples=80, total_steps=10)...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 10/10 [00:19<00:00,  1.93s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2021-07-29 19:32:44 [INFO]\t[EVAL] Finished, Epoch=3, acc1=0.975, acc2=1.0 .\n",
      "2021-07-29 19:32:44 [INFO]\tModel saved in output/mobilenetv3_small_ssld/best_model.\n",
      "2021-07-29 19:32:45 [INFO]\tModel saved in output/mobilenetv3_small_ssld/epoch_3.\n",
      "2021-07-29 19:32:45 [INFO]\tCurrent evaluated best model in eval_dataset is epoch_3, acc1=0.975\n",
      "2021-07-29 19:32:55 [INFO]\t[TRAIN] Epoch=4/32, Step=2/90, loss=0.012833, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.39s, eta=0:56:47\n",
      "2021-07-29 19:32:57 [INFO]\t[TRAIN] Epoch=4/32, Step=4/90, loss=0.002377, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.39s, eta=0:56:44\n",
      "2021-07-29 19:32:59 [INFO]\t[TRAIN] Epoch=4/32, Step=6/90, loss=0.47768, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.39s, eta=0:56:42\n",
      "2021-07-29 19:33:01 [INFO]\t[TRAIN] Epoch=4/32, Step=8/90, loss=0.032861, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.38s, eta=0:56:38\n",
      "2021-07-29 19:33:03 [INFO]\t[TRAIN] Epoch=4/32, Step=10/90, loss=0.024888, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.39s, eta=0:56:36\n",
      "2021-07-29 19:33:05 [INFO]\t[TRAIN] Epoch=4/32, Step=12/90, loss=0.317222, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.4s, eta=0:56:34\n",
      "2021-07-29 19:33:07 [INFO]\t[TRAIN] Epoch=4/32, Step=14/90, loss=0.031262, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.41s, eta=0:56:32\n",
      "2021-07-29 19:33:10 [INFO]\t[TRAIN] Epoch=4/32, Step=16/90, loss=0.873485, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.41s, eta=0:56:29\n",
      "2021-07-29 19:33:12 [INFO]\t[TRAIN] Epoch=4/32, Step=18/90, loss=0.740733, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.43s, eta=0:56:27\n",
      "2021-07-29 19:33:14 [INFO]\t[TRAIN] Epoch=4/32, Step=20/90, loss=0.042502, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.45s, eta=0:56:26\n",
      "2021-07-29 19:33:16 [INFO]\t[TRAIN] Epoch=4/32, Step=22/90, loss=0.340788, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.05s, eta=0:55:56\n",
      "2021-07-29 19:33:18 [INFO]\t[TRAIN] Epoch=4/32, Step=24/90, loss=0.019733, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.04s, eta=0:55:53\n",
      "2021-07-29 19:33:20 [INFO]\t[TRAIN] Epoch=4/32, Step=26/90, loss=0.055261, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.04s, eta=0:55:51\n",
      "2021-07-29 19:33:22 [INFO]\t[TRAIN] Epoch=4/32, Step=28/90, loss=0.035217, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.05s, eta=0:55:49\n",
      "2021-07-29 19:33:24 [INFO]\t[TRAIN] Epoch=4/32, Step=30/90, loss=0.055359, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.05s, eta=0:55:47\n",
      "2021-07-29 19:33:26 [INFO]\t[TRAIN] Epoch=4/32, Step=32/90, loss=0.051358, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.03s, eta=0:55:44\n",
      "2021-07-29 19:33:28 [INFO]\t[TRAIN] Epoch=4/32, Step=34/90, loss=0.282309, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.02s, eta=0:55:42\n",
      "2021-07-29 19:33:30 [INFO]\t[TRAIN] Epoch=4/32, Step=36/90, loss=0.298268, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.02s, eta=0:55:40\n",
      "2021-07-29 19:33:32 [INFO]\t[TRAIN] Epoch=4/32, Step=38/90, loss=0.011135, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.01s, eta=0:55:37\n",
      "2021-07-29 19:33:34 [INFO]\t[TRAIN] Epoch=4/32, Step=40/90, loss=0.107762, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.01s, eta=0:55:35\n",
      "2021-07-29 19:33:36 [INFO]\t[TRAIN] Epoch=4/32, Step=42/90, loss=0.010811, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.0s, eta=0:55:33\n",
      "2021-07-29 19:33:38 [INFO]\t[TRAIN] Epoch=4/32, Step=44/90, loss=0.309377, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.0s, eta=0:55:30\n",
      "2021-07-29 19:33:40 [INFO]\t[TRAIN] Epoch=4/32, Step=46/90, loss=0.001465, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.99s, eta=0:55:28\n",
      "2021-07-29 19:33:42 [INFO]\t[TRAIN] Epoch=4/32, Step=48/90, loss=0.200862, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=0.98s, eta=0:55:26\n",
      "2021-07-29 19:33:44 [INFO]\t[TRAIN] Epoch=4/32, Step=50/90, loss=0.008083, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.98s, eta=0:55:24\n",
      "2021-07-29 19:33:46 [INFO]\t[TRAIN] Epoch=4/32, Step=52/90, loss=0.006707, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.98s, eta=0:55:22\n",
      "2021-07-29 19:33:48 [INFO]\t[TRAIN] Epoch=4/32, Step=54/90, loss=0.030839, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.99s, eta=0:55:20\n",
      "2021-07-29 19:33:50 [INFO]\t[TRAIN] Epoch=4/32, Step=56/90, loss=0.00463, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.98s, eta=0:55:18\n",
      "2021-07-29 19:33:52 [INFO]\t[TRAIN] Epoch=4/32, Step=58/90, loss=0.017608, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.99s, eta=0:55:16\n",
      "2021-07-29 19:33:54 [INFO]\t[TRAIN] Epoch=4/32, Step=60/90, loss=0.049059, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.99s, eta=0:55:14\n",
      "2021-07-29 19:33:56 [INFO]\t[TRAIN] Epoch=4/32, Step=62/90, loss=0.044393, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.99s, eta=0:55:12\n",
      "2021-07-29 19:33:58 [INFO]\t[TRAIN] Epoch=4/32, Step=64/90, loss=0.024685, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.99s, eta=0:55:10\n",
      "2021-07-29 19:34:00 [INFO]\t[TRAIN] Epoch=4/32, Step=66/90, loss=0.123987, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=0.99s, eta=0:55:8\n",
      "2021-07-29 19:34:02 [INFO]\t[TRAIN] Epoch=4/32, Step=68/90, loss=0.062625, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.0s, eta=0:55:7\n",
      "2021-07-29 19:34:04 [INFO]\t[TRAIN] Epoch=4/32, Step=70/90, loss=0.237601, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.0s, eta=0:55:5\n",
      "2021-07-29 19:34:06 [INFO]\t[TRAIN] Epoch=4/32, Step=72/90, loss=0.145915, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.01s, eta=0:55:3\n",
      "2021-07-29 19:34:08 [INFO]\t[TRAIN] Epoch=4/32, Step=74/90, loss=0.530946, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.0s, eta=0:55:1\n",
      "2021-07-29 19:34:10 [INFO]\t[TRAIN] Epoch=4/32, Step=76/90, loss=0.010001, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.0s, eta=0:54:59\n",
      "2021-07-29 19:34:12 [INFO]\t[TRAIN] Epoch=4/32, Step=78/90, loss=0.000893, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.0s, eta=0:54:57\n",
      "2021-07-29 19:34:14 [INFO]\t[TRAIN] Epoch=4/32, Step=80/90, loss=0.199185, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.01s, eta=0:54:55\n",
      "2021-07-29 19:34:16 [INFO]\t[TRAIN] Epoch=4/32, Step=82/90, loss=0.090386, acc1=0.875, acc2=1.0, lr=0.025, time_each_step=1.01s, eta=0:54:53\n",
      "2021-07-29 19:34:18 [INFO]\t[TRAIN] Epoch=4/32, Step=84/90, loss=0.015168, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.01s, eta=0:54:51\n",
      "2021-07-29 19:34:20 [INFO]\t[TRAIN] Epoch=4/32, Step=86/90, loss=0.010096, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=1.01s, eta=0:54:49\n",
      "2021-07-29 19:34:22 [INFO]\t[TRAIN] Epoch=4/32, Step=88/90, loss=0.005159, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.99s, eta=0:54:47\n",
      "2021-07-29 19:34:23 [INFO]\t[TRAIN] Epoch=4/32, Step=90/90, loss=0.013789, acc1=1.0, acc2=1.0, lr=0.025, time_each_step=0.97s, eta=0:54:45\n",
      "2021-07-29 19:34:23 [INFO]\t[TRAIN] Epoch 4 finished, loss=0.125841, acc1=0.951389, acc2=1.0, lr=0.025 .\n",
      "2021-07-29 19:34:23 [INFO]\tStart to evaluating(total_samples=80, total_steps=10)...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 10/10 [00:18<00:00,  1.82s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2021-07-29 19:34:41 [INFO]\t[EVAL] Finished, Epoch=4, acc1=0.975, acc2=1.0 .\n",
      "2021-07-29 19:34:42 [INFO]\tModel saved in output/mobilenetv3_small_ssld/epoch_4.\n",
      "2021-07-29 19:34:42 [INFO]\tCurrent evaluated best model in eval_dataset is epoch_3, acc1=0.975\n",
      "2021-07-29 19:34:50 [INFO]\t[TRAIN] Epoch=5/32, Step=2/90, loss=0.024621, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.28s, eta=0:54:48\n",
      "2021-07-29 19:34:52 [INFO]\t[TRAIN] Epoch=5/32, Step=4/90, loss=0.001555, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.29s, eta=0:54:47\n",
      "2021-07-29 19:34:54 [INFO]\t[TRAIN] Epoch=5/32, Step=6/90, loss=0.016004, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.3s, eta=0:54:45\n",
      "2021-07-29 19:34:56 [INFO]\t[TRAIN] Epoch=5/32, Step=8/90, loss=0.175905, acc1=0.875, acc2=1.0, lr=0.0025, time_each_step=1.3s, eta=0:54:42\n",
      "2021-07-29 19:34:58 [INFO]\t[TRAIN] Epoch=5/32, Step=10/90, loss=0.354414, acc1=0.875, acc2=1.0, lr=0.0025, time_each_step=1.3s, eta=0:54:40\n",
      "2021-07-29 19:35:01 [INFO]\t[TRAIN] Epoch=5/32, Step=12/90, loss=0.003095, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.32s, eta=0:54:38\n",
      "2021-07-29 19:35:03 [INFO]\t[TRAIN] Epoch=5/32, Step=14/90, loss=0.039885, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.32s, eta=0:54:36\n",
      "2021-07-29 19:35:05 [INFO]\t[TRAIN] Epoch=5/32, Step=16/90, loss=0.373249, acc1=0.875, acc2=1.0, lr=0.0025, time_each_step=1.33s, eta=0:54:34\n",
      "2021-07-29 19:35:07 [INFO]\t[TRAIN] Epoch=5/32, Step=18/90, loss=0.005743, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.33s, eta=0:54:32\n",
      "2021-07-29 19:35:09 [INFO]\t[TRAIN] Epoch=5/32, Step=20/90, loss=0.000747, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.35s, eta=0:54:30\n",
      "2021-07-29 19:35:11 [INFO]\t[TRAIN] Epoch=5/32, Step=22/90, loss=0.574801, acc1=0.75, acc2=1.0, lr=0.0025, time_each_step=1.04s, eta=0:54:6\n",
      "2021-07-29 19:35:13 [INFO]\t[TRAIN] Epoch=5/32, Step=24/90, loss=0.026761, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.03s, eta=0:54:3\n",
      "2021-07-29 19:35:15 [INFO]\t[TRAIN] Epoch=5/32, Step=26/90, loss=0.427506, acc1=0.75, acc2=1.0, lr=0.0025, time_each_step=1.01s, eta=0:54:1\n",
      "2021-07-29 19:35:16 [INFO]\t[TRAIN] Epoch=5/32, Step=28/90, loss=0.466756, acc1=0.875, acc2=1.0, lr=0.0025, time_each_step=1.01s, eta=0:53:59\n",
      "2021-07-29 19:35:19 [INFO]\t[TRAIN] Epoch=5/32, Step=30/90, loss=0.071793, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.01s, eta=0:53:56\n",
      "2021-07-29 19:35:21 [INFO]\t[TRAIN] Epoch=5/32, Step=32/90, loss=0.001856, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.01s, eta=0:53:54\n",
      "2021-07-29 19:35:23 [INFO]\t[TRAIN] Epoch=5/32, Step=34/90, loss=0.034863, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.0s, eta=0:53:51\n",
      "2021-07-29 19:35:25 [INFO]\t[TRAIN] Epoch=5/32, Step=36/90, loss=0.038846, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=0.99s, eta=0:53:49\n",
      "2021-07-29 19:35:27 [INFO]\t[TRAIN] Epoch=5/32, Step=38/90, loss=0.021844, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.0s, eta=0:53:48\n",
      "2021-07-29 19:35:29 [INFO]\t[TRAIN] Epoch=5/32, Step=40/90, loss=0.011584, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.03s, eta=0:53:47\n",
      "2021-07-29 19:35:31 [INFO]\t[TRAIN] Epoch=5/32, Step=42/90, loss=0.019606, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.04s, eta=0:53:45\n",
      "2021-07-29 19:35:33 [INFO]\t[TRAIN] Epoch=5/32, Step=44/90, loss=0.242774, acc1=0.875, acc2=1.0, lr=0.0025, time_each_step=1.04s, eta=0:53:44\n",
      "2021-07-29 19:35:35 [INFO]\t[TRAIN] Epoch=5/32, Step=46/90, loss=0.019042, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.04s, eta=0:53:41\n",
      "2021-07-29 19:35:37 [INFO]\t[TRAIN] Epoch=5/32, Step=48/90, loss=0.2542, acc1=0.875, acc2=1.0, lr=0.0025, time_each_step=1.05s, eta=0:53:40\n",
      "2021-07-29 19:35:39 [INFO]\t[TRAIN] Epoch=5/32, Step=50/90, loss=0.016822, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.04s, eta=0:53:38\n",
      "2021-07-29 19:35:42 [INFO]\t[TRAIN] Epoch=5/32, Step=52/90, loss=0.004944, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.05s, eta=0:53:35\n",
      "2021-07-29 19:35:43 [INFO]\t[TRAIN] Epoch=5/32, Step=54/90, loss=0.009889, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.04s, eta=0:53:33\n",
      "2021-07-29 19:35:46 [INFO]\t[TRAIN] Epoch=5/32, Step=56/90, loss=0.064323, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.05s, eta=0:53:31\n",
      "2021-07-29 19:35:48 [INFO]\t[TRAIN] Epoch=5/32, Step=58/90, loss=0.121647, acc1=0.875, acc2=1.0, lr=0.0025, time_each_step=1.03s, eta=0:53:29\n",
      "2021-07-29 19:35:50 [INFO]\t[TRAIN] Epoch=5/32, Step=60/90, loss=0.026825, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.02s, eta=0:53:26\n",
      "2021-07-29 19:35:52 [INFO]\t[TRAIN] Epoch=5/32, Step=62/90, loss=0.003635, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.01s, eta=0:53:24\n",
      "2021-07-29 19:35:54 [INFO]\t[TRAIN] Epoch=5/32, Step=64/90, loss=0.000235, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.01s, eta=0:53:22\n",
      "2021-07-29 19:35:55 [INFO]\t[TRAIN] Epoch=5/32, Step=66/90, loss=0.018063, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.01s, eta=0:53:20\n",
      "2021-07-29 19:35:58 [INFO]\t[TRAIN] Epoch=5/32, Step=68/90, loss=0.036534, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.01s, eta=0:53:18\n",
      "2021-07-29 19:35:59 [INFO]\t[TRAIN] Epoch=5/32, Step=70/90, loss=0.006039, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=0.99s, eta=0:53:16\n",
      "2021-07-29 19:36:02 [INFO]\t[TRAIN] Epoch=5/32, Step=72/90, loss=0.277416, acc1=0.875, acc2=1.0, lr=0.0025, time_each_step=1.0s, eta=0:53:14\n",
      "2021-07-29 19:36:04 [INFO]\t[TRAIN] Epoch=5/32, Step=74/90, loss=0.004025, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.01s, eta=0:53:12\n",
      "2021-07-29 19:36:06 [INFO]\t[TRAIN] Epoch=5/32, Step=76/90, loss=0.25128, acc1=0.875, acc2=1.0, lr=0.0025, time_each_step=1.0s, eta=0:53:10\n",
      "2021-07-29 19:36:08 [INFO]\t[TRAIN] Epoch=5/32, Step=78/90, loss=0.019552, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.01s, eta=0:53:8\n",
      "2021-07-29 19:36:10 [INFO]\t[TRAIN] Epoch=5/32, Step=80/90, loss=0.003135, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.0s, eta=0:53:6\n",
      "2021-07-29 19:36:12 [INFO]\t[TRAIN] Epoch=5/32, Step=82/90, loss=0.064829, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.0s, eta=0:53:4\n",
      "2021-07-29 19:36:14 [INFO]\t[TRAIN] Epoch=5/32, Step=84/90, loss=0.230249, acc1=0.875, acc2=1.0, lr=0.0025, time_each_step=1.0s, eta=0:53:2\n",
      "2021-07-29 19:36:16 [INFO]\t[TRAIN] Epoch=5/32, Step=86/90, loss=0.001294, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.0s, eta=0:53:0\n",
      "2021-07-29 19:36:17 [INFO]\t[TRAIN] Epoch=5/32, Step=88/90, loss=0.011301, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=0.99s, eta=0:52:58\n",
      "2021-07-29 19:36:19 [INFO]\t[TRAIN] Epoch=5/32, Step=90/90, loss=0.028413, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=0.97s, eta=0:52:56\n",
      "2021-07-29 19:36:19 [INFO]\t[TRAIN] Epoch 5 finished, loss=0.070793, acc1=0.970833, acc2=1.0, lr=0.0025 .\n",
      "2021-07-29 19:36:19 [INFO]\tStart to evaluating(total_samples=80, total_steps=10)...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 10/10 [00:19<00:00,  1.92s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2021-07-29 19:36:38 [INFO]\t[EVAL] Finished, Epoch=5, acc1=0.9875, acc2=1.0 .\n",
      "2021-07-29 19:36:38 [INFO]\tModel saved in output/mobilenetv3_small_ssld/best_model.\n",
      "2021-07-29 19:36:39 [INFO]\tModel saved in output/mobilenetv3_small_ssld/epoch_5.\n",
      "2021-07-29 19:36:39 [INFO]\tCurrent evaluated best model in eval_dataset is epoch_5, acc1=0.9875\n",
      "2021-07-29 19:36:49 [INFO]\t[TRAIN] Epoch=6/32, Step=2/90, loss=0.000496, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.37s, eta=0:53:1\n",
      "2021-07-29 19:36:51 [INFO]\t[TRAIN] Epoch=6/32, Step=4/90, loss=0.41393, acc1=0.875, acc2=1.0, lr=0.0025, time_each_step=1.39s, eta=0:53:0\n",
      "2021-07-29 19:36:53 [INFO]\t[TRAIN] Epoch=6/32, Step=6/90, loss=0.001155, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.39s, eta=0:52:56\n",
      "2021-07-29 19:36:55 [INFO]\t[TRAIN] Epoch=6/32, Step=8/90, loss=0.017425, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.39s, eta=0:52:54\n",
      "2021-07-29 19:36:57 [INFO]\t[TRAIN] Epoch=6/32, Step=10/90, loss=0.024893, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.39s, eta=0:52:51\n",
      "2021-07-29 19:36:59 [INFO]\t[TRAIN] Epoch=6/32, Step=12/90, loss=0.017785, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.39s, eta=0:52:48\n",
      "2021-07-29 19:37:01 [INFO]\t[TRAIN] Epoch=6/32, Step=14/90, loss=0.006741, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.39s, eta=0:52:45\n",
      "2021-07-29 19:37:03 [INFO]\t[TRAIN] Epoch=6/32, Step=16/90, loss=0.142191, acc1=0.875, acc2=1.0, lr=0.0025, time_each_step=1.4s, eta=0:52:44\n",
      "2021-07-29 19:37:05 [INFO]\t[TRAIN] Epoch=6/32, Step=18/90, loss=0.001758, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.41s, eta=0:52:41\n",
      "2021-07-29 19:37:07 [INFO]\t[TRAIN] Epoch=6/32, Step=20/90, loss=0.004723, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.44s, eta=0:52:40\n",
      "2021-07-29 19:37:09 [INFO]\t[TRAIN] Epoch=6/32, Step=22/90, loss=0.013732, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.02s, eta=0:52:9\n",
      "2021-07-29 19:37:11 [INFO]\t[TRAIN] Epoch=6/32, Step=24/90, loss=0.04601, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.0s, eta=0:52:6\n",
      "2021-07-29 19:37:13 [INFO]\t[TRAIN] Epoch=6/32, Step=26/90, loss=0.001926, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.0s, eta=0:52:4\n",
      "2021-07-29 19:37:15 [INFO]\t[TRAIN] Epoch=6/32, Step=28/90, loss=0.001494, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=0.99s, eta=0:52:1\n",
      "2021-07-29 19:37:17 [INFO]\t[TRAIN] Epoch=6/32, Step=30/90, loss=0.044028, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=0.99s, eta=0:51:59\n",
      "2021-07-29 19:37:19 [INFO]\t[TRAIN] Epoch=6/32, Step=32/90, loss=0.009774, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=0.99s, eta=0:51:57\n",
      "2021-07-29 19:37:21 [INFO]\t[TRAIN] Epoch=6/32, Step=34/90, loss=0.004063, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=0.99s, eta=0:51:55\n",
      "2021-07-29 19:37:23 [INFO]\t[TRAIN] Epoch=6/32, Step=36/90, loss=0.024539, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=0.97s, eta=0:51:53\n",
      "2021-07-29 19:37:25 [INFO]\t[TRAIN] Epoch=6/32, Step=38/90, loss=0.00997, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=0.98s, eta=0:51:51\n",
      "2021-07-29 19:37:27 [INFO]\t[TRAIN] Epoch=6/32, Step=40/90, loss=0.015134, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=0.98s, eta=0:51:49\n",
      "2021-07-29 19:37:29 [INFO]\t[TRAIN] Epoch=6/32, Step=42/90, loss=0.020173, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=0.98s, eta=0:51:47\n",
      "2021-07-29 19:37:31 [INFO]\t[TRAIN] Epoch=6/32, Step=44/90, loss=0.004075, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=0.98s, eta=0:51:45\n",
      "2021-07-29 19:37:33 [INFO]\t[TRAIN] Epoch=6/32, Step=46/90, loss=0.031647, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=0.98s, eta=0:51:43\n",
      "2021-07-29 19:37:35 [INFO]\t[TRAIN] Epoch=6/32, Step=48/90, loss=0.002917, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=0.99s, eta=0:51:42\n",
      "2021-07-29 19:37:37 [INFO]\t[TRAIN] Epoch=6/32, Step=50/90, loss=0.143775, acc1=0.875, acc2=1.0, lr=0.0025, time_each_step=0.99s, eta=0:51:40\n",
      "2021-07-29 19:37:39 [INFO]\t[TRAIN] Epoch=6/32, Step=52/90, loss=0.002032, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.0s, eta=0:51:38\n",
      "2021-07-29 19:37:41 [INFO]\t[TRAIN] Epoch=6/32, Step=54/90, loss=0.067047, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.01s, eta=0:51:36\n",
      "2021-07-29 19:37:44 [INFO]\t[TRAIN] Epoch=6/32, Step=56/90, loss=0.007474, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.03s, eta=0:51:35\n",
      "2021-07-29 19:37:46 [INFO]\t[TRAIN] Epoch=6/32, Step=58/90, loss=0.314337, acc1=0.875, acc2=1.0, lr=0.0025, time_each_step=1.04s, eta=0:51:33\n",
      "2021-07-29 19:37:48 [INFO]\t[TRAIN] Epoch=6/32, Step=60/90, loss=0.001344, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.04s, eta=0:51:31\n",
      "2021-07-29 19:37:50 [INFO]\t[TRAIN] Epoch=6/32, Step=62/90, loss=0.03687, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.04s, eta=0:51:29\n",
      "2021-07-29 19:37:52 [INFO]\t[TRAIN] Epoch=6/32, Step=64/90, loss=0.086299, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.04s, eta=0:51:27\n",
      "2021-07-29 19:37:54 [INFO]\t[TRAIN] Epoch=6/32, Step=66/90, loss=0.020859, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.05s, eta=0:51:25\n",
      "2021-07-29 19:37:56 [INFO]\t[TRAIN] Epoch=6/32, Step=68/90, loss=0.01705, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.05s, eta=0:51:23\n",
      "2021-07-29 19:37:58 [INFO]\t[TRAIN] Epoch=6/32, Step=70/90, loss=0.512078, acc1=0.75, acc2=1.0, lr=0.0025, time_each_step=1.05s, eta=0:51:21\n",
      "2021-07-29 19:38:00 [INFO]\t[TRAIN] Epoch=6/32, Step=72/90, loss=0.027054, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.04s, eta=0:51:19\n",
      "2021-07-29 19:38:02 [INFO]\t[TRAIN] Epoch=6/32, Step=74/90, loss=0.005237, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.03s, eta=0:51:16\n",
      "2021-07-29 19:38:04 [INFO]\t[TRAIN] Epoch=6/32, Step=76/90, loss=0.003334, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.01s, eta=0:51:14\n",
      "2021-07-29 19:38:06 [INFO]\t[TRAIN] Epoch=6/32, Step=78/90, loss=0.007983, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.02s, eta=0:51:12\n",
      "2021-07-29 19:38:08 [INFO]\t[TRAIN] Epoch=6/32, Step=80/90, loss=0.003414, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.01s, eta=0:51:10\n",
      "2021-07-29 19:38:10 [INFO]\t[TRAIN] Epoch=6/32, Step=82/90, loss=0.002346, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.0s, eta=0:51:8\n",
      "2021-07-29 19:38:12 [INFO]\t[TRAIN] Epoch=6/32, Step=84/90, loss=0.011664, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.01s, eta=0:51:6\n",
      "2021-07-29 19:38:14 [INFO]\t[TRAIN] Epoch=6/32, Step=86/90, loss=0.026357, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=1.0s, eta=0:51:4\n",
      "2021-07-29 19:38:16 [INFO]\t[TRAIN] Epoch=6/32, Step=88/90, loss=0.002552, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=0.98s, eta=0:51:2\n",
      "2021-07-29 19:38:17 [INFO]\t[TRAIN] Epoch=6/32, Step=90/90, loss=0.002738, acc1=1.0, acc2=1.0, lr=0.0025, time_each_step=0.96s, eta=0:51:0\n",
      "2021-07-29 19:38:17 [INFO]\t[TRAIN] Epoch 6 finished, loss=0.04883, acc1=0.981944, acc2=1.0, lr=0.0025 .\n",
      "2021-07-29 19:38:17 [INFO]\tStart to evaluating(total_samples=80, total_steps=10)...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 10/10 [00:17<00:00,  1.72s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2021-07-29 19:38:34 [INFO]\t[EVAL] Finished, Epoch=6, acc1=0.9875, acc2=1.0 .\n",
      "2021-07-29 19:38:35 [INFO]\tModel saved in output/mobilenetv3_small_ssld/epoch_6.\n",
      "2021-07-29 19:38:35 [INFO]\tCurrent evaluated best model in eval_dataset is epoch_5, acc1=0.9875\n",
      "2021-07-29 19:38:41 [INFO]\t[TRAIN] Epoch=7/32, Step=2/90, loss=0.48959, acc1=0.625, acc2=1.0, lr=0.00025, time_each_step=1.19s, eta=0:50:23\n",
      "2021-07-29 19:38:44 [INFO]\t[TRAIN] Epoch=7/32, Step=4/90, loss=0.161098, acc1=0.875, acc2=1.0, lr=0.00025, time_each_step=1.21s, eta=0:50:22\n",
      "2021-07-29 19:38:46 [INFO]\t[TRAIN] Epoch=7/32, Step=6/90, loss=0.031216, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.21s, eta=0:50:20\n",
      "2021-07-29 19:38:48 [INFO]\t[TRAIN] Epoch=7/32, Step=8/90, loss=0.006526, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.22s, eta=0:50:18\n",
      "2021-07-29 19:38:50 [INFO]\t[TRAIN] Epoch=7/32, Step=10/90, loss=0.002729, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.24s, eta=0:50:17\n",
      "2021-07-29 19:38:53 [INFO]\t[TRAIN] Epoch=7/32, Step=12/90, loss=0.011012, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.27s, eta=0:50:17\n",
      "2021-07-29 19:38:55 [INFO]\t[TRAIN] Epoch=7/32, Step=14/90, loss=0.006224, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.27s, eta=0:50:14\n",
      "2021-07-29 19:38:57 [INFO]\t[TRAIN] Epoch=7/32, Step=16/90, loss=0.010298, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.27s, eta=0:50:12\n",
      "2021-07-29 19:38:59 [INFO]\t[TRAIN] Epoch=7/32, Step=18/90, loss=0.003491, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.29s, eta=0:50:10\n",
      "2021-07-29 19:39:01 [INFO]\t[TRAIN] Epoch=7/32, Step=20/90, loss=0.012213, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.32s, eta=0:50:10\n",
      "2021-07-29 19:39:03 [INFO]\t[TRAIN] Epoch=7/32, Step=22/90, loss=0.000806, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.09s, eta=0:49:52\n",
      "2021-07-29 19:39:05 [INFO]\t[TRAIN] Epoch=7/32, Step=24/90, loss=0.014313, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.09s, eta=0:49:50\n",
      "2021-07-29 19:39:07 [INFO]\t[TRAIN] Epoch=7/32, Step=26/90, loss=0.017688, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.07s, eta=0:49:47\n",
      "2021-07-29 19:39:09 [INFO]\t[TRAIN] Epoch=7/32, Step=28/90, loss=0.008397, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.06s, eta=0:49:43\n",
      "2021-07-29 19:39:11 [INFO]\t[TRAIN] Epoch=7/32, Step=30/90, loss=0.044195, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.03s, eta=0:49:40\n",
      "2021-07-29 19:39:13 [INFO]\t[TRAIN] Epoch=7/32, Step=32/90, loss=0.001769, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.01s, eta=0:49:36\n",
      "2021-07-29 19:39:15 [INFO]\t[TRAIN] Epoch=7/32, Step=34/90, loss=0.014002, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.0s, eta=0:49:34\n",
      "2021-07-29 19:39:17 [INFO]\t[TRAIN] Epoch=7/32, Step=36/90, loss=0.003834, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.0s, eta=0:49:32\n",
      "2021-07-29 19:39:19 [INFO]\t[TRAIN] Epoch=7/32, Step=38/90, loss=0.00346, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.0s, eta=0:49:30\n",
      "2021-07-29 19:39:21 [INFO]\t[TRAIN] Epoch=7/32, Step=40/90, loss=0.027092, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.0s, eta=0:49:28\n",
      "2021-07-29 19:39:23 [INFO]\t[TRAIN] Epoch=7/32, Step=42/90, loss=0.008355, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=0.98s, eta=0:49:25\n",
      "2021-07-29 19:39:25 [INFO]\t[TRAIN] Epoch=7/32, Step=44/90, loss=0.01936, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=0.98s, eta=0:49:23\n",
      "2021-07-29 19:39:27 [INFO]\t[TRAIN] Epoch=7/32, Step=46/90, loss=0.068773, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=0.98s, eta=0:49:21\n",
      "2021-07-29 19:39:29 [INFO]\t[TRAIN] Epoch=7/32, Step=48/90, loss=0.01083, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=0.98s, eta=0:49:19\n",
      "2021-07-29 19:39:31 [INFO]\t[TRAIN] Epoch=7/32, Step=50/90, loss=0.019404, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=0.99s, eta=0:49:17\n",
      "2021-07-29 19:39:33 [INFO]\t[TRAIN] Epoch=7/32, Step=52/90, loss=0.002555, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=0.99s, eta=0:49:15\n",
      "2021-07-29 19:39:35 [INFO]\t[TRAIN] Epoch=7/32, Step=54/90, loss=0.000707, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=0.99s, eta=0:49:14\n",
      "2021-07-29 19:39:37 [INFO]\t[TRAIN] Epoch=7/32, Step=56/90, loss=0.018644, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.0s, eta=0:49:12\n",
      "2021-07-29 19:39:39 [INFO]\t[TRAIN] Epoch=7/32, Step=58/90, loss=0.018823, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.0s, eta=0:49:10\n",
      "2021-07-29 19:39:41 [INFO]\t[TRAIN] Epoch=7/32, Step=60/90, loss=0.175046, acc1=0.875, acc2=1.0, lr=0.00025, time_each_step=1.0s, eta=0:49:8\n",
      "2021-07-29 19:39:43 [INFO]\t[TRAIN] Epoch=7/32, Step=62/90, loss=0.031655, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.0s, eta=0:49:6\n",
      "2021-07-29 19:39:45 [INFO]\t[TRAIN] Epoch=7/32, Step=64/90, loss=0.010358, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.0s, eta=0:49:4\n",
      "2021-07-29 19:39:47 [INFO]\t[TRAIN] Epoch=7/32, Step=66/90, loss=0.114147, acc1=0.875, acc2=1.0, lr=0.00025, time_each_step=1.0s, eta=0:49:2\n",
      "2021-07-29 19:39:49 [INFO]\t[TRAIN] Epoch=7/32, Step=68/90, loss=0.00151, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.0s, eta=0:49:0\n",
      "2021-07-29 19:39:51 [INFO]\t[TRAIN] Epoch=7/32, Step=70/90, loss=0.005398, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.0s, eta=0:48:58\n",
      "2021-07-29 19:39:53 [INFO]\t[TRAIN] Epoch=7/32, Step=72/90, loss=0.12678, acc1=0.875, acc2=1.0, lr=0.00025, time_each_step=1.0s, eta=0:48:56\n",
      "2021-07-29 19:39:55 [INFO]\t[TRAIN] Epoch=7/32, Step=74/90, loss=0.052877, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.01s, eta=0:48:54\n",
      "2021-07-29 19:39:57 [INFO]\t[TRAIN] Epoch=7/32, Step=76/90, loss=0.061507, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.02s, eta=0:48:52\n",
      "2021-07-29 19:39:59 [INFO]\t[TRAIN] Epoch=7/32, Step=78/90, loss=0.403963, acc1=0.875, acc2=1.0, lr=0.00025, time_each_step=1.03s, eta=0:48:50\n",
      "2021-07-29 19:40:02 [INFO]\t[TRAIN] Epoch=7/32, Step=80/90, loss=0.017545, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.04s, eta=0:48:48\n",
      "2021-07-29 19:40:03 [INFO]\t[TRAIN] Epoch=7/32, Step=82/90, loss=0.120557, acc1=0.875, acc2=1.0, lr=0.00025, time_each_step=1.03s, eta=0:48:46\n",
      "2021-07-29 19:40:05 [INFO]\t[TRAIN] Epoch=7/32, Step=84/90, loss=0.089242, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.03s, eta=0:48:44\n",
      "2021-07-29 19:40:07 [INFO]\t[TRAIN] Epoch=7/32, Step=86/90, loss=0.03682, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.03s, eta=0:48:42\n",
      "2021-07-29 19:40:09 [INFO]\t[TRAIN] Epoch=7/32, Step=88/90, loss=0.007869, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.02s, eta=0:48:40\n",
      "2021-07-29 19:40:10 [INFO]\t[TRAIN] Epoch=7/32, Step=90/90, loss=0.004151, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=0.99s, eta=0:48:38\n",
      "2021-07-29 19:40:10 [INFO]\t[TRAIN] Epoch 7 finished, loss=0.049108, acc1=0.979167, acc2=1.0, lr=0.00025 .\n",
      "2021-07-29 19:40:10 [INFO]\tStart to evaluating(total_samples=80, total_steps=10)...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 10/10 [00:19<00:00,  1.98s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2021-07-29 19:40:30 [INFO]\t[EVAL] Finished, Epoch=7, acc1=0.975, acc2=1.0 .\n",
      "2021-07-29 19:40:31 [INFO]\tModel saved in output/mobilenetv3_small_ssld/epoch_7.\n",
      "2021-07-29 19:40:31 [INFO]\tCurrent evaluated best model in eval_dataset is epoch_5, acc1=0.9875\n",
      "2021-07-29 19:40:38 [INFO]\t[TRAIN] Epoch=8/32, Step=2/90, loss=0.00357, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.23s, eta=0:48:33\n",
      "2021-07-29 19:40:40 [INFO]\t[TRAIN] Epoch=8/32, Step=4/90, loss=0.011792, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.23s, eta=0:48:30\n",
      "2021-07-29 19:40:42 [INFO]\t[TRAIN] Epoch=8/32, Step=6/90, loss=0.008774, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.23s, eta=0:48:27\n",
      "2021-07-29 19:40:44 [INFO]\t[TRAIN] Epoch=8/32, Step=8/90, loss=0.005267, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.21s, eta=0:48:24\n",
      "2021-07-29 19:40:46 [INFO]\t[TRAIN] Epoch=8/32, Step=10/90, loss=0.041849, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.22s, eta=0:48:22\n",
      "2021-07-29 19:40:48 [INFO]\t[TRAIN] Epoch=8/32, Step=12/90, loss=0.000469, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.24s, eta=0:48:21\n",
      "2021-07-29 19:40:50 [INFO]\t[TRAIN] Epoch=8/32, Step=14/90, loss=0.05916, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.24s, eta=0:48:18\n",
      "2021-07-29 19:40:52 [INFO]\t[TRAIN] Epoch=8/32, Step=16/90, loss=0.001727, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.25s, eta=0:48:17\n",
      "2021-07-29 19:40:54 [INFO]\t[TRAIN] Epoch=8/32, Step=18/90, loss=0.012814, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.26s, eta=0:48:15\n",
      "2021-07-29 19:40:56 [INFO]\t[TRAIN] Epoch=8/32, Step=20/90, loss=0.002519, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.29s, eta=0:48:14\n",
      "2021-07-29 19:40:58 [INFO]\t[TRAIN] Epoch=8/32, Step=22/90, loss=0.005112, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.04s, eta=0:47:55\n",
      "2021-07-29 19:41:00 [INFO]\t[TRAIN] Epoch=8/32, Step=24/90, loss=0.009842, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.03s, eta=0:47:52\n",
      "2021-07-29 19:41:02 [INFO]\t[TRAIN] Epoch=8/32, Step=26/90, loss=0.020628, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.03s, eta=0:47:50\n",
      "2021-07-29 19:41:05 [INFO]\t[TRAIN] Epoch=8/32, Step=28/90, loss=0.004045, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.03s, eta=0:47:48\n",
      "2021-07-29 19:41:07 [INFO]\t[TRAIN] Epoch=8/32, Step=30/90, loss=0.014873, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.04s, eta=0:47:47\n",
      "2021-07-29 19:41:09 [INFO]\t[TRAIN] Epoch=8/32, Step=32/90, loss=0.001425, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.03s, eta=0:47:44\n",
      "2021-07-29 19:41:11 [INFO]\t[TRAIN] Epoch=8/32, Step=34/90, loss=0.203769, acc1=0.875, acc2=1.0, lr=0.00025, time_each_step=1.03s, eta=0:47:42\n",
      "2021-07-29 19:41:13 [INFO]\t[TRAIN] Epoch=8/32, Step=36/90, loss=0.156279, acc1=0.875, acc2=1.0, lr=0.00025, time_each_step=1.01s, eta=0:47:39\n",
      "2021-07-29 19:41:15 [INFO]\t[TRAIN] Epoch=8/32, Step=38/90, loss=0.141856, acc1=0.875, acc2=1.0, lr=0.00025, time_each_step=1.01s, eta=0:47:37\n",
      "2021-07-29 19:41:17 [INFO]\t[TRAIN] Epoch=8/32, Step=40/90, loss=0.148342, acc1=0.875, acc2=1.0, lr=0.00025, time_each_step=1.02s, eta=0:47:36\n",
      "2021-07-29 19:41:19 [INFO]\t[TRAIN] Epoch=8/32, Step=42/90, loss=0.000262, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.02s, eta=0:47:33\n",
      "2021-07-29 19:41:21 [INFO]\t[TRAIN] Epoch=8/32, Step=44/90, loss=0.000585, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.02s, eta=0:47:31\n",
      "2021-07-29 19:41:23 [INFO]\t[TRAIN] Epoch=8/32, Step=46/90, loss=0.005215, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.02s, eta=0:47:29\n",
      "2021-07-29 19:41:25 [INFO]\t[TRAIN] Epoch=8/32, Step=48/90, loss=0.002181, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.02s, eta=0:47:27\n",
      "2021-07-29 19:41:27 [INFO]\t[TRAIN] Epoch=8/32, Step=50/90, loss=0.003372, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.0s, eta=0:47:24\n",
      "2021-07-29 19:41:29 [INFO]\t[TRAIN] Epoch=8/32, Step=52/90, loss=0.006715, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.0s, eta=0:47:23\n",
      "2021-07-29 19:41:31 [INFO]\t[TRAIN] Epoch=8/32, Step=54/90, loss=0.089141, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.01s, eta=0:47:21\n",
      "2021-07-29 19:41:33 [INFO]\t[TRAIN] Epoch=8/32, Step=56/90, loss=0.006692, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.01s, eta=0:47:19\n",
      "2021-07-29 19:41:35 [INFO]\t[TRAIN] Epoch=8/32, Step=58/90, loss=0.003972, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.01s, eta=0:47:17\n",
      "2021-07-29 19:41:37 [INFO]\t[TRAIN] Epoch=8/32, Step=60/90, loss=0.07574, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.0s, eta=0:47:14\n",
      "2021-07-29 19:41:39 [INFO]\t[TRAIN] Epoch=8/32, Step=62/90, loss=0.062714, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.0s, eta=0:47:12\n",
      "2021-07-29 19:41:41 [INFO]\t[TRAIN] Epoch=8/32, Step=64/90, loss=0.005933, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=0.99s, eta=0:47:10\n",
      "2021-07-29 19:41:43 [INFO]\t[TRAIN] Epoch=8/32, Step=66/90, loss=0.03766, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=0.98s, eta=0:47:8\n",
      "2021-07-29 19:41:45 [INFO]\t[TRAIN] Epoch=8/32, Step=68/90, loss=0.002882, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=0.99s, eta=0:47:6\n",
      "2021-07-29 19:41:47 [INFO]\t[TRAIN] Epoch=8/32, Step=70/90, loss=0.003375, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=0.99s, eta=0:47:4\n",
      "2021-07-29 19:41:49 [INFO]\t[TRAIN] Epoch=8/32, Step=72/90, loss=0.018717, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=0.99s, eta=0:47:2\n",
      "2021-07-29 19:41:51 [INFO]\t[TRAIN] Epoch=8/32, Step=74/90, loss=0.109427, acc1=0.875, acc2=1.0, lr=0.00025, time_each_step=0.98s, eta=0:47:0\n",
      "2021-07-29 19:41:53 [INFO]\t[TRAIN] Epoch=8/32, Step=76/90, loss=0.31389, acc1=0.875, acc2=1.0, lr=0.00025, time_each_step=0.98s, eta=0:46:58\n",
      "2021-07-29 19:41:55 [INFO]\t[TRAIN] Epoch=8/32, Step=78/90, loss=0.000477, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=0.99s, eta=0:46:56\n",
      "2021-07-29 19:41:57 [INFO]\t[TRAIN] Epoch=8/32, Step=80/90, loss=0.020348, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=0.99s, eta=0:46:54\n",
      "2021-07-29 19:41:59 [INFO]\t[TRAIN] Epoch=8/32, Step=82/90, loss=0.003235, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=0.99s, eta=0:46:52\n",
      "2021-07-29 19:42:01 [INFO]\t[TRAIN] Epoch=8/32, Step=84/90, loss=0.079254, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.0s, eta=0:46:50\n",
      "2021-07-29 19:42:02 [INFO]\t[TRAIN] Epoch=8/32, Step=86/90, loss=0.02624, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=1.0s, eta=0:46:48\n",
      "2021-07-29 19:42:04 [INFO]\t[TRAIN] Epoch=8/32, Step=88/90, loss=0.035239, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=0.98s, eta=0:46:46\n",
      "2021-07-29 19:42:06 [INFO]\t[TRAIN] Epoch=8/32, Step=90/90, loss=0.001456, acc1=1.0, acc2=1.0, lr=0.00025, time_each_step=0.95s, eta=0:46:44\n",
      "2021-07-29 19:42:06 [INFO]\t[TRAIN] Epoch 8 finished, loss=0.035743, acc1=0.984722, acc2=1.0, lr=0.00025 .\n",
      "2021-07-29 19:42:06 [INFO]\tStart to evaluating(total_samples=80, total_steps=10)...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 10/10 [00:17<00:00,  1.76s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2021-07-29 19:42:23 [INFO]\t[EVAL] Finished, Epoch=8, acc1=0.975, acc2=1.0 .\n",
      "2021-07-29 19:42:24 [INFO]\tModel saved in output/mobilenetv3_small_ssld/epoch_8.\n",
      "2021-07-29 19:42:24 [INFO]\tCurrent evaluated best model in eval_dataset is epoch_5, acc1=0.9875\n",
      "2021-07-29 19:42:30 [INFO]\t[TRAIN] Epoch=9/32, Step=2/90, loss=0.167525, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.19s, eta=0:45:21\n",
      "2021-07-29 19:42:33 [INFO]\t[TRAIN] Epoch=9/32, Step=4/90, loss=0.020903, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.21s, eta=0:45:20\n",
      "2021-07-29 19:42:35 [INFO]\t[TRAIN] Epoch=9/32, Step=6/90, loss=0.030171, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.21s, eta=0:45:18\n",
      "2021-07-29 19:42:37 [INFO]\t[TRAIN] Epoch=9/32, Step=8/90, loss=0.022821, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.21s, eta=0:45:15\n",
      "2021-07-29 19:42:39 [INFO]\t[TRAIN] Epoch=9/32, Step=10/90, loss=0.002314, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.21s, eta=0:45:13\n",
      "2021-07-29 19:42:41 [INFO]\t[TRAIN] Epoch=9/32, Step=12/90, loss=0.091597, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.21s, eta=0:45:11\n",
      "2021-07-29 19:42:43 [INFO]\t[TRAIN] Epoch=9/32, Step=14/90, loss=0.000816, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.22s, eta=0:45:9\n",
      "2021-07-29 19:42:45 [INFO]\t[TRAIN] Epoch=9/32, Step=16/90, loss=0.010206, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.23s, eta=0:45:7\n",
      "2021-07-29 19:42:47 [INFO]\t[TRAIN] Epoch=9/32, Step=18/90, loss=0.001139, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.24s, eta=0:45:5\n",
      "2021-07-29 19:42:49 [INFO]\t[TRAIN] Epoch=9/32, Step=20/90, loss=0.0478, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.29s, eta=0:45:6\n",
      "2021-07-29 19:42:51 [INFO]\t[TRAIN] Epoch=9/32, Step=22/90, loss=0.030411, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:44:48\n",
      "2021-07-29 19:42:53 [INFO]\t[TRAIN] Epoch=9/32, Step=24/90, loss=0.037795, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:44:45\n",
      "2021-07-29 19:42:55 [INFO]\t[TRAIN] Epoch=9/32, Step=26/90, loss=0.075128, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:44:42\n",
      "2021-07-29 19:42:57 [INFO]\t[TRAIN] Epoch=9/32, Step=28/90, loss=0.698912, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:44:40\n",
      "2021-07-29 19:42:59 [INFO]\t[TRAIN] Epoch=9/32, Step=30/90, loss=0.010676, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:44:38\n",
      "2021-07-29 19:43:01 [INFO]\t[TRAIN] Epoch=9/32, Step=32/90, loss=0.183763, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:44:35\n",
      "2021-07-29 19:43:03 [INFO]\t[TRAIN] Epoch=9/32, Step=34/90, loss=0.003012, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:44:33\n",
      "2021-07-29 19:43:05 [INFO]\t[TRAIN] Epoch=9/32, Step=36/90, loss=0.009143, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:44:31\n",
      "2021-07-29 19:43:07 [INFO]\t[TRAIN] Epoch=9/32, Step=38/90, loss=0.034314, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:44:29\n",
      "2021-07-29 19:43:09 [INFO]\t[TRAIN] Epoch=9/32, Step=40/90, loss=0.002835, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.0s, eta=0:44:26\n",
      "2021-07-29 19:43:11 [INFO]\t[TRAIN] Epoch=9/32, Step=42/90, loss=0.018387, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.0s, eta=0:44:24\n",
      "2021-07-29 19:43:14 [INFO]\t[TRAIN] Epoch=9/32, Step=44/90, loss=0.003, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:44:23\n",
      "2021-07-29 19:43:16 [INFO]\t[TRAIN] Epoch=9/32, Step=46/90, loss=0.071527, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:44:21\n",
      "2021-07-29 19:43:18 [INFO]\t[TRAIN] Epoch=9/32, Step=48/90, loss=0.05357, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:44:19\n",
      "2021-07-29 19:43:20 [INFO]\t[TRAIN] Epoch=9/32, Step=50/90, loss=0.000533, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:44:18\n",
      "2021-07-29 19:43:22 [INFO]\t[TRAIN] Epoch=9/32, Step=52/90, loss=0.029711, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:44:16\n",
      "2021-07-29 19:43:24 [INFO]\t[TRAIN] Epoch=9/32, Step=54/90, loss=0.282838, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:44:14\n",
      "2021-07-29 19:43:26 [INFO]\t[TRAIN] Epoch=9/32, Step=56/90, loss=0.002309, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:44:11\n",
      "2021-07-29 19:43:28 [INFO]\t[TRAIN] Epoch=9/32, Step=58/90, loss=0.001494, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:44:9\n",
      "2021-07-29 19:43:30 [INFO]\t[TRAIN] Epoch=9/32, Step=60/90, loss=0.054975, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:44:7\n",
      "2021-07-29 19:43:32 [INFO]\t[TRAIN] Epoch=9/32, Step=62/90, loss=0.02861, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:44:5\n",
      "2021-07-29 19:43:34 [INFO]\t[TRAIN] Epoch=9/32, Step=64/90, loss=0.010416, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:44:3\n",
      "2021-07-29 19:43:36 [INFO]\t[TRAIN] Epoch=9/32, Step=66/90, loss=0.001105, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:44:1\n",
      "2021-07-29 19:43:38 [INFO]\t[TRAIN] Epoch=9/32, Step=68/90, loss=0.002731, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:43:59\n",
      "2021-07-29 19:43:40 [INFO]\t[TRAIN] Epoch=9/32, Step=70/90, loss=0.028517, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.0s, eta=0:43:56\n",
      "2021-07-29 19:43:42 [INFO]\t[TRAIN] Epoch=9/32, Step=72/90, loss=0.035154, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.0s, eta=0:43:54\n",
      "2021-07-29 19:43:44 [INFO]\t[TRAIN] Epoch=9/32, Step=74/90, loss=0.004974, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:43:52\n",
      "2021-07-29 19:43:46 [INFO]\t[TRAIN] Epoch=9/32, Step=76/90, loss=0.006977, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:43:50\n",
      "2021-07-29 19:43:48 [INFO]\t[TRAIN] Epoch=9/32, Step=78/90, loss=0.063699, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.0s, eta=0:43:48\n",
      "2021-07-29 19:43:50 [INFO]\t[TRAIN] Epoch=9/32, Step=80/90, loss=0.001279, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.0s, eta=0:43:46\n",
      "2021-07-29 19:43:52 [INFO]\t[TRAIN] Epoch=9/32, Step=82/90, loss=0.001877, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.0s, eta=0:43:44\n",
      "2021-07-29 19:43:54 [INFO]\t[TRAIN] Epoch=9/32, Step=84/90, loss=0.061491, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.0s, eta=0:43:42\n",
      "2021-07-29 19:43:56 [INFO]\t[TRAIN] Epoch=9/32, Step=86/90, loss=0.250335, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.0s, eta=0:43:40\n",
      "2021-07-29 19:43:58 [INFO]\t[TRAIN] Epoch=9/32, Step=88/90, loss=0.001479, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.98s, eta=0:43:38\n",
      "2021-07-29 19:43:59 [INFO]\t[TRAIN] Epoch=9/32, Step=90/90, loss=0.004275, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.96s, eta=0:43:36\n",
      "2021-07-29 19:43:59 [INFO]\t[TRAIN] Epoch 9 finished, loss=0.060581, acc1=0.983333, acc2=1.0, lr=2.5e-05 .\n",
      "2021-07-29 19:43:59 [INFO]\tStart to evaluating(total_samples=80, total_steps=10)...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 10/10 [00:22<00:00,  2.22s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2021-07-29 19:44:22 [INFO]\t[EVAL] Finished, Epoch=9, acc1=0.975, acc2=1.0 .\n",
      "2021-07-29 19:44:22 [INFO]\tModel saved in output/mobilenetv3_small_ssld/epoch_9.\n",
      "2021-07-29 19:44:22 [INFO]\tCurrent evaluated best model in eval_dataset is epoch_5, acc1=0.9875\n",
      "2021-07-29 19:44:33 [INFO]\t[TRAIN] Epoch=10/32, Step=2/90, loss=0.00376, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.44s, eta=0:45:49\n",
      "2021-07-29 19:44:36 [INFO]\t[TRAIN] Epoch=10/32, Step=4/90, loss=0.11143, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.45s, eta=0:45:48\n",
      "2021-07-29 19:44:38 [INFO]\t[TRAIN] Epoch=10/32, Step=6/90, loss=0.000764, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.46s, eta=0:45:46\n",
      "2021-07-29 19:44:40 [INFO]\t[TRAIN] Epoch=10/32, Step=8/90, loss=0.001655, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.46s, eta=0:45:43\n",
      "2021-07-29 19:44:42 [INFO]\t[TRAIN] Epoch=10/32, Step=10/90, loss=0.020044, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.46s, eta=0:45:39\n",
      "2021-07-29 19:44:44 [INFO]\t[TRAIN] Epoch=10/32, Step=12/90, loss=0.000871, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.48s, eta=0:45:38\n",
      "2021-07-29 19:44:46 [INFO]\t[TRAIN] Epoch=10/32, Step=14/90, loss=0.010848, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.48s, eta=0:45:35\n",
      "2021-07-29 19:44:48 [INFO]\t[TRAIN] Epoch=10/32, Step=16/90, loss=0.002484, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.48s, eta=0:45:32\n",
      "2021-07-29 19:44:50 [INFO]\t[TRAIN] Epoch=10/32, Step=18/90, loss=0.002816, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.5s, eta=0:45:31\n",
      "2021-07-29 19:44:52 [INFO]\t[TRAIN] Epoch=10/32, Step=20/90, loss=0.007069, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.53s, eta=0:45:30\n",
      "2021-07-29 19:44:54 [INFO]\t[TRAIN] Epoch=10/32, Step=22/90, loss=0.272847, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:44:54\n",
      "2021-07-29 19:44:56 [INFO]\t[TRAIN] Epoch=10/32, Step=24/90, loss=0.001489, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:44:51\n",
      "2021-07-29 19:44:58 [INFO]\t[TRAIN] Epoch=10/32, Step=26/90, loss=0.008089, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:44:49\n",
      "2021-07-29 19:45:00 [INFO]\t[TRAIN] Epoch=10/32, Step=28/90, loss=0.105528, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:44:47\n",
      "2021-07-29 19:45:02 [INFO]\t[TRAIN] Epoch=10/32, Step=30/90, loss=0.004209, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:44:44\n",
      "2021-07-29 19:45:04 [INFO]\t[TRAIN] Epoch=10/32, Step=32/90, loss=0.000498, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:44:41\n",
      "2021-07-29 19:45:06 [INFO]\t[TRAIN] Epoch=10/32, Step=34/90, loss=0.01883, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:44:39\n",
      "2021-07-29 19:45:08 [INFO]\t[TRAIN] Epoch=10/32, Step=36/90, loss=0.093286, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.0s, eta=0:44:37\n",
      "2021-07-29 19:45:10 [INFO]\t[TRAIN] Epoch=10/32, Step=38/90, loss=0.011489, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.0s, eta=0:44:35\n",
      "2021-07-29 19:45:12 [INFO]\t[TRAIN] Epoch=10/32, Step=40/90, loss=0.017281, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:44:32\n",
      "2021-07-29 19:45:14 [INFO]\t[TRAIN] Epoch=10/32, Step=42/90, loss=0.004972, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:44:30\n",
      "2021-07-29 19:45:16 [INFO]\t[TRAIN] Epoch=10/32, Step=44/90, loss=0.002892, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:44:29\n",
      "2021-07-29 19:45:18 [INFO]\t[TRAIN] Epoch=10/32, Step=46/90, loss=0.009574, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:44:26\n",
      "2021-07-29 19:45:20 [INFO]\t[TRAIN] Epoch=10/32, Step=48/90, loss=0.000312, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:44:24\n",
      "2021-07-29 19:45:22 [INFO]\t[TRAIN] Epoch=10/32, Step=50/90, loss=0.02663, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:44:22\n",
      "2021-07-29 19:45:24 [INFO]\t[TRAIN] Epoch=10/32, Step=52/90, loss=0.002249, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.0s, eta=0:44:21\n",
      "2021-07-29 19:45:26 [INFO]\t[TRAIN] Epoch=10/32, Step=54/90, loss=0.098178, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.0s, eta=0:44:19\n",
      "2021-07-29 19:45:29 [INFO]\t[TRAIN] Epoch=10/32, Step=56/90, loss=0.000309, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:44:17\n",
      "2021-07-29 19:45:31 [INFO]\t[TRAIN] Epoch=10/32, Step=58/90, loss=0.008234, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:44:16\n",
      "2021-07-29 19:45:33 [INFO]\t[TRAIN] Epoch=10/32, Step=60/90, loss=0.008175, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:44:14\n",
      "2021-07-29 19:45:35 [INFO]\t[TRAIN] Epoch=10/32, Step=62/90, loss=0.002505, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:44:12\n",
      "2021-07-29 19:45:37 [INFO]\t[TRAIN] Epoch=10/32, Step=64/90, loss=0.000329, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:44:10\n",
      "2021-07-29 19:45:39 [INFO]\t[TRAIN] Epoch=10/32, Step=66/90, loss=0.039034, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:44:8\n",
      "2021-07-29 19:45:41 [INFO]\t[TRAIN] Epoch=10/32, Step=68/90, loss=0.003304, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:44:5\n",
      "2021-07-29 19:45:43 [INFO]\t[TRAIN] Epoch=10/32, Step=70/90, loss=0.008126, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:44:3\n",
      "2021-07-29 19:45:45 [INFO]\t[TRAIN] Epoch=10/32, Step=72/90, loss=0.092982, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:44:1\n",
      "2021-07-29 19:45:47 [INFO]\t[TRAIN] Epoch=10/32, Step=74/90, loss=0.009409, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:43:59\n",
      "2021-07-29 19:45:49 [INFO]\t[TRAIN] Epoch=10/32, Step=76/90, loss=0.262979, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:43:57\n",
      "2021-07-29 19:45:51 [INFO]\t[TRAIN] Epoch=10/32, Step=78/90, loss=0.008402, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:43:55\n",
      "2021-07-29 19:45:53 [INFO]\t[TRAIN] Epoch=10/32, Step=80/90, loss=0.083369, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:43:53\n",
      "2021-07-29 19:45:55 [INFO]\t[TRAIN] Epoch=10/32, Step=82/90, loss=0.148943, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=0.98s, eta=0:43:51\n",
      "2021-07-29 19:45:57 [INFO]\t[TRAIN] Epoch=10/32, Step=84/90, loss=0.016792, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:43:49\n",
      "2021-07-29 19:45:58 [INFO]\t[TRAIN] Epoch=10/32, Step=86/90, loss=0.720071, acc1=0.75, acc2=1.0, lr=2.5e-05, time_each_step=0.98s, eta=0:43:47\n",
      "2021-07-29 19:46:00 [INFO]\t[TRAIN] Epoch=10/32, Step=88/90, loss=0.015076, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.96s, eta=0:43:45\n",
      "2021-07-29 19:46:01 [INFO]\t[TRAIN] Epoch=10/32, Step=90/90, loss=0.336804, acc1=0.75, acc2=1.0, lr=2.5e-05, time_each_step=0.94s, eta=0:43:43\n",
      "2021-07-29 19:46:02 [INFO]\t[TRAIN] Epoch 10 finished, loss=0.052015, acc1=0.976389, acc2=1.0, lr=2.5e-05 .\n",
      "2021-07-29 19:46:02 [INFO]\tStart to evaluating(total_samples=80, total_steps=10)...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 10/10 [00:18<00:00,  1.85s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2021-07-29 19:46:20 [INFO]\t[EVAL] Finished, Epoch=10, acc1=0.975, acc2=1.0 .\n",
      "2021-07-29 19:46:20 [INFO]\tModel saved in output/mobilenetv3_small_ssld/epoch_10.\n",
      "2021-07-29 19:46:20 [INFO]\tCurrent evaluated best model in eval_dataset is epoch_5, acc1=0.9875\n",
      "2021-07-29 19:46:29 [INFO]\t[TRAIN] Epoch=11/32, Step=2/90, loss=0.170768, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.24s, eta=0:43:38\n",
      "2021-07-29 19:46:31 [INFO]\t[TRAIN] Epoch=11/32, Step=4/90, loss=0.078856, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.26s, eta=0:43:37\n",
      "2021-07-29 19:46:33 [INFO]\t[TRAIN] Epoch=11/32, Step=6/90, loss=0.439846, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.27s, eta=0:43:35\n",
      "2021-07-29 19:46:35 [INFO]\t[TRAIN] Epoch=11/32, Step=8/90, loss=0.000439, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.27s, eta=0:43:33\n",
      "2021-07-29 19:46:37 [INFO]\t[TRAIN] Epoch=11/32, Step=10/90, loss=0.002435, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.28s, eta=0:43:31\n",
      "2021-07-29 19:46:39 [INFO]\t[TRAIN] Epoch=11/32, Step=12/90, loss=0.003061, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.3s, eta=0:43:30\n",
      "2021-07-29 19:46:41 [INFO]\t[TRAIN] Epoch=11/32, Step=14/90, loss=0.002039, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.29s, eta=0:43:27\n",
      "2021-07-29 19:46:43 [INFO]\t[TRAIN] Epoch=11/32, Step=16/90, loss=0.136568, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.31s, eta=0:43:25\n",
      "2021-07-29 19:46:45 [INFO]\t[TRAIN] Epoch=11/32, Step=18/90, loss=0.033351, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.32s, eta=0:43:24\n",
      "2021-07-29 19:46:48 [INFO]\t[TRAIN] Epoch=11/32, Step=20/90, loss=0.016631, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.36s, eta=0:43:24\n",
      "2021-07-29 19:46:50 [INFO]\t[TRAIN] Epoch=11/32, Step=22/90, loss=0.057656, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:43:0\n",
      "2021-07-29 19:46:51 [INFO]\t[TRAIN] Epoch=11/32, Step=24/90, loss=0.007226, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:42:57\n",
      "2021-07-29 19:46:54 [INFO]\t[TRAIN] Epoch=11/32, Step=26/90, loss=0.002429, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:42:55\n",
      "2021-07-29 19:46:56 [INFO]\t[TRAIN] Epoch=11/32, Step=28/90, loss=0.041454, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:42:53\n",
      "2021-07-29 19:46:58 [INFO]\t[TRAIN] Epoch=11/32, Step=30/90, loss=0.00374, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:42:50\n",
      "2021-07-29 19:47:00 [INFO]\t[TRAIN] Epoch=11/32, Step=32/90, loss=0.0027, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:42:47\n",
      "2021-07-29 19:47:02 [INFO]\t[TRAIN] Epoch=11/32, Step=34/90, loss=0.000823, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:42:45\n",
      "2021-07-29 19:47:04 [INFO]\t[TRAIN] Epoch=11/32, Step=36/90, loss=0.002476, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:42:43\n",
      "2021-07-29 19:47:06 [INFO]\t[TRAIN] Epoch=11/32, Step=38/90, loss=0.15492, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:42:41\n",
      "2021-07-29 19:47:08 [INFO]\t[TRAIN] Epoch=11/32, Step=40/90, loss=0.00405, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:42:40\n",
      "2021-07-29 19:47:10 [INFO]\t[TRAIN] Epoch=11/32, Step=42/90, loss=0.010515, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:42:38\n",
      "2021-07-29 19:47:12 [INFO]\t[TRAIN] Epoch=11/32, Step=44/90, loss=0.010092, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:42:37\n",
      "2021-07-29 19:47:14 [INFO]\t[TRAIN] Epoch=11/32, Step=46/90, loss=0.008153, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:42:34\n",
      "2021-07-29 19:47:16 [INFO]\t[TRAIN] Epoch=11/32, Step=48/90, loss=0.003477, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:42:32\n",
      "2021-07-29 19:47:18 [INFO]\t[TRAIN] Epoch=11/32, Step=50/90, loss=0.027063, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:42:30\n",
      "2021-07-29 19:47:20 [INFO]\t[TRAIN] Epoch=11/32, Step=52/90, loss=0.001189, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:42:28\n",
      "2021-07-29 19:47:22 [INFO]\t[TRAIN] Epoch=11/32, Step=54/90, loss=0.061797, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:42:26\n",
      "2021-07-29 19:47:24 [INFO]\t[TRAIN] Epoch=11/32, Step=56/90, loss=0.02303, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:42:24\n",
      "2021-07-29 19:47:26 [INFO]\t[TRAIN] Epoch=11/32, Step=58/90, loss=0.183022, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:42:22\n",
      "2021-07-29 19:47:28 [INFO]\t[TRAIN] Epoch=11/32, Step=60/90, loss=0.379291, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:42:19\n",
      "2021-07-29 19:47:30 [INFO]\t[TRAIN] Epoch=11/32, Step=62/90, loss=0.657919, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:42:17\n",
      "2021-07-29 19:47:32 [INFO]\t[TRAIN] Epoch=11/32, Step=64/90, loss=0.035489, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:42:14\n",
      "2021-07-29 19:47:34 [INFO]\t[TRAIN] Epoch=11/32, Step=66/90, loss=0.026204, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:42:12\n",
      "2021-07-29 19:47:36 [INFO]\t[TRAIN] Epoch=11/32, Step=68/90, loss=0.001024, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:42:10\n",
      "2021-07-29 19:47:38 [INFO]\t[TRAIN] Epoch=11/32, Step=70/90, loss=0.018095, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:42:8\n",
      "2021-07-29 19:47:40 [INFO]\t[TRAIN] Epoch=11/32, Step=72/90, loss=0.003203, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:42:7\n",
      "2021-07-29 19:47:42 [INFO]\t[TRAIN] Epoch=11/32, Step=74/90, loss=0.014758, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.0s, eta=0:42:5\n",
      "2021-07-29 19:47:44 [INFO]\t[TRAIN] Epoch=11/32, Step=76/90, loss=0.124091, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:42:2\n",
      "2021-07-29 19:47:46 [INFO]\t[TRAIN] Epoch=11/32, Step=78/90, loss=0.001163, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:42:0\n",
      "2021-07-29 19:47:48 [INFO]\t[TRAIN] Epoch=11/32, Step=80/90, loss=0.001251, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:41:58\n",
      "2021-07-29 19:47:50 [INFO]\t[TRAIN] Epoch=11/32, Step=82/90, loss=0.000458, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:41:57\n",
      "2021-07-29 19:47:52 [INFO]\t[TRAIN] Epoch=11/32, Step=84/90, loss=0.005574, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:41:55\n",
      "2021-07-29 19:47:54 [INFO]\t[TRAIN] Epoch=11/32, Step=86/90, loss=0.01613, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.0s, eta=0:41:53\n",
      "2021-07-29 19:47:56 [INFO]\t[TRAIN] Epoch=11/32, Step=88/90, loss=0.000621, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.98s, eta=0:41:51\n",
      "2021-07-29 19:47:57 [INFO]\t[TRAIN] Epoch=11/32, Step=90/90, loss=0.032907, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.96s, eta=0:41:49\n",
      "2021-07-29 19:47:57 [INFO]\t[TRAIN] Epoch 11 finished, loss=0.070684, acc1=0.975, acc2=1.0, lr=2.5e-05 .\n",
      "2021-07-29 19:47:57 [INFO]\tStart to evaluating(total_samples=80, total_steps=10)...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 10/10 [00:19<00:00,  1.97s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2021-07-29 19:48:17 [INFO]\t[EVAL] Finished, Epoch=11, acc1=0.975, acc2=1.0 .\n",
      "2021-07-29 19:48:17 [INFO]\tModel saved in output/mobilenetv3_small_ssld/epoch_11.\n",
      "2021-07-29 19:48:17 [INFO]\tCurrent evaluated best model in eval_dataset is epoch_5, acc1=0.9875\n",
      "2021-07-29 19:48:29 [INFO]\t[TRAIN] Epoch=12/32, Step=2/90, loss=0.003517, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.42s, eta=0:41:24\n",
      "2021-07-29 19:48:31 [INFO]\t[TRAIN] Epoch=12/32, Step=4/90, loss=0.007317, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.43s, eta=0:41:22\n",
      "2021-07-29 19:48:33 [INFO]\t[TRAIN] Epoch=12/32, Step=6/90, loss=0.003052, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.44s, eta=0:41:20\n",
      "2021-07-29 19:48:35 [INFO]\t[TRAIN] Epoch=12/32, Step=8/90, loss=0.036225, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.45s, eta=0:41:18\n",
      "2021-07-29 19:48:37 [INFO]\t[TRAIN] Epoch=12/32, Step=10/90, loss=0.01065, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.46s, eta=0:41:16\n",
      "2021-07-29 19:48:39 [INFO]\t[TRAIN] Epoch=12/32, Step=12/90, loss=0.061793, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.45s, eta=0:41:12\n",
      "2021-07-29 19:48:41 [INFO]\t[TRAIN] Epoch=12/32, Step=14/90, loss=0.044956, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.45s, eta=0:41:9\n",
      "2021-07-29 19:48:43 [INFO]\t[TRAIN] Epoch=12/32, Step=16/90, loss=0.051005, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.46s, eta=0:41:7\n",
      "2021-07-29 19:48:45 [INFO]\t[TRAIN] Epoch=12/32, Step=18/90, loss=0.014438, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.48s, eta=0:41:6\n",
      "2021-07-29 19:48:48 [INFO]\t[TRAIN] Epoch=12/32, Step=20/90, loss=0.001161, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.51s, eta=0:41:5\n",
      "2021-07-29 19:48:50 [INFO]\t[TRAIN] Epoch=12/32, Step=22/90, loss=0.002364, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:40:30\n",
      "2021-07-29 19:48:52 [INFO]\t[TRAIN] Epoch=12/32, Step=24/90, loss=0.064718, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:40:27\n",
      "2021-07-29 19:48:54 [INFO]\t[TRAIN] Epoch=12/32, Step=26/90, loss=0.022353, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:40:25\n",
      "2021-07-29 19:48:56 [INFO]\t[TRAIN] Epoch=12/32, Step=28/90, loss=0.001148, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:40:23\n",
      "2021-07-29 19:48:58 [INFO]\t[TRAIN] Epoch=12/32, Step=30/90, loss=0.013221, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:40:20\n",
      "2021-07-29 19:49:00 [INFO]\t[TRAIN] Epoch=12/32, Step=32/90, loss=0.002752, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:40:18\n",
      "2021-07-29 19:49:02 [INFO]\t[TRAIN] Epoch=12/32, Step=34/90, loss=0.007748, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:40:16\n",
      "2021-07-29 19:49:04 [INFO]\t[TRAIN] Epoch=12/32, Step=36/90, loss=0.065065, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:40:14\n",
      "2021-07-29 19:49:06 [INFO]\t[TRAIN] Epoch=12/32, Step=38/90, loss=0.000303, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:40:11\n",
      "2021-07-29 19:49:08 [INFO]\t[TRAIN] Epoch=12/32, Step=40/90, loss=0.002737, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.0s, eta=0:40:9\n",
      "2021-07-29 19:49:10 [INFO]\t[TRAIN] Epoch=12/32, Step=42/90, loss=0.308144, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:40:7\n",
      "2021-07-29 19:49:12 [INFO]\t[TRAIN] Epoch=12/32, Step=44/90, loss=0.003877, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:40:5\n",
      "2021-07-29 19:49:14 [INFO]\t[TRAIN] Epoch=12/32, Step=46/90, loss=0.028265, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.0s, eta=0:40:3\n",
      "2021-07-29 19:49:16 [INFO]\t[TRAIN] Epoch=12/32, Step=48/90, loss=0.001966, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:40:1\n",
      "2021-07-29 19:49:18 [INFO]\t[TRAIN] Epoch=12/32, Step=50/90, loss=0.020734, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.0s, eta=0:39:59\n",
      "2021-07-29 19:49:20 [INFO]\t[TRAIN] Epoch=12/32, Step=52/90, loss=0.008669, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:39:57\n",
      "2021-07-29 19:49:22 [INFO]\t[TRAIN] Epoch=12/32, Step=54/90, loss=0.013525, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:39:55\n",
      "2021-07-29 19:49:24 [INFO]\t[TRAIN] Epoch=12/32, Step=56/90, loss=0.012912, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:39:53\n",
      "2021-07-29 19:49:26 [INFO]\t[TRAIN] Epoch=12/32, Step=58/90, loss=0.047909, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:39:52\n",
      "2021-07-29 19:49:28 [INFO]\t[TRAIN] Epoch=12/32, Step=60/90, loss=0.001473, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:39:50\n",
      "2021-07-29 19:49:30 [INFO]\t[TRAIN] Epoch=12/32, Step=62/90, loss=0.006605, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:39:47\n",
      "2021-07-29 19:49:32 [INFO]\t[TRAIN] Epoch=12/32, Step=64/90, loss=0.076878, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:39:45\n",
      "2021-07-29 19:49:34 [INFO]\t[TRAIN] Epoch=12/32, Step=66/90, loss=0.009331, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:39:43\n",
      "2021-07-29 19:49:36 [INFO]\t[TRAIN] Epoch=12/32, Step=68/90, loss=0.003065, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:39:41\n",
      "2021-07-29 19:49:38 [INFO]\t[TRAIN] Epoch=12/32, Step=70/90, loss=0.235807, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:39:39\n",
      "2021-07-29 19:49:40 [INFO]\t[TRAIN] Epoch=12/32, Step=72/90, loss=0.004096, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:39:37\n",
      "2021-07-29 19:49:42 [INFO]\t[TRAIN] Epoch=12/32, Step=74/90, loss=0.027553, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.0s, eta=0:39:35\n",
      "2021-07-29 19:49:44 [INFO]\t[TRAIN] Epoch=12/32, Step=76/90, loss=0.004134, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:39:33\n",
      "2021-07-29 19:49:46 [INFO]\t[TRAIN] Epoch=12/32, Step=78/90, loss=0.018748, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.98s, eta=0:39:31\n",
      "2021-07-29 19:49:48 [INFO]\t[TRAIN] Epoch=12/32, Step=80/90, loss=0.597471, acc1=0.75, acc2=1.0, lr=2.5e-05, time_each_step=0.98s, eta=0:39:29\n",
      "2021-07-29 19:49:50 [INFO]\t[TRAIN] Epoch=12/32, Step=82/90, loss=0.007539, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.98s, eta=0:39:27\n",
      "2021-07-29 19:49:52 [INFO]\t[TRAIN] Epoch=12/32, Step=84/90, loss=0.000654, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.97s, eta=0:39:25\n",
      "2021-07-29 19:49:54 [INFO]\t[TRAIN] Epoch=12/32, Step=86/90, loss=0.001889, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.98s, eta=0:39:23\n",
      "2021-07-29 19:49:55 [INFO]\t[TRAIN] Epoch=12/32, Step=88/90, loss=0.000397, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.97s, eta=0:39:21\n",
      "2021-07-29 19:49:57 [INFO]\t[TRAIN] Epoch=12/32, Step=90/90, loss=0.056272, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.94s, eta=0:39:19\n",
      "2021-07-29 19:49:57 [INFO]\t[TRAIN] Epoch 12 finished, loss=0.053578, acc1=0.986111, acc2=1.0, lr=2.5e-05 .\n",
      "2021-07-29 19:49:57 [INFO]\tStart to evaluating(total_samples=80, total_steps=10)...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 10/10 [00:17<00:00,  1.73s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2021-07-29 19:50:14 [INFO]\t[EVAL] Finished, Epoch=12, acc1=0.975, acc2=1.0 .\n",
      "2021-07-29 19:50:14 [INFO]\tModel saved in output/mobilenetv3_small_ssld/epoch_12.\n",
      "2021-07-29 19:50:14 [INFO]\tCurrent evaluated best model in eval_dataset is epoch_5, acc1=0.9875\n",
      "2021-07-29 19:50:23 [INFO]\t[TRAIN] Epoch=13/32, Step=2/90, loss=0.047014, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.25s, eta=0:39:11\n",
      "2021-07-29 19:50:25 [INFO]\t[TRAIN] Epoch=13/32, Step=4/90, loss=0.002679, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.27s, eta=0:39:10\n",
      "2021-07-29 19:50:27 [INFO]\t[TRAIN] Epoch=13/32, Step=6/90, loss=0.001216, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.29s, eta=0:39:9\n",
      "2021-07-29 19:50:29 [INFO]\t[TRAIN] Epoch=13/32, Step=8/90, loss=0.02044, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.3s, eta=0:39:7\n",
      "2021-07-29 19:50:32 [INFO]\t[TRAIN] Epoch=13/32, Step=10/90, loss=0.024704, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.31s, eta=0:39:6\n",
      "2021-07-29 19:50:34 [INFO]\t[TRAIN] Epoch=13/32, Step=12/90, loss=0.062777, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.32s, eta=0:39:3\n",
      "2021-07-29 19:50:36 [INFO]\t[TRAIN] Epoch=13/32, Step=14/90, loss=0.006484, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.32s, eta=0:39:1\n",
      "2021-07-29 19:50:38 [INFO]\t[TRAIN] Epoch=13/32, Step=16/90, loss=0.718667, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.32s, eta=0:38:58\n",
      "2021-07-29 19:50:40 [INFO]\t[TRAIN] Epoch=13/32, Step=18/90, loss=0.014805, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.34s, eta=0:38:57\n",
      "2021-07-29 19:50:42 [INFO]\t[TRAIN] Epoch=13/32, Step=20/90, loss=0.007252, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.37s, eta=0:38:57\n",
      "2021-07-29 19:50:44 [INFO]\t[TRAIN] Epoch=13/32, Step=22/90, loss=0.00171, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:38:33\n",
      "2021-07-29 19:50:46 [INFO]\t[TRAIN] Epoch=13/32, Step=24/90, loss=0.009935, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:38:29\n",
      "2021-07-29 19:50:48 [INFO]\t[TRAIN] Epoch=13/32, Step=26/90, loss=0.214589, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:38:27\n",
      "2021-07-29 19:50:50 [INFO]\t[TRAIN] Epoch=13/32, Step=28/90, loss=0.003019, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:38:24\n",
      "2021-07-29 19:50:52 [INFO]\t[TRAIN] Epoch=13/32, Step=30/90, loss=0.006736, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.0s, eta=0:38:21\n",
      "2021-07-29 19:50:54 [INFO]\t[TRAIN] Epoch=13/32, Step=32/90, loss=0.024838, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:38:19\n",
      "2021-07-29 19:50:56 [INFO]\t[TRAIN] Epoch=13/32, Step=34/90, loss=0.004891, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.0s, eta=0:38:16\n",
      "2021-07-29 19:50:58 [INFO]\t[TRAIN] Epoch=13/32, Step=36/90, loss=0.309813, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:38:14\n",
      "2021-07-29 19:51:00 [INFO]\t[TRAIN] Epoch=13/32, Step=38/90, loss=0.001298, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.0s, eta=0:38:12\n",
      "2021-07-29 19:51:02 [INFO]\t[TRAIN] Epoch=13/32, Step=40/90, loss=0.004049, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:38:10\n",
      "2021-07-29 19:51:04 [INFO]\t[TRAIN] Epoch=13/32, Step=42/90, loss=0.023348, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:38:8\n",
      "2021-07-29 19:51:06 [INFO]\t[TRAIN] Epoch=13/32, Step=44/90, loss=0.003564, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.98s, eta=0:38:6\n",
      "2021-07-29 19:51:07 [INFO]\t[TRAIN] Epoch=13/32, Step=46/90, loss=0.017936, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.97s, eta=0:38:3\n",
      "2021-07-29 19:51:10 [INFO]\t[TRAIN] Epoch=13/32, Step=48/90, loss=0.275116, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:38:2\n",
      "2021-07-29 19:51:11 [INFO]\t[TRAIN] Epoch=13/32, Step=50/90, loss=0.003308, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:38:0\n",
      "2021-07-29 19:51:14 [INFO]\t[TRAIN] Epoch=13/32, Step=52/90, loss=0.006346, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.98s, eta=0:37:58\n",
      "2021-07-29 19:51:16 [INFO]\t[TRAIN] Epoch=13/32, Step=54/90, loss=0.003985, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:37:56\n",
      "2021-07-29 19:51:17 [INFO]\t[TRAIN] Epoch=13/32, Step=56/90, loss=0.003436, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.98s, eta=0:37:54\n",
      "2021-07-29 19:51:20 [INFO]\t[TRAIN] Epoch=13/32, Step=58/90, loss=0.292433, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:37:52\n",
      "2021-07-29 19:51:22 [INFO]\t[TRAIN] Epoch=13/32, Step=60/90, loss=0.000383, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:37:50\n",
      "2021-07-29 19:51:23 [INFO]\t[TRAIN] Epoch=13/32, Step=62/90, loss=0.004294, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.0s, eta=0:37:48\n",
      "2021-07-29 19:51:25 [INFO]\t[TRAIN] Epoch=13/32, Step=64/90, loss=0.05266, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:37:46\n",
      "2021-07-29 19:51:27 [INFO]\t[TRAIN] Epoch=13/32, Step=66/90, loss=0.091889, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.0s, eta=0:37:44\n",
      "2021-07-29 19:51:29 [INFO]\t[TRAIN] Epoch=13/32, Step=68/90, loss=0.549589, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:37:42\n",
      "2021-07-29 19:51:31 [INFO]\t[TRAIN] Epoch=13/32, Step=70/90, loss=0.020641, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:37:40\n",
      "2021-07-29 19:51:33 [INFO]\t[TRAIN] Epoch=13/32, Step=72/90, loss=0.00562, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:37:38\n",
      "2021-07-29 19:51:36 [INFO]\t[TRAIN] Epoch=13/32, Step=74/90, loss=0.018728, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:37:37\n",
      "2021-07-29 19:51:38 [INFO]\t[TRAIN] Epoch=13/32, Step=76/90, loss=0.026619, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:37:35\n",
      "2021-07-29 19:51:40 [INFO]\t[TRAIN] Epoch=13/32, Step=78/90, loss=0.035148, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:37:33\n",
      "2021-07-29 19:51:42 [INFO]\t[TRAIN] Epoch=13/32, Step=80/90, loss=0.214015, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:37:31\n",
      "2021-07-29 19:51:44 [INFO]\t[TRAIN] Epoch=13/32, Step=82/90, loss=0.003087, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:37:29\n",
      "2021-07-29 19:51:46 [INFO]\t[TRAIN] Epoch=13/32, Step=84/90, loss=0.141917, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:37:27\n",
      "2021-07-29 19:51:48 [INFO]\t[TRAIN] Epoch=13/32, Step=86/90, loss=0.006525, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:37:25\n",
      "2021-07-29 19:51:50 [INFO]\t[TRAIN] Epoch=13/32, Step=88/90, loss=0.037393, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:37:23\n",
      "2021-07-29 19:51:51 [INFO]\t[TRAIN] Epoch=13/32, Step=90/90, loss=0.002469, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.0s, eta=0:37:20\n",
      "2021-07-29 19:51:51 [INFO]\t[TRAIN] Epoch 13 finished, loss=0.050381, acc1=0.984722, acc2=1.0, lr=2.5e-05 .\n",
      "2021-07-29 19:51:51 [INFO]\tStart to evaluating(total_samples=80, total_steps=10)...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 10/10 [00:18<00:00,  1.80s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2021-07-29 19:52:09 [INFO]\t[EVAL] Finished, Epoch=13, acc1=0.9875, acc2=1.0 .\n",
      "2021-07-29 19:52:10 [INFO]\tModel saved in output/mobilenetv3_small_ssld/epoch_13.\n",
      "2021-07-29 19:52:10 [INFO]\tCurrent evaluated best model in eval_dataset is epoch_5, acc1=0.9875\n",
      "2021-07-29 19:52:16 [INFO]\t[TRAIN] Epoch=14/32, Step=2/90, loss=0.01849, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.23s, eta=0:36:40\n",
      "2021-07-29 19:52:19 [INFO]\t[TRAIN] Epoch=14/32, Step=4/90, loss=0.028981, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.23s, eta=0:36:38\n",
      "2021-07-29 19:52:21 [INFO]\t[TRAIN] Epoch=14/32, Step=6/90, loss=0.000544, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.22s, eta=0:36:35\n",
      "2021-07-29 19:52:23 [INFO]\t[TRAIN] Epoch=14/32, Step=8/90, loss=0.016831, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.21s, eta=0:36:31\n",
      "2021-07-29 19:52:25 [INFO]\t[TRAIN] Epoch=14/32, Step=10/90, loss=0.007819, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.22s, eta=0:36:29\n",
      "2021-07-29 19:52:27 [INFO]\t[TRAIN] Epoch=14/32, Step=12/90, loss=0.001009, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.23s, eta=0:36:28\n",
      "2021-07-29 19:52:29 [INFO]\t[TRAIN] Epoch=14/32, Step=14/90, loss=0.006611, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.23s, eta=0:36:25\n",
      "2021-07-29 19:52:31 [INFO]\t[TRAIN] Epoch=14/32, Step=16/90, loss=0.028967, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.23s, eta=0:36:23\n",
      "2021-07-29 19:52:33 [INFO]\t[TRAIN] Epoch=14/32, Step=18/90, loss=0.001126, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.23s, eta=0:36:21\n",
      "2021-07-29 19:52:35 [INFO]\t[TRAIN] Epoch=14/32, Step=20/90, loss=0.015635, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.27s, eta=0:36:21\n",
      "2021-07-29 19:52:37 [INFO]\t[TRAIN] Epoch=14/32, Step=22/90, loss=0.021958, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:36:3\n",
      "2021-07-29 19:52:39 [INFO]\t[TRAIN] Epoch=14/32, Step=24/90, loss=0.153747, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:35:59\n",
      "2021-07-29 19:52:41 [INFO]\t[TRAIN] Epoch=14/32, Step=26/90, loss=0.003042, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:35:57\n",
      "2021-07-29 19:52:43 [INFO]\t[TRAIN] Epoch=14/32, Step=28/90, loss=0.013843, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:35:56\n",
      "2021-07-29 19:52:45 [INFO]\t[TRAIN] Epoch=14/32, Step=30/90, loss=0.002747, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:35:54\n",
      "2021-07-29 19:52:47 [INFO]\t[TRAIN] Epoch=14/32, Step=32/90, loss=1.174145, acc1=0.375, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:35:51\n",
      "2021-07-29 19:52:49 [INFO]\t[TRAIN] Epoch=14/32, Step=34/90, loss=0.00079, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:35:49\n",
      "2021-07-29 19:52:51 [INFO]\t[TRAIN] Epoch=14/32, Step=36/90, loss=0.04236, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:35:47\n",
      "2021-07-29 19:52:53 [INFO]\t[TRAIN] Epoch=14/32, Step=38/90, loss=0.003918, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:35:45\n",
      "2021-07-29 19:52:55 [INFO]\t[TRAIN] Epoch=14/32, Step=40/90, loss=0.025242, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:35:43\n",
      "2021-07-29 19:52:58 [INFO]\t[TRAIN] Epoch=14/32, Step=42/90, loss=0.005199, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:35:41\n",
      "2021-07-29 19:53:00 [INFO]\t[TRAIN] Epoch=14/32, Step=44/90, loss=0.014524, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:35:40\n",
      "2021-07-29 19:53:02 [INFO]\t[TRAIN] Epoch=14/32, Step=46/90, loss=0.237783, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:35:37\n",
      "2021-07-29 19:53:04 [INFO]\t[TRAIN] Epoch=14/32, Step=48/90, loss=0.007286, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:35:35\n",
      "2021-07-29 19:53:06 [INFO]\t[TRAIN] Epoch=14/32, Step=50/90, loss=0.006218, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:35:33\n",
      "2021-07-29 19:53:08 [INFO]\t[TRAIN] Epoch=14/32, Step=52/90, loss=0.117207, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:35:31\n",
      "2021-07-29 19:53:10 [INFO]\t[TRAIN] Epoch=14/32, Step=54/90, loss=0.004746, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:35:29\n",
      "2021-07-29 19:53:12 [INFO]\t[TRAIN] Epoch=14/32, Step=56/90, loss=0.020384, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:35:27\n",
      "2021-07-29 19:53:14 [INFO]\t[TRAIN] Epoch=14/32, Step=58/90, loss=0.006909, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:35:25\n",
      "2021-07-29 19:53:16 [INFO]\t[TRAIN] Epoch=14/32, Step=60/90, loss=0.00164, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:35:23\n",
      "2021-07-29 19:53:18 [INFO]\t[TRAIN] Epoch=14/32, Step=62/90, loss=0.00993, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:35:21\n",
      "2021-07-29 19:53:20 [INFO]\t[TRAIN] Epoch=14/32, Step=64/90, loss=0.023354, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.0s, eta=0:35:18\n",
      "2021-07-29 19:53:22 [INFO]\t[TRAIN] Epoch=14/32, Step=66/90, loss=0.010163, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:35:16\n",
      "2021-07-29 19:53:25 [INFO]\t[TRAIN] Epoch=14/32, Step=68/90, loss=0.007221, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:35:15\n",
      "2021-07-29 19:53:27 [INFO]\t[TRAIN] Epoch=14/32, Step=70/90, loss=0.183952, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:35:13\n",
      "2021-07-29 19:53:29 [INFO]\t[TRAIN] Epoch=14/32, Step=72/90, loss=0.203187, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:35:11\n",
      "2021-07-29 19:53:31 [INFO]\t[TRAIN] Epoch=14/32, Step=74/90, loss=0.009467, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:35:9\n",
      "2021-07-29 19:53:33 [INFO]\t[TRAIN] Epoch=14/32, Step=76/90, loss=0.030562, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:35:7\n",
      "2021-07-29 19:53:35 [INFO]\t[TRAIN] Epoch=14/32, Step=78/90, loss=0.158383, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:35:5\n",
      "2021-07-29 19:53:37 [INFO]\t[TRAIN] Epoch=14/32, Step=80/90, loss=0.001888, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:35:3\n",
      "2021-07-29 19:53:39 [INFO]\t[TRAIN] Epoch=14/32, Step=82/90, loss=0.012522, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:35:1\n",
      "2021-07-29 19:53:42 [INFO]\t[TRAIN] Epoch=14/32, Step=84/90, loss=0.004889, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:34:59\n",
      "2021-07-29 19:53:44 [INFO]\t[TRAIN] Epoch=14/32, Step=86/90, loss=0.003271, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:34:56\n",
      "2021-07-29 19:53:46 [INFO]\t[TRAIN] Epoch=14/32, Step=88/90, loss=0.012522, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:34:54\n",
      "2021-07-29 19:53:47 [INFO]\t[TRAIN] Epoch=14/32, Step=90/90, loss=0.010236, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:34:52\n",
      "2021-07-29 19:53:47 [INFO]\t[TRAIN] Epoch 14 finished, loss=0.04466, acc1=0.980556, acc2=1.0, lr=2.5e-05 .\n",
      "2021-07-29 19:53:47 [INFO]\tStart to evaluating(total_samples=80, total_steps=10)...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 10/10 [00:22<00:00,  2.29s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2021-07-29 19:54:10 [INFO]\t[EVAL] Finished, Epoch=14, acc1=0.9875, acc2=1.0 .\n",
      "2021-07-29 19:54:10 [INFO]\tModel saved in output/mobilenetv3_small_ssld/epoch_14.\n",
      "2021-07-29 19:54:10 [INFO]\tCurrent evaluated best model in eval_dataset is epoch_5, acc1=0.9875\n",
      "2021-07-29 19:54:18 [INFO]\t[TRAIN] Epoch=15/32, Step=2/90, loss=0.00845, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.29s, eta=0:36:30\n",
      "2021-07-29 19:54:20 [INFO]\t[TRAIN] Epoch=15/32, Step=4/90, loss=0.356743, acc1=0.75, acc2=1.0, lr=2.5e-05, time_each_step=1.3s, eta=0:36:28\n",
      "2021-07-29 19:54:22 [INFO]\t[TRAIN] Epoch=15/32, Step=6/90, loss=0.010771, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.31s, eta=0:36:26\n",
      "2021-07-29 19:54:24 [INFO]\t[TRAIN] Epoch=15/32, Step=8/90, loss=0.038672, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.31s, eta=0:36:23\n",
      "2021-07-29 19:54:26 [INFO]\t[TRAIN] Epoch=15/32, Step=10/90, loss=0.02739, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.3s, eta=0:36:20\n",
      "2021-07-29 19:54:29 [INFO]\t[TRAIN] Epoch=15/32, Step=12/90, loss=0.004115, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.3s, eta=0:36:17\n",
      "2021-07-29 19:54:31 [INFO]\t[TRAIN] Epoch=15/32, Step=14/90, loss=0.010121, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.29s, eta=0:36:14\n",
      "2021-07-29 19:54:33 [INFO]\t[TRAIN] Epoch=15/32, Step=16/90, loss=0.005639, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.29s, eta=0:36:12\n",
      "2021-07-29 19:54:35 [INFO]\t[TRAIN] Epoch=15/32, Step=18/90, loss=0.004826, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.3s, eta=0:36:10\n",
      "2021-07-29 19:54:37 [INFO]\t[TRAIN] Epoch=15/32, Step=20/90, loss=0.051299, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.31s, eta=0:36:8\n",
      "2021-07-29 19:54:39 [INFO]\t[TRAIN] Epoch=15/32, Step=22/90, loss=0.00037, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:35:47\n",
      "2021-07-29 19:54:41 [INFO]\t[TRAIN] Epoch=15/32, Step=24/90, loss=0.012428, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:35:44\n",
      "2021-07-29 19:54:43 [INFO]\t[TRAIN] Epoch=15/32, Step=26/90, loss=0.003174, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:35:41\n",
      "2021-07-29 19:54:45 [INFO]\t[TRAIN] Epoch=15/32, Step=28/90, loss=0.000817, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:35:39\n",
      "2021-07-29 19:54:47 [INFO]\t[TRAIN] Epoch=15/32, Step=30/90, loss=0.044734, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:35:37\n",
      "2021-07-29 19:54:49 [INFO]\t[TRAIN] Epoch=15/32, Step=32/90, loss=0.003269, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:35:35\n",
      "2021-07-29 19:54:51 [INFO]\t[TRAIN] Epoch=15/32, Step=34/90, loss=0.111066, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:35:33\n",
      "2021-07-29 19:54:53 [INFO]\t[TRAIN] Epoch=15/32, Step=36/90, loss=0.030409, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:35:31\n",
      "2021-07-29 19:54:55 [INFO]\t[TRAIN] Epoch=15/32, Step=38/90, loss=0.007966, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:35:29\n",
      "2021-07-29 19:54:57 [INFO]\t[TRAIN] Epoch=15/32, Step=40/90, loss=0.000881, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:35:28\n",
      "2021-07-29 19:54:59 [INFO]\t[TRAIN] Epoch=15/32, Step=42/90, loss=0.096837, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:35:26\n",
      "2021-07-29 19:55:01 [INFO]\t[TRAIN] Epoch=15/32, Step=44/90, loss=0.006524, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:35:24\n",
      "2021-07-29 19:55:03 [INFO]\t[TRAIN] Epoch=15/32, Step=46/90, loss=0.001362, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:35:22\n",
      "2021-07-29 19:55:05 [INFO]\t[TRAIN] Epoch=15/32, Step=48/90, loss=0.001109, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:35:20\n",
      "2021-07-29 19:55:07 [INFO]\t[TRAIN] Epoch=15/32, Step=50/90, loss=0.008565, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:35:17\n",
      "2021-07-29 19:55:09 [INFO]\t[TRAIN] Epoch=15/32, Step=52/90, loss=0.002165, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:35:15\n",
      "2021-07-29 19:55:11 [INFO]\t[TRAIN] Epoch=15/32, Step=54/90, loss=0.013549, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:35:13\n",
      "2021-07-29 19:55:13 [INFO]\t[TRAIN] Epoch=15/32, Step=56/90, loss=0.011414, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:35:11\n",
      "2021-07-29 19:55:15 [INFO]\t[TRAIN] Epoch=15/32, Step=58/90, loss=0.009204, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:35:9\n",
      "2021-07-29 19:55:18 [INFO]\t[TRAIN] Epoch=15/32, Step=60/90, loss=0.559803, acc1=0.75, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:35:7\n",
      "2021-07-29 19:55:20 [INFO]\t[TRAIN] Epoch=15/32, Step=62/90, loss=0.002062, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:35:5\n",
      "2021-07-29 19:55:22 [INFO]\t[TRAIN] Epoch=15/32, Step=64/90, loss=0.040386, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:35:3\n",
      "2021-07-29 19:55:24 [INFO]\t[TRAIN] Epoch=15/32, Step=66/90, loss=0.02511, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:35:1\n",
      "2021-07-29 19:55:26 [INFO]\t[TRAIN] Epoch=15/32, Step=68/90, loss=0.043212, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:34:59\n",
      "2021-07-29 19:55:28 [INFO]\t[TRAIN] Epoch=15/32, Step=70/90, loss=0.024476, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:34:57\n",
      "2021-07-29 19:55:30 [INFO]\t[TRAIN] Epoch=15/32, Step=72/90, loss=0.000572, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:34:55\n",
      "2021-07-29 19:55:32 [INFO]\t[TRAIN] Epoch=15/32, Step=74/90, loss=0.032636, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:34:53\n",
      "2021-07-29 19:55:34 [INFO]\t[TRAIN] Epoch=15/32, Step=76/90, loss=0.037335, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:34:51\n",
      "2021-07-29 19:55:37 [INFO]\t[TRAIN] Epoch=15/32, Step=78/90, loss=0.063897, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:34:49\n",
      "2021-07-29 19:55:39 [INFO]\t[TRAIN] Epoch=15/32, Step=80/90, loss=0.000992, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:34:47\n",
      "2021-07-29 19:55:41 [INFO]\t[TRAIN] Epoch=15/32, Step=82/90, loss=0.003082, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:34:44\n",
      "2021-07-29 19:55:42 [INFO]\t[TRAIN] Epoch=15/32, Step=84/90, loss=0.054364, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:34:42\n",
      "2021-07-29 19:55:45 [INFO]\t[TRAIN] Epoch=15/32, Step=86/90, loss=0.015288, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:34:40\n",
      "2021-07-29 19:55:46 [INFO]\t[TRAIN] Epoch=15/32, Step=88/90, loss=0.019595, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:34:38\n",
      "2021-07-29 19:55:48 [INFO]\t[TRAIN] Epoch=15/32, Step=90/90, loss=0.000465, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.97s, eta=0:34:36\n",
      "2021-07-29 19:55:48 [INFO]\t[TRAIN] Epoch 15 finished, loss=0.047408, acc1=0.986111, acc2=1.0, lr=2.5e-05 .\n",
      "2021-07-29 19:55:48 [INFO]\tStart to evaluating(total_samples=80, total_steps=10)...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 10/10 [00:20<00:00,  2.01s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2021-07-29 19:56:08 [INFO]\t[EVAL] Finished, Epoch=15, acc1=0.975, acc2=1.0 .\n",
      "2021-07-29 19:56:08 [INFO]\tModel saved in output/mobilenetv3_small_ssld/epoch_15.\n",
      "2021-07-29 19:56:08 [INFO]\tCurrent evaluated best model in eval_dataset is epoch_5, acc1=0.9875\n",
      "2021-07-29 19:56:16 [INFO]\t[TRAIN] Epoch=16/32, Step=2/90, loss=0.122226, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.24s, eta=0:33:35\n",
      "2021-07-29 19:56:18 [INFO]\t[TRAIN] Epoch=16/32, Step=4/90, loss=0.037399, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.26s, eta=0:33:34\n",
      "2021-07-29 19:56:20 [INFO]\t[TRAIN] Epoch=16/32, Step=6/90, loss=0.00175, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.27s, eta=0:33:33\n",
      "2021-07-29 19:56:22 [INFO]\t[TRAIN] Epoch=16/32, Step=8/90, loss=0.039041, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.27s, eta=0:33:30\n",
      "2021-07-29 19:56:24 [INFO]\t[TRAIN] Epoch=16/32, Step=10/90, loss=0.001751, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.27s, eta=0:33:28\n",
      "2021-07-29 19:56:27 [INFO]\t[TRAIN] Epoch=16/32, Step=12/90, loss=0.010338, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.31s, eta=0:33:28\n",
      "2021-07-29 19:56:29 [INFO]\t[TRAIN] Epoch=16/32, Step=14/90, loss=0.038471, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.33s, eta=0:33:27\n",
      "2021-07-29 19:56:32 [INFO]\t[TRAIN] Epoch=16/32, Step=16/90, loss=0.101014, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.33s, eta=0:33:25\n",
      "2021-07-29 19:56:34 [INFO]\t[TRAIN] Epoch=16/32, Step=18/90, loss=0.162975, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.35s, eta=0:33:23\n",
      "2021-07-29 19:56:36 [INFO]\t[TRAIN] Epoch=16/32, Step=20/90, loss=0.013226, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.38s, eta=0:33:23\n",
      "2021-07-29 19:56:38 [INFO]\t[TRAIN] Epoch=16/32, Step=22/90, loss=0.008167, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.11s, eta=0:33:2\n",
      "2021-07-29 19:56:40 [INFO]\t[TRAIN] Epoch=16/32, Step=24/90, loss=0.002794, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.11s, eta=0:32:59\n",
      "2021-07-29 19:56:42 [INFO]\t[TRAIN] Epoch=16/32, Step=26/90, loss=0.019246, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:32:56\n",
      "2021-07-29 19:56:44 [INFO]\t[TRAIN] Epoch=16/32, Step=28/90, loss=0.005027, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:32:54\n",
      "2021-07-29 19:56:46 [INFO]\t[TRAIN] Epoch=16/32, Step=30/90, loss=0.003769, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:32:52\n",
      "2021-07-29 19:56:48 [INFO]\t[TRAIN] Epoch=16/32, Step=32/90, loss=0.002293, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:32:48\n",
      "2021-07-29 19:56:50 [INFO]\t[TRAIN] Epoch=16/32, Step=34/90, loss=0.002671, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:32:45\n",
      "2021-07-29 19:56:52 [INFO]\t[TRAIN] Epoch=16/32, Step=36/90, loss=0.127786, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:32:42\n",
      "2021-07-29 19:56:54 [INFO]\t[TRAIN] Epoch=16/32, Step=38/90, loss=0.03292, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:32:40\n",
      "2021-07-29 19:56:56 [INFO]\t[TRAIN] Epoch=16/32, Step=40/90, loss=0.016726, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:32:37\n",
      "2021-07-29 19:56:58 [INFO]\t[TRAIN] Epoch=16/32, Step=42/90, loss=0.006193, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:32:35\n",
      "2021-07-29 19:57:00 [INFO]\t[TRAIN] Epoch=16/32, Step=44/90, loss=0.028354, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:32:33\n",
      "2021-07-29 19:57:02 [INFO]\t[TRAIN] Epoch=16/32, Step=46/90, loss=0.014659, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:32:31\n",
      "2021-07-29 19:57:04 [INFO]\t[TRAIN] Epoch=16/32, Step=48/90, loss=0.001521, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:32:29\n",
      "2021-07-29 19:57:06 [INFO]\t[TRAIN] Epoch=16/32, Step=50/90, loss=0.004901, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:32:27\n",
      "2021-07-29 19:57:09 [INFO]\t[TRAIN] Epoch=16/32, Step=52/90, loss=0.002059, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:32:25\n",
      "2021-07-29 19:57:11 [INFO]\t[TRAIN] Epoch=16/32, Step=54/90, loss=0.020686, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:32:23\n",
      "2021-07-29 19:57:13 [INFO]\t[TRAIN] Epoch=16/32, Step=56/90, loss=0.000855, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:32:21\n",
      "2021-07-29 19:57:15 [INFO]\t[TRAIN] Epoch=16/32, Step=58/90, loss=0.102565, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:32:19\n",
      "2021-07-29 19:57:17 [INFO]\t[TRAIN] Epoch=16/32, Step=60/90, loss=0.016609, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:32:18\n",
      "2021-07-29 19:57:19 [INFO]\t[TRAIN] Epoch=16/32, Step=62/90, loss=0.00553, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:32:16\n",
      "2021-07-29 19:57:21 [INFO]\t[TRAIN] Epoch=16/32, Step=64/90, loss=0.038517, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:32:14\n",
      "2021-07-29 19:57:23 [INFO]\t[TRAIN] Epoch=16/32, Step=66/90, loss=0.142068, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:32:12\n",
      "2021-07-29 19:57:25 [INFO]\t[TRAIN] Epoch=16/32, Step=68/90, loss=0.010344, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:32:10\n",
      "2021-07-29 19:57:28 [INFO]\t[TRAIN] Epoch=16/32, Step=70/90, loss=0.002365, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:32:8\n",
      "2021-07-29 19:57:30 [INFO]\t[TRAIN] Epoch=16/32, Step=72/90, loss=0.001115, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:32:5\n",
      "2021-07-29 19:57:31 [INFO]\t[TRAIN] Epoch=16/32, Step=74/90, loss=0.027446, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:32:3\n",
      "2021-07-29 19:57:34 [INFO]\t[TRAIN] Epoch=16/32, Step=76/90, loss=0.485365, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:32:1\n",
      "2021-07-29 19:57:36 [INFO]\t[TRAIN] Epoch=16/32, Step=78/90, loss=0.00287, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:31:59\n",
      "2021-07-29 19:57:38 [INFO]\t[TRAIN] Epoch=16/32, Step=80/90, loss=0.00447, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:31:57\n",
      "2021-07-29 19:57:40 [INFO]\t[TRAIN] Epoch=16/32, Step=82/90, loss=0.302052, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:31:55\n",
      "2021-07-29 19:57:42 [INFO]\t[TRAIN] Epoch=16/32, Step=84/90, loss=0.389388, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:31:53\n",
      "2021-07-29 19:57:44 [INFO]\t[TRAIN] Epoch=16/32, Step=86/90, loss=0.000868, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:31:51\n",
      "2021-07-29 19:57:46 [INFO]\t[TRAIN] Epoch=16/32, Step=88/90, loss=0.101075, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:31:49\n",
      "2021-07-29 19:57:48 [INFO]\t[TRAIN] Epoch=16/32, Step=90/90, loss=0.064983, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:31:46\n",
      "2021-07-29 19:57:48 [INFO]\t[TRAIN] Epoch 16 finished, loss=0.045529, acc1=0.984722, acc2=1.0, lr=2.5e-05 .\n",
      "2021-07-29 19:57:48 [INFO]\tStart to evaluating(total_samples=80, total_steps=10)...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 10/10 [00:18<00:00,  1.80s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2021-07-29 19:58:06 [INFO]\t[EVAL] Finished, Epoch=16, acc1=0.9875, acc2=1.0 .\n",
      "2021-07-29 19:58:07 [INFO]\tModel saved in output/mobilenetv3_small_ssld/epoch_16.\n",
      "2021-07-29 19:58:07 [INFO]\tCurrent evaluated best model in eval_dataset is epoch_5, acc1=0.9875\n",
      "2021-07-29 19:58:14 [INFO]\t[TRAIN] Epoch=17/32, Step=2/90, loss=0.047206, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.28s, eta=0:31:47\n",
      "2021-07-29 19:58:16 [INFO]\t[TRAIN] Epoch=17/32, Step=4/90, loss=0.003515, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.3s, eta=0:31:46\n",
      "2021-07-29 19:58:19 [INFO]\t[TRAIN] Epoch=17/32, Step=6/90, loss=0.334651, acc1=0.75, acc2=1.0, lr=2.5e-05, time_each_step=1.3s, eta=0:31:44\n",
      "2021-07-29 19:58:21 [INFO]\t[TRAIN] Epoch=17/32, Step=8/90, loss=0.010926, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.3s, eta=0:31:41\n",
      "2021-07-29 19:58:23 [INFO]\t[TRAIN] Epoch=17/32, Step=10/90, loss=0.011537, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.29s, eta=0:31:38\n",
      "2021-07-29 19:58:25 [INFO]\t[TRAIN] Epoch=17/32, Step=12/90, loss=0.016167, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.29s, eta=0:31:35\n",
      "2021-07-29 19:58:27 [INFO]\t[TRAIN] Epoch=17/32, Step=14/90, loss=0.022654, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.3s, eta=0:31:33\n",
      "2021-07-29 19:58:29 [INFO]\t[TRAIN] Epoch=17/32, Step=16/90, loss=0.145932, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.29s, eta=0:31:30\n",
      "2021-07-29 19:58:31 [INFO]\t[TRAIN] Epoch=17/32, Step=18/90, loss=0.056633, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.3s, eta=0:31:28\n",
      "2021-07-29 19:58:33 [INFO]\t[TRAIN] Epoch=17/32, Step=20/90, loss=0.027737, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.33s, eta=0:31:27\n",
      "2021-07-29 19:58:36 [INFO]\t[TRAIN] Epoch=17/32, Step=22/90, loss=0.00459, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:31:7\n",
      "2021-07-29 19:58:38 [INFO]\t[TRAIN] Epoch=17/32, Step=24/90, loss=0.001707, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:31:5\n",
      "2021-07-29 19:58:40 [INFO]\t[TRAIN] Epoch=17/32, Step=26/90, loss=0.015628, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:31:2\n",
      "2021-07-29 19:58:42 [INFO]\t[TRAIN] Epoch=17/32, Step=28/90, loss=0.017825, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:31:1\n",
      "2021-07-29 19:58:44 [INFO]\t[TRAIN] Epoch=17/32, Step=30/90, loss=0.043751, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:30:59\n",
      "2021-07-29 19:58:46 [INFO]\t[TRAIN] Epoch=17/32, Step=32/90, loss=0.002433, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:30:57\n",
      "2021-07-29 19:58:48 [INFO]\t[TRAIN] Epoch=17/32, Step=34/90, loss=0.009289, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:30:55\n",
      "2021-07-29 19:58:51 [INFO]\t[TRAIN] Epoch=17/32, Step=36/90, loss=0.000956, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:30:53\n",
      "2021-07-29 19:58:53 [INFO]\t[TRAIN] Epoch=17/32, Step=38/90, loss=0.16773, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:30:51\n",
      "2021-07-29 19:58:55 [INFO]\t[TRAIN] Epoch=17/32, Step=40/90, loss=0.003388, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:30:49\n",
      "2021-07-29 19:58:57 [INFO]\t[TRAIN] Epoch=17/32, Step=42/90, loss=0.04608, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:30:47\n",
      "2021-07-29 19:59:00 [INFO]\t[TRAIN] Epoch=17/32, Step=44/90, loss=0.002341, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:30:44\n",
      "2021-07-29 19:59:02 [INFO]\t[TRAIN] Epoch=17/32, Step=46/90, loss=0.019658, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:30:42\n",
      "2021-07-29 19:59:04 [INFO]\t[TRAIN] Epoch=17/32, Step=48/90, loss=0.008818, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:30:40\n",
      "2021-07-29 19:59:06 [INFO]\t[TRAIN] Epoch=17/32, Step=50/90, loss=0.072545, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:30:38\n",
      "2021-07-29 19:59:08 [INFO]\t[TRAIN] Epoch=17/32, Step=52/90, loss=0.108241, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:30:35\n",
      "2021-07-29 19:59:10 [INFO]\t[TRAIN] Epoch=17/32, Step=54/90, loss=0.031369, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:30:33\n",
      "2021-07-29 19:59:12 [INFO]\t[TRAIN] Epoch=17/32, Step=56/90, loss=0.005462, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:30:31\n",
      "2021-07-29 19:59:14 [INFO]\t[TRAIN] Epoch=17/32, Step=58/90, loss=0.142845, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:30:28\n",
      "2021-07-29 19:59:17 [INFO]\t[TRAIN] Epoch=17/32, Step=60/90, loss=0.003932, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:30:26\n",
      "2021-07-29 19:59:19 [INFO]\t[TRAIN] Epoch=17/32, Step=62/90, loss=0.013339, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:30:24\n",
      "2021-07-29 19:59:21 [INFO]\t[TRAIN] Epoch=17/32, Step=64/90, loss=0.075432, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:30:22\n",
      "2021-07-29 19:59:23 [INFO]\t[TRAIN] Epoch=17/32, Step=66/90, loss=0.084697, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:30:20\n",
      "2021-07-29 19:59:25 [INFO]\t[TRAIN] Epoch=17/32, Step=68/90, loss=0.001979, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:30:17\n",
      "2021-07-29 19:59:27 [INFO]\t[TRAIN] Epoch=17/32, Step=70/90, loss=0.007717, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:30:15\n",
      "2021-07-29 19:59:29 [INFO]\t[TRAIN] Epoch=17/32, Step=72/90, loss=0.005167, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:30:13\n",
      "2021-07-29 19:59:31 [INFO]\t[TRAIN] Epoch=17/32, Step=74/90, loss=0.062452, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:30:11\n",
      "2021-07-29 19:59:34 [INFO]\t[TRAIN] Epoch=17/32, Step=76/90, loss=0.003804, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:30:9\n",
      "2021-07-29 19:59:36 [INFO]\t[TRAIN] Epoch=17/32, Step=78/90, loss=0.040944, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:30:7\n",
      "2021-07-29 19:59:38 [INFO]\t[TRAIN] Epoch=17/32, Step=80/90, loss=0.000506, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:30:5\n",
      "2021-07-29 19:59:40 [INFO]\t[TRAIN] Epoch=17/32, Step=82/90, loss=0.012097, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:30:3\n",
      "2021-07-29 19:59:42 [INFO]\t[TRAIN] Epoch=17/32, Step=84/90, loss=0.007362, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:30:1\n",
      "2021-07-29 19:59:44 [INFO]\t[TRAIN] Epoch=17/32, Step=86/90, loss=0.001511, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:29:59\n",
      "2021-07-29 19:59:46 [INFO]\t[TRAIN] Epoch=17/32, Step=88/90, loss=0.029774, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:29:56\n",
      "2021-07-29 19:59:48 [INFO]\t[TRAIN] Epoch=17/32, Step=90/90, loss=1.232883, acc1=0.625, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:29:54\n",
      "2021-07-29 19:59:48 [INFO]\t[TRAIN] Epoch 17 finished, loss=0.047764, acc1=0.983333, acc2=1.0, lr=2.5e-05 .\n",
      "2021-07-29 19:59:48 [INFO]\tStart to evaluating(total_samples=80, total_steps=10)...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 10/10 [00:21<00:00,  2.13s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2021-07-29 20:00:09 [INFO]\t[EVAL] Finished, Epoch=17, acc1=0.975, acc2=1.0 .\n",
      "2021-07-29 20:00:09 [INFO]\tModel saved in output/mobilenetv3_small_ssld/epoch_17.\n",
      "2021-07-29 20:00:09 [INFO]\tCurrent evaluated best model in eval_dataset is epoch_5, acc1=0.9875\n",
      "2021-07-29 20:00:16 [INFO]\t[TRAIN] Epoch=18/32, Step=2/90, loss=0.242759, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.28s, eta=0:30:52\n",
      "2021-07-29 20:00:19 [INFO]\t[TRAIN] Epoch=18/32, Step=4/90, loss=0.014839, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.3s, eta=0:30:51\n",
      "2021-07-29 20:00:21 [INFO]\t[TRAIN] Epoch=18/32, Step=6/90, loss=0.002961, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.28s, eta=0:30:47\n",
      "2021-07-29 20:00:23 [INFO]\t[TRAIN] Epoch=18/32, Step=8/90, loss=0.106806, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.28s, eta=0:30:44\n",
      "2021-07-29 20:00:25 [INFO]\t[TRAIN] Epoch=18/32, Step=10/90, loss=0.003803, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.28s, eta=0:30:42\n",
      "2021-07-29 20:00:27 [INFO]\t[TRAIN] Epoch=18/32, Step=12/90, loss=0.062527, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.29s, eta=0:30:40\n",
      "2021-07-29 20:00:29 [INFO]\t[TRAIN] Epoch=18/32, Step=14/90, loss=0.064736, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.28s, eta=0:30:37\n",
      "2021-07-29 20:00:31 [INFO]\t[TRAIN] Epoch=18/32, Step=16/90, loss=0.048949, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.28s, eta=0:30:34\n",
      "2021-07-29 20:00:33 [INFO]\t[TRAIN] Epoch=18/32, Step=18/90, loss=0.002376, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.26s, eta=0:30:30\n",
      "2021-07-29 20:00:35 [INFO]\t[TRAIN] Epoch=18/32, Step=20/90, loss=0.001339, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.29s, eta=0:30:29\n",
      "2021-07-29 20:00:37 [INFO]\t[TRAIN] Epoch=18/32, Step=22/90, loss=0.001418, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:30:10\n",
      "2021-07-29 20:00:39 [INFO]\t[TRAIN] Epoch=18/32, Step=24/90, loss=0.001455, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:30:7\n",
      "2021-07-29 20:00:41 [INFO]\t[TRAIN] Epoch=18/32, Step=26/90, loss=0.310074, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:30:5\n",
      "2021-07-29 20:00:43 [INFO]\t[TRAIN] Epoch=18/32, Step=28/90, loss=0.00211, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:30:3\n",
      "2021-07-29 20:00:45 [INFO]\t[TRAIN] Epoch=18/32, Step=30/90, loss=0.004637, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:30:0\n",
      "2021-07-29 20:00:47 [INFO]\t[TRAIN] Epoch=18/32, Step=32/90, loss=0.015341, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:29:58\n",
      "2021-07-29 20:00:49 [INFO]\t[TRAIN] Epoch=18/32, Step=34/90, loss=0.004854, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:29:56\n",
      "2021-07-29 20:00:51 [INFO]\t[TRAIN] Epoch=18/32, Step=36/90, loss=0.113891, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:29:54\n",
      "2021-07-29 20:00:53 [INFO]\t[TRAIN] Epoch=18/32, Step=38/90, loss=0.117854, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:29:51\n",
      "2021-07-29 20:00:55 [INFO]\t[TRAIN] Epoch=18/32, Step=40/90, loss=0.007835, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:29:50\n",
      "2021-07-29 20:00:57 [INFO]\t[TRAIN] Epoch=18/32, Step=42/90, loss=0.003157, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:29:48\n",
      "2021-07-29 20:00:59 [INFO]\t[TRAIN] Epoch=18/32, Step=44/90, loss=0.019716, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:29:45\n",
      "2021-07-29 20:01:01 [INFO]\t[TRAIN] Epoch=18/32, Step=46/90, loss=0.00284, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.0s, eta=0:29:43\n",
      "2021-07-29 20:01:03 [INFO]\t[TRAIN] Epoch=18/32, Step=48/90, loss=0.009839, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.0s, eta=0:29:41\n",
      "2021-07-29 20:01:05 [INFO]\t[TRAIN] Epoch=18/32, Step=50/90, loss=0.037303, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.0s, eta=0:29:39\n",
      "2021-07-29 20:01:07 [INFO]\t[TRAIN] Epoch=18/32, Step=52/90, loss=0.013121, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.0s, eta=0:29:37\n",
      "2021-07-29 20:01:09 [INFO]\t[TRAIN] Epoch=18/32, Step=54/90, loss=0.023479, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:29:35\n",
      "2021-07-29 20:01:11 [INFO]\t[TRAIN] Epoch=18/32, Step=56/90, loss=0.047547, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.0s, eta=0:29:33\n",
      "2021-07-29 20:01:14 [INFO]\t[TRAIN] Epoch=18/32, Step=58/90, loss=0.161883, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:29:32\n",
      "2021-07-29 20:01:16 [INFO]\t[TRAIN] Epoch=18/32, Step=60/90, loss=0.043941, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:29:30\n",
      "2021-07-29 20:01:18 [INFO]\t[TRAIN] Epoch=18/32, Step=62/90, loss=0.005847, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:29:28\n",
      "2021-07-29 20:01:20 [INFO]\t[TRAIN] Epoch=18/32, Step=64/90, loss=0.006368, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:29:26\n",
      "2021-07-29 20:01:22 [INFO]\t[TRAIN] Epoch=18/32, Step=66/90, loss=0.000934, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:29:24\n",
      "2021-07-29 20:01:24 [INFO]\t[TRAIN] Epoch=18/32, Step=68/90, loss=0.000413, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:29:22\n",
      "2021-07-29 20:01:26 [INFO]\t[TRAIN] Epoch=18/32, Step=70/90, loss=0.001916, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:29:20\n",
      "2021-07-29 20:01:28 [INFO]\t[TRAIN] Epoch=18/32, Step=72/90, loss=0.015547, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:29:18\n",
      "2021-07-29 20:01:30 [INFO]\t[TRAIN] Epoch=18/32, Step=74/90, loss=0.001871, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:29:16\n",
      "2021-07-29 20:01:32 [INFO]\t[TRAIN] Epoch=18/32, Step=76/90, loss=0.049794, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:29:14\n",
      "2021-07-29 20:01:34 [INFO]\t[TRAIN] Epoch=18/32, Step=78/90, loss=0.071043, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:29:12\n",
      "2021-07-29 20:01:36 [INFO]\t[TRAIN] Epoch=18/32, Step=80/90, loss=0.002219, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:29:9\n",
      "2021-07-29 20:01:38 [INFO]\t[TRAIN] Epoch=18/32, Step=82/90, loss=0.108922, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:29:7\n",
      "2021-07-29 20:01:40 [INFO]\t[TRAIN] Epoch=18/32, Step=84/90, loss=0.017178, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:29:5\n",
      "2021-07-29 20:01:42 [INFO]\t[TRAIN] Epoch=18/32, Step=86/90, loss=0.001443, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:29:3\n",
      "2021-07-29 20:01:44 [INFO]\t[TRAIN] Epoch=18/32, Step=88/90, loss=0.02781, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:29:1\n",
      "2021-07-29 20:01:46 [INFO]\t[TRAIN] Epoch=18/32, Step=90/90, loss=0.00399, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.98s, eta=0:28:59\n",
      "2021-07-29 20:01:46 [INFO]\t[TRAIN] Epoch 18 finished, loss=0.032921, acc1=0.990278, acc2=1.0, lr=2.5e-05 .\n",
      "2021-07-29 20:01:46 [INFO]\tStart to evaluating(total_samples=80, total_steps=10)...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 10/10 [00:17<00:00,  1.80s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2021-07-29 20:02:04 [INFO]\t[EVAL] Finished, Epoch=18, acc1=0.9875, acc2=1.0 .\n",
      "2021-07-29 20:02:04 [INFO]\tModel saved in output/mobilenetv3_small_ssld/epoch_18.\n",
      "2021-07-29 20:02:04 [INFO]\tCurrent evaluated best model in eval_dataset is epoch_5, acc1=0.9875\n",
      "2021-07-29 20:02:11 [INFO]\t[TRAIN] Epoch=19/32, Step=2/90, loss=0.001765, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.23s, eta=0:26:54\n",
      "2021-07-29 20:02:13 [INFO]\t[TRAIN] Epoch=19/32, Step=4/90, loss=0.374679, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.24s, eta=0:26:53\n",
      "2021-07-29 20:02:16 [INFO]\t[TRAIN] Epoch=19/32, Step=6/90, loss=0.000764, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.25s, eta=0:26:51\n",
      "2021-07-29 20:02:18 [INFO]\t[TRAIN] Epoch=19/32, Step=8/90, loss=0.005066, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.26s, eta=0:26:49\n",
      "2021-07-29 20:02:20 [INFO]\t[TRAIN] Epoch=19/32, Step=10/90, loss=0.113254, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.26s, eta=0:26:46\n",
      "2021-07-29 20:02:22 [INFO]\t[TRAIN] Epoch=19/32, Step=12/90, loss=0.069883, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.28s, eta=0:26:45\n",
      "2021-07-29 20:02:25 [INFO]\t[TRAIN] Epoch=19/32, Step=14/90, loss=0.042889, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.29s, eta=0:26:44\n",
      "2021-07-29 20:02:27 [INFO]\t[TRAIN] Epoch=19/32, Step=16/90, loss=0.003528, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.31s, eta=0:26:43\n",
      "2021-07-29 20:02:29 [INFO]\t[TRAIN] Epoch=19/32, Step=18/90, loss=0.031518, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.34s, eta=0:26:42\n",
      "2021-07-29 20:02:32 [INFO]\t[TRAIN] Epoch=19/32, Step=20/90, loss=0.010609, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.39s, eta=0:26:43\n",
      "2021-07-29 20:02:34 [INFO]\t[TRAIN] Epoch=19/32, Step=22/90, loss=0.011643, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.14s, eta=0:26:23\n",
      "2021-07-29 20:02:36 [INFO]\t[TRAIN] Epoch=19/32, Step=24/90, loss=0.049804, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.14s, eta=0:26:21\n",
      "2021-07-29 20:02:38 [INFO]\t[TRAIN] Epoch=19/32, Step=26/90, loss=0.008556, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.14s, eta=0:26:19\n",
      "2021-07-29 20:02:41 [INFO]\t[TRAIN] Epoch=19/32, Step=28/90, loss=0.005984, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.15s, eta=0:26:17\n",
      "2021-07-29 20:02:43 [INFO]\t[TRAIN] Epoch=19/32, Step=30/90, loss=0.009018, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.18s, eta=0:26:16\n",
      "2021-07-29 20:02:45 [INFO]\t[TRAIN] Epoch=19/32, Step=32/90, loss=0.004471, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.16s, eta=0:26:13\n",
      "2021-07-29 20:02:48 [INFO]\t[TRAIN] Epoch=19/32, Step=34/90, loss=0.116062, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.15s, eta=0:26:10\n",
      "2021-07-29 20:02:50 [INFO]\t[TRAIN] Epoch=19/32, Step=36/90, loss=0.023619, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.17s, eta=0:26:9\n",
      "2021-07-29 20:02:53 [INFO]\t[TRAIN] Epoch=19/32, Step=38/90, loss=0.012789, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.17s, eta=0:26:6\n",
      "2021-07-29 20:02:55 [INFO]\t[TRAIN] Epoch=19/32, Step=40/90, loss=0.108777, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.17s, eta=0:26:4\n",
      "2021-07-29 20:02:57 [INFO]\t[TRAIN] Epoch=19/32, Step=42/90, loss=0.150767, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.16s, eta=0:26:2\n",
      "2021-07-29 20:03:00 [INFO]\t[TRAIN] Epoch=19/32, Step=44/90, loss=0.002073, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.17s, eta=0:26:0\n",
      "2021-07-29 20:03:02 [INFO]\t[TRAIN] Epoch=19/32, Step=46/90, loss=0.026115, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.17s, eta=0:25:57\n",
      "2021-07-29 20:03:04 [INFO]\t[TRAIN] Epoch=19/32, Step=48/90, loss=0.000989, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.15s, eta=0:25:54\n",
      "2021-07-29 20:03:06 [INFO]\t[TRAIN] Epoch=19/32, Step=50/90, loss=0.045566, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.14s, eta=0:25:51\n",
      "2021-07-29 20:03:09 [INFO]\t[TRAIN] Epoch=19/32, Step=52/90, loss=0.002386, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.15s, eta=0:25:49\n",
      "2021-07-29 20:03:11 [INFO]\t[TRAIN] Epoch=19/32, Step=54/90, loss=0.008055, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.14s, eta=0:25:47\n",
      "2021-07-29 20:03:13 [INFO]\t[TRAIN] Epoch=19/32, Step=56/90, loss=0.037913, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.11s, eta=0:25:43\n",
      "2021-07-29 20:03:15 [INFO]\t[TRAIN] Epoch=19/32, Step=58/90, loss=0.026133, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.11s, eta=0:25:41\n",
      "2021-07-29 20:03:17 [INFO]\t[TRAIN] Epoch=19/32, Step=60/90, loss=0.169965, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:25:38\n",
      "2021-07-29 20:03:19 [INFO]\t[TRAIN] Epoch=19/32, Step=62/90, loss=0.000761, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:25:36\n",
      "2021-07-29 20:03:21 [INFO]\t[TRAIN] Epoch=19/32, Step=64/90, loss=0.009231, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:25:34\n",
      "2021-07-29 20:03:24 [INFO]\t[TRAIN] Epoch=19/32, Step=66/90, loss=0.001577, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:25:32\n",
      "2021-07-29 20:03:26 [INFO]\t[TRAIN] Epoch=19/32, Step=68/90, loss=0.236661, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:25:29\n",
      "2021-07-29 20:03:28 [INFO]\t[TRAIN] Epoch=19/32, Step=70/90, loss=0.004159, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:25:27\n",
      "2021-07-29 20:03:30 [INFO]\t[TRAIN] Epoch=19/32, Step=72/90, loss=0.332426, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:25:25\n",
      "2021-07-29 20:03:33 [INFO]\t[TRAIN] Epoch=19/32, Step=74/90, loss=0.03515, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:25:23\n",
      "2021-07-29 20:03:35 [INFO]\t[TRAIN] Epoch=19/32, Step=76/90, loss=0.002798, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:25:21\n",
      "2021-07-29 20:03:37 [INFO]\t[TRAIN] Epoch=19/32, Step=78/90, loss=0.006801, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.11s, eta=0:25:19\n",
      "2021-07-29 20:03:39 [INFO]\t[TRAIN] Epoch=19/32, Step=80/90, loss=0.005121, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.11s, eta=0:25:17\n",
      "2021-07-29 20:03:41 [INFO]\t[TRAIN] Epoch=19/32, Step=82/90, loss=0.185473, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:25:14\n",
      "2021-07-29 20:03:43 [INFO]\t[TRAIN] Epoch=19/32, Step=84/90, loss=0.37406, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:25:12\n",
      "2021-07-29 20:03:45 [INFO]\t[TRAIN] Epoch=19/32, Step=86/90, loss=0.008344, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:25:10\n",
      "2021-07-29 20:03:47 [INFO]\t[TRAIN] Epoch=19/32, Step=88/90, loss=0.003039, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:25:8\n",
      "2021-07-29 20:03:49 [INFO]\t[TRAIN] Epoch=19/32, Step=90/90, loss=0.002168, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:25:6\n",
      "2021-07-29 20:03:49 [INFO]\t[TRAIN] Epoch 19 finished, loss=0.053109, acc1=0.976389, acc2=1.0, lr=2.5e-05 .\n",
      "2021-07-29 20:03:49 [INFO]\tStart to evaluating(total_samples=80, total_steps=10)...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 10/10 [00:21<00:00,  2.10s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2021-07-29 20:04:10 [INFO]\t[EVAL] Finished, Epoch=19, acc1=0.975, acc2=1.0 .\n",
      "2021-07-29 20:04:10 [INFO]\tModel saved in output/mobilenetv3_small_ssld/epoch_19.\n",
      "2021-07-29 20:04:10 [INFO]\tCurrent evaluated best model in eval_dataset is epoch_5, acc1=0.9875\n",
      "2021-07-29 20:04:20 [INFO]\t[TRAIN] Epoch=20/32, Step=2/90, loss=0.108668, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.4s, eta=0:27:37\n",
      "2021-07-29 20:04:22 [INFO]\t[TRAIN] Epoch=20/32, Step=4/90, loss=0.028045, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.4s, eta=0:27:35\n",
      "2021-07-29 20:04:24 [INFO]\t[TRAIN] Epoch=20/32, Step=6/90, loss=0.001441, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.39s, eta=0:27:31\n",
      "2021-07-29 20:04:26 [INFO]\t[TRAIN] Epoch=20/32, Step=8/90, loss=0.226694, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.39s, eta=0:27:28\n",
      "2021-07-29 20:04:28 [INFO]\t[TRAIN] Epoch=20/32, Step=10/90, loss=0.012949, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.4s, eta=0:27:26\n",
      "2021-07-29 20:04:30 [INFO]\t[TRAIN] Epoch=20/32, Step=12/90, loss=0.00053, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.4s, eta=0:27:23\n",
      "2021-07-29 20:04:32 [INFO]\t[TRAIN] Epoch=20/32, Step=14/90, loss=0.000796, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.39s, eta=0:27:20\n",
      "2021-07-29 20:04:34 [INFO]\t[TRAIN] Epoch=20/32, Step=16/90, loss=0.622089, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.38s, eta=0:27:17\n",
      "2021-07-29 20:04:36 [INFO]\t[TRAIN] Epoch=20/32, Step=18/90, loss=0.051132, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.39s, eta=0:27:14\n",
      "2021-07-29 20:04:38 [INFO]\t[TRAIN] Epoch=20/32, Step=20/90, loss=0.062847, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.41s, eta=0:27:13\n",
      "2021-07-29 20:04:41 [INFO]\t[TRAIN] Epoch=20/32, Step=22/90, loss=0.002326, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:26:45\n",
      "2021-07-29 20:04:43 [INFO]\t[TRAIN] Epoch=20/32, Step=24/90, loss=0.00049, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:26:42\n",
      "2021-07-29 20:04:45 [INFO]\t[TRAIN] Epoch=20/32, Step=26/90, loss=0.005164, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:26:41\n",
      "2021-07-29 20:04:47 [INFO]\t[TRAIN] Epoch=20/32, Step=28/90, loss=0.055752, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:26:39\n",
      "2021-07-29 20:04:49 [INFO]\t[TRAIN] Epoch=20/32, Step=30/90, loss=0.011705, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:26:37\n",
      "2021-07-29 20:04:51 [INFO]\t[TRAIN] Epoch=20/32, Step=32/90, loss=0.004983, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:26:34\n",
      "2021-07-29 20:04:53 [INFO]\t[TRAIN] Epoch=20/32, Step=34/90, loss=0.00754, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:26:33\n",
      "2021-07-29 20:04:55 [INFO]\t[TRAIN] Epoch=20/32, Step=36/90, loss=0.014195, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:26:31\n",
      "2021-07-29 20:04:57 [INFO]\t[TRAIN] Epoch=20/32, Step=38/90, loss=0.014093, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:26:28\n",
      "2021-07-29 20:04:59 [INFO]\t[TRAIN] Epoch=20/32, Step=40/90, loss=0.04842, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:26:26\n",
      "2021-07-29 20:05:01 [INFO]\t[TRAIN] Epoch=20/32, Step=42/90, loss=0.015074, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:26:23\n",
      "2021-07-29 20:05:03 [INFO]\t[TRAIN] Epoch=20/32, Step=44/90, loss=0.000414, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:26:21\n",
      "2021-07-29 20:05:05 [INFO]\t[TRAIN] Epoch=20/32, Step=46/90, loss=0.000369, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:26:18\n",
      "2021-07-29 20:05:07 [INFO]\t[TRAIN] Epoch=20/32, Step=48/90, loss=0.023868, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.0s, eta=0:26:16\n",
      "2021-07-29 20:05:09 [INFO]\t[TRAIN] Epoch=20/32, Step=50/90, loss=0.237121, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:26:14\n",
      "2021-07-29 20:05:11 [INFO]\t[TRAIN] Epoch=20/32, Step=52/90, loss=0.007993, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:26:12\n",
      "2021-07-29 20:05:13 [INFO]\t[TRAIN] Epoch=20/32, Step=54/90, loss=0.046518, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.0s, eta=0:26:10\n",
      "2021-07-29 20:05:15 [INFO]\t[TRAIN] Epoch=20/32, Step=56/90, loss=0.003712, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=0.99s, eta=0:26:8\n",
      "2021-07-29 20:05:18 [INFO]\t[TRAIN] Epoch=20/32, Step=58/90, loss=0.001827, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:26:6\n",
      "2021-07-29 20:05:20 [INFO]\t[TRAIN] Epoch=20/32, Step=60/90, loss=0.00464, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:26:4\n",
      "2021-07-29 20:05:22 [INFO]\t[TRAIN] Epoch=20/32, Step=62/90, loss=0.024458, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:26:3\n",
      "2021-07-29 20:05:24 [INFO]\t[TRAIN] Epoch=20/32, Step=64/90, loss=0.006057, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:26:0\n",
      "2021-07-29 20:05:26 [INFO]\t[TRAIN] Epoch=20/32, Step=66/90, loss=0.004489, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:25:59\n",
      "2021-07-29 20:05:28 [INFO]\t[TRAIN] Epoch=20/32, Step=68/90, loss=0.25016, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:25:57\n",
      "2021-07-29 20:05:30 [INFO]\t[TRAIN] Epoch=20/32, Step=70/90, loss=0.016859, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:25:54\n",
      "2021-07-29 20:05:32 [INFO]\t[TRAIN] Epoch=20/32, Step=72/90, loss=0.002698, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:25:52\n",
      "2021-07-29 20:05:34 [INFO]\t[TRAIN] Epoch=20/32, Step=74/90, loss=0.056408, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:25:51\n",
      "2021-07-29 20:05:36 [INFO]\t[TRAIN] Epoch=20/32, Step=76/90, loss=0.004352, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:25:49\n",
      "2021-07-29 20:05:38 [INFO]\t[TRAIN] Epoch=20/32, Step=78/90, loss=0.014685, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:25:46\n",
      "2021-07-29 20:05:40 [INFO]\t[TRAIN] Epoch=20/32, Step=80/90, loss=0.003204, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:25:44\n",
      "2021-07-29 20:05:42 [INFO]\t[TRAIN] Epoch=20/32, Step=82/90, loss=0.122565, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:25:42\n",
      "2021-07-29 20:05:45 [INFO]\t[TRAIN] Epoch=20/32, Step=84/90, loss=0.000931, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:25:40\n",
      "2021-07-29 20:05:47 [INFO]\t[TRAIN] Epoch=20/32, Step=86/90, loss=0.000502, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:25:38\n",
      "2021-07-29 20:05:49 [INFO]\t[TRAIN] Epoch=20/32, Step=88/90, loss=0.001856, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:25:36\n",
      "2021-07-29 20:05:51 [INFO]\t[TRAIN] Epoch=20/32, Step=90/90, loss=0.028513, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:25:34\n",
      "2021-07-29 20:05:51 [INFO]\t[TRAIN] Epoch 20 finished, loss=0.043657, acc1=0.9875, acc2=1.0, lr=2.5e-05 .\n",
      "2021-07-29 20:05:51 [INFO]\tStart to evaluating(total_samples=80, total_steps=10)...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 10/10 [00:20<00:00,  2.02s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2021-07-29 20:06:11 [INFO]\t[EVAL] Finished, Epoch=20, acc1=0.9875, acc2=1.0 .\n",
      "2021-07-29 20:06:11 [INFO]\tModel saved in output/mobilenetv3_small_ssld/epoch_20.\n",
      "2021-07-29 20:06:11 [INFO]\tCurrent evaluated best model in eval_dataset is epoch_5, acc1=0.9875\n",
      "2021-07-29 20:06:18 [INFO]\t[TRAIN] Epoch=21/32, Step=2/90, loss=0.003523, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.28s, eta=0:24:26\n",
      "2021-07-29 20:06:20 [INFO]\t[TRAIN] Epoch=21/32, Step=4/90, loss=0.002986, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.29s, eta=0:24:25\n",
      "2021-07-29 20:06:23 [INFO]\t[TRAIN] Epoch=21/32, Step=6/90, loss=0.150762, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.29s, eta=0:24:22\n",
      "2021-07-29 20:06:25 [INFO]\t[TRAIN] Epoch=21/32, Step=8/90, loss=0.014695, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.29s, eta=0:24:19\n",
      "2021-07-29 20:06:27 [INFO]\t[TRAIN] Epoch=21/32, Step=10/90, loss=0.06774, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.29s, eta=0:24:17\n",
      "2021-07-29 20:06:29 [INFO]\t[TRAIN] Epoch=21/32, Step=12/90, loss=0.000427, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.28s, eta=0:24:14\n",
      "2021-07-29 20:06:31 [INFO]\t[TRAIN] Epoch=21/32, Step=14/90, loss=0.00613, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.27s, eta=0:24:10\n",
      "2021-07-29 20:06:33 [INFO]\t[TRAIN] Epoch=21/32, Step=16/90, loss=0.003283, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.28s, eta=0:24:8\n",
      "2021-07-29 20:06:35 [INFO]\t[TRAIN] Epoch=21/32, Step=18/90, loss=0.004223, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.28s, eta=0:24:6\n",
      "2021-07-29 20:06:37 [INFO]\t[TRAIN] Epoch=21/32, Step=20/90, loss=0.147122, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.3s, eta=0:24:5\n",
      "2021-07-29 20:06:39 [INFO]\t[TRAIN] Epoch=21/32, Step=22/90, loss=0.019673, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:23:46\n",
      "2021-07-29 20:06:42 [INFO]\t[TRAIN] Epoch=21/32, Step=24/90, loss=0.000797, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:23:43\n",
      "2021-07-29 20:06:44 [INFO]\t[TRAIN] Epoch=21/32, Step=26/90, loss=0.053182, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:23:41\n",
      "2021-07-29 20:06:46 [INFO]\t[TRAIN] Epoch=21/32, Step=28/90, loss=1.338234, acc1=0.75, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:23:39\n",
      "2021-07-29 20:06:48 [INFO]\t[TRAIN] Epoch=21/32, Step=30/90, loss=0.016493, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:23:37\n",
      "2021-07-29 20:06:50 [INFO]\t[TRAIN] Epoch=21/32, Step=32/90, loss=0.048077, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:23:35\n",
      "2021-07-29 20:06:52 [INFO]\t[TRAIN] Epoch=21/32, Step=34/90, loss=0.375797, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:23:34\n",
      "2021-07-29 20:06:54 [INFO]\t[TRAIN] Epoch=21/32, Step=36/90, loss=0.067301, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:23:31\n",
      "2021-07-29 20:06:57 [INFO]\t[TRAIN] Epoch=21/32, Step=38/90, loss=0.027608, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:23:30\n",
      "2021-07-29 20:06:59 [INFO]\t[TRAIN] Epoch=21/32, Step=40/90, loss=0.003691, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:23:28\n",
      "2021-07-29 20:07:01 [INFO]\t[TRAIN] Epoch=21/32, Step=42/90, loss=0.026168, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:23:26\n",
      "2021-07-29 20:07:04 [INFO]\t[TRAIN] Epoch=21/32, Step=44/90, loss=0.126907, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.12s, eta=0:23:25\n",
      "2021-07-29 20:07:06 [INFO]\t[TRAIN] Epoch=21/32, Step=46/90, loss=0.001364, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.13s, eta=0:23:24\n",
      "2021-07-29 20:07:08 [INFO]\t[TRAIN] Epoch=21/32, Step=48/90, loss=0.009139, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.13s, eta=0:23:21\n",
      "2021-07-29 20:07:10 [INFO]\t[TRAIN] Epoch=21/32, Step=50/90, loss=0.003081, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.13s, eta=0:23:19\n",
      "2021-07-29 20:07:13 [INFO]\t[TRAIN] Epoch=21/32, Step=52/90, loss=0.000505, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.14s, eta=0:23:17\n",
      "2021-07-29 20:07:15 [INFO]\t[TRAIN] Epoch=21/32, Step=54/90, loss=0.018705, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.13s, eta=0:23:14\n",
      "2021-07-29 20:07:17 [INFO]\t[TRAIN] Epoch=21/32, Step=56/90, loss=0.001061, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.13s, eta=0:23:12\n",
      "2021-07-29 20:07:19 [INFO]\t[TRAIN] Epoch=21/32, Step=58/90, loss=0.008808, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.12s, eta=0:23:10\n",
      "2021-07-29 20:07:21 [INFO]\t[TRAIN] Epoch=21/32, Step=60/90, loss=0.004371, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.11s, eta=0:23:7\n",
      "2021-07-29 20:07:23 [INFO]\t[TRAIN] Epoch=21/32, Step=62/90, loss=0.033529, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:23:4\n",
      "2021-07-29 20:07:25 [INFO]\t[TRAIN] Epoch=21/32, Step=64/90, loss=0.0058, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:23:2\n",
      "2021-07-29 20:07:28 [INFO]\t[TRAIN] Epoch=21/32, Step=66/90, loss=0.013618, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:22:59\n",
      "2021-07-29 20:07:30 [INFO]\t[TRAIN] Epoch=21/32, Step=68/90, loss=0.003729, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:22:57\n",
      "2021-07-29 20:07:32 [INFO]\t[TRAIN] Epoch=21/32, Step=70/90, loss=0.00807, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:22:55\n",
      "2021-07-29 20:07:34 [INFO]\t[TRAIN] Epoch=21/32, Step=72/90, loss=0.026109, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:22:53\n",
      "2021-07-29 20:07:36 [INFO]\t[TRAIN] Epoch=21/32, Step=74/90, loss=0.002038, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:22:51\n",
      "2021-07-29 20:07:38 [INFO]\t[TRAIN] Epoch=21/32, Step=76/90, loss=0.021603, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:22:49\n",
      "2021-07-29 20:07:40 [INFO]\t[TRAIN] Epoch=21/32, Step=78/90, loss=0.026922, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:22:46\n",
      "2021-07-29 20:07:42 [INFO]\t[TRAIN] Epoch=21/32, Step=80/90, loss=0.073317, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:22:44\n",
      "2021-07-29 20:07:45 [INFO]\t[TRAIN] Epoch=21/32, Step=82/90, loss=0.00767, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:22:42\n",
      "2021-07-29 20:07:47 [INFO]\t[TRAIN] Epoch=21/32, Step=84/90, loss=0.00141, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:22:40\n",
      "2021-07-29 20:07:49 [INFO]\t[TRAIN] Epoch=21/32, Step=86/90, loss=0.00923, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:22:38\n",
      "2021-07-29 20:07:51 [INFO]\t[TRAIN] Epoch=21/32, Step=88/90, loss=0.003588, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:22:36\n",
      "2021-07-29 20:07:52 [INFO]\t[TRAIN] Epoch=21/32, Step=90/90, loss=0.017899, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:22:34\n",
      "2021-07-29 20:07:52 [INFO]\t[TRAIN] Epoch 21 finished, loss=0.056529, acc1=0.981944, acc2=1.0, lr=2.5e-05 .\n",
      "2021-07-29 20:07:52 [INFO]\tStart to evaluating(total_samples=80, total_steps=10)...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 10/10 [00:18<00:00,  1.86s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2021-07-29 20:08:11 [INFO]\t[EVAL] Finished, Epoch=21, acc1=0.975, acc2=1.0 .\n",
      "2021-07-29 20:08:11 [INFO]\tModel saved in output/mobilenetv3_small_ssld/epoch_21.\n",
      "2021-07-29 20:08:11 [INFO]\tCurrent evaluated best model in eval_dataset is epoch_5, acc1=0.9875\n",
      "2021-07-29 20:08:20 [INFO]\t[TRAIN] Epoch=22/32, Step=2/90, loss=0.181541, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.32s, eta=0:22:17\n",
      "2021-07-29 20:08:22 [INFO]\t[TRAIN] Epoch=22/32, Step=4/90, loss=0.045735, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.34s, eta=0:22:15\n",
      "2021-07-29 20:08:24 [INFO]\t[TRAIN] Epoch=22/32, Step=6/90, loss=0.006653, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.34s, eta=0:22:13\n",
      "2021-07-29 20:08:27 [INFO]\t[TRAIN] Epoch=22/32, Step=8/90, loss=0.014547, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.36s, eta=0:22:12\n",
      "2021-07-29 20:08:29 [INFO]\t[TRAIN] Epoch=22/32, Step=10/90, loss=0.273003, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.35s, eta=0:22:8\n",
      "2021-07-29 20:08:31 [INFO]\t[TRAIN] Epoch=22/32, Step=12/90, loss=0.024229, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.35s, eta=0:22:6\n",
      "2021-07-29 20:08:33 [INFO]\t[TRAIN] Epoch=22/32, Step=14/90, loss=0.045362, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.35s, eta=0:22:3\n",
      "2021-07-29 20:08:35 [INFO]\t[TRAIN] Epoch=22/32, Step=16/90, loss=0.022256, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.35s, eta=0:22:0\n",
      "2021-07-29 20:08:37 [INFO]\t[TRAIN] Epoch=22/32, Step=18/90, loss=0.009613, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.36s, eta=0:21:58\n",
      "2021-07-29 20:08:39 [INFO]\t[TRAIN] Epoch=22/32, Step=20/90, loss=0.01289, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.4s, eta=0:21:58\n",
      "2021-07-29 20:08:42 [INFO]\t[TRAIN] Epoch=22/32, Step=22/90, loss=0.002385, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:21:35\n",
      "2021-07-29 20:08:44 [INFO]\t[TRAIN] Epoch=22/32, Step=24/90, loss=0.004295, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:21:32\n",
      "2021-07-29 20:08:46 [INFO]\t[TRAIN] Epoch=22/32, Step=26/90, loss=0.002655, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:21:30\n",
      "2021-07-29 20:08:48 [INFO]\t[TRAIN] Epoch=22/32, Step=28/90, loss=0.017916, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:21:27\n",
      "2021-07-29 20:08:50 [INFO]\t[TRAIN] Epoch=22/32, Step=30/90, loss=0.001146, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:21:25\n",
      "2021-07-29 20:08:53 [INFO]\t[TRAIN] Epoch=22/32, Step=32/90, loss=0.00096, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:21:23\n",
      "2021-07-29 20:08:55 [INFO]\t[TRAIN] Epoch=22/32, Step=34/90, loss=0.095173, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:21:22\n",
      "2021-07-29 20:08:57 [INFO]\t[TRAIN] Epoch=22/32, Step=36/90, loss=0.075725, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:21:19\n",
      "2021-07-29 20:08:59 [INFO]\t[TRAIN] Epoch=22/32, Step=38/90, loss=0.02164, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:21:17\n",
      "2021-07-29 20:09:01 [INFO]\t[TRAIN] Epoch=22/32, Step=40/90, loss=0.07916, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:21:15\n",
      "2021-07-29 20:09:03 [INFO]\t[TRAIN] Epoch=22/32, Step=42/90, loss=0.002251, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:21:12\n",
      "2021-07-29 20:09:05 [INFO]\t[TRAIN] Epoch=22/32, Step=44/90, loss=0.006859, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:21:10\n",
      "2021-07-29 20:09:08 [INFO]\t[TRAIN] Epoch=22/32, Step=46/90, loss=0.014519, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:21:8\n",
      "2021-07-29 20:09:09 [INFO]\t[TRAIN] Epoch=22/32, Step=48/90, loss=0.003142, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:21:5\n",
      "2021-07-29 20:09:11 [INFO]\t[TRAIN] Epoch=22/32, Step=50/90, loss=0.001382, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:21:2\n",
      "2021-07-29 20:09:13 [INFO]\t[TRAIN] Epoch=22/32, Step=52/90, loss=0.10979, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:21:0\n",
      "2021-07-29 20:09:15 [INFO]\t[TRAIN] Epoch=22/32, Step=54/90, loss=0.038852, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:20:57\n",
      "2021-07-29 20:09:18 [INFO]\t[TRAIN] Epoch=22/32, Step=56/90, loss=0.046157, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:20:55\n",
      "2021-07-29 20:09:19 [INFO]\t[TRAIN] Epoch=22/32, Step=58/90, loss=0.003567, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:20:53\n",
      "2021-07-29 20:09:21 [INFO]\t[TRAIN] Epoch=22/32, Step=60/90, loss=0.005708, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.0s, eta=0:20:50\n",
      "2021-07-29 20:09:24 [INFO]\t[TRAIN] Epoch=22/32, Step=62/90, loss=0.003852, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:20:48\n",
      "2021-07-29 20:09:26 [INFO]\t[TRAIN] Epoch=22/32, Step=64/90, loss=0.004329, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:20:46\n",
      "2021-07-29 20:09:28 [INFO]\t[TRAIN] Epoch=22/32, Step=66/90, loss=0.001811, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:20:45\n",
      "2021-07-29 20:09:30 [INFO]\t[TRAIN] Epoch=22/32, Step=68/90, loss=0.00091, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:20:43\n",
      "2021-07-29 20:09:32 [INFO]\t[TRAIN] Epoch=22/32, Step=70/90, loss=0.007363, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:20:41\n",
      "2021-07-29 20:09:34 [INFO]\t[TRAIN] Epoch=22/32, Step=72/90, loss=0.001205, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:20:39\n",
      "2021-07-29 20:09:36 [INFO]\t[TRAIN] Epoch=22/32, Step=74/90, loss=0.008149, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:20:37\n",
      "2021-07-29 20:09:39 [INFO]\t[TRAIN] Epoch=22/32, Step=76/90, loss=0.020586, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:20:35\n",
      "2021-07-29 20:09:41 [INFO]\t[TRAIN] Epoch=22/32, Step=78/90, loss=0.001704, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:20:33\n",
      "2021-07-29 20:09:43 [INFO]\t[TRAIN] Epoch=22/32, Step=80/90, loss=0.059025, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:20:31\n",
      "2021-07-29 20:09:45 [INFO]\t[TRAIN] Epoch=22/32, Step=82/90, loss=0.005806, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:20:29\n",
      "2021-07-29 20:09:47 [INFO]\t[TRAIN] Epoch=22/32, Step=84/90, loss=0.151742, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:20:26\n",
      "2021-07-29 20:09:49 [INFO]\t[TRAIN] Epoch=22/32, Step=86/90, loss=0.001525, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:20:24\n",
      "2021-07-29 20:09:51 [INFO]\t[TRAIN] Epoch=22/32, Step=88/90, loss=0.109363, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:20:22\n",
      "2021-07-29 20:09:52 [INFO]\t[TRAIN] Epoch=22/32, Step=90/90, loss=0.003971, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.0s, eta=0:20:20\n",
      "2021-07-29 20:09:52 [INFO]\t[TRAIN] Epoch 22 finished, loss=0.059564, acc1=0.980556, acc2=1.0, lr=2.5e-05 .\n",
      "2021-07-29 20:09:52 [INFO]\tStart to evaluating(total_samples=80, total_steps=10)...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 10/10 [00:18<00:00,  1.90s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2021-07-29 20:10:11 [INFO]\t[EVAL] Finished, Epoch=22, acc1=0.975, acc2=1.0 .\n",
      "2021-07-29 20:10:12 [INFO]\tModel saved in output/mobilenetv3_small_ssld/epoch_22.\n",
      "2021-07-29 20:10:12 [INFO]\tCurrent evaluated best model in eval_dataset is epoch_5, acc1=0.9875\n",
      "2021-07-29 20:10:20 [INFO]\t[TRAIN] Epoch=23/32, Step=2/90, loss=0.032624, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.32s, eta=0:20:17\n",
      "2021-07-29 20:10:23 [INFO]\t[TRAIN] Epoch=23/32, Step=4/90, loss=0.008542, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.35s, eta=0:20:17\n",
      "2021-07-29 20:10:25 [INFO]\t[TRAIN] Epoch=23/32, Step=6/90, loss=0.012129, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.35s, eta=0:20:14\n",
      "2021-07-29 20:10:27 [INFO]\t[TRAIN] Epoch=23/32, Step=8/90, loss=0.018679, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.37s, eta=0:20:13\n",
      "2021-07-29 20:10:30 [INFO]\t[TRAIN] Epoch=23/32, Step=10/90, loss=0.024502, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.38s, eta=0:20:11\n",
      "2021-07-29 20:10:32 [INFO]\t[TRAIN] Epoch=23/32, Step=12/90, loss=0.000432, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.38s, eta=0:20:9\n",
      "2021-07-29 20:10:34 [INFO]\t[TRAIN] Epoch=23/32, Step=14/90, loss=0.002151, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.39s, eta=0:20:6\n",
      "2021-07-29 20:10:36 [INFO]\t[TRAIN] Epoch=23/32, Step=16/90, loss=0.000532, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.4s, eta=0:20:4\n",
      "2021-07-29 20:10:38 [INFO]\t[TRAIN] Epoch=23/32, Step=18/90, loss=0.010233, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.41s, eta=0:20:2\n",
      "2021-07-29 20:10:41 [INFO]\t[TRAIN] Epoch=23/32, Step=20/90, loss=0.009622, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.44s, eta=0:20:2\n",
      "2021-07-29 20:10:43 [INFO]\t[TRAIN] Epoch=23/32, Step=22/90, loss=0.01437, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.12s, eta=0:19:37\n",
      "2021-07-29 20:10:45 [INFO]\t[TRAIN] Epoch=23/32, Step=24/90, loss=0.031947, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:19:33\n",
      "2021-07-29 20:10:47 [INFO]\t[TRAIN] Epoch=23/32, Step=26/90, loss=0.09859, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:19:31\n",
      "2021-07-29 20:10:49 [INFO]\t[TRAIN] Epoch=23/32, Step=28/90, loss=0.110391, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:19:28\n",
      "2021-07-29 20:10:51 [INFO]\t[TRAIN] Epoch=23/32, Step=30/90, loss=0.823659, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:19:25\n",
      "2021-07-29 20:10:53 [INFO]\t[TRAIN] Epoch=23/32, Step=32/90, loss=0.001673, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:19:24\n",
      "2021-07-29 20:10:55 [INFO]\t[TRAIN] Epoch=23/32, Step=34/90, loss=0.015532, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:19:21\n",
      "2021-07-29 20:10:58 [INFO]\t[TRAIN] Epoch=23/32, Step=36/90, loss=0.009994, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:19:19\n",
      "2021-07-29 20:11:00 [INFO]\t[TRAIN] Epoch=23/32, Step=38/90, loss=0.139105, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:19:17\n",
      "2021-07-29 20:11:02 [INFO]\t[TRAIN] Epoch=23/32, Step=40/90, loss=0.016187, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:19:15\n",
      "2021-07-29 20:11:04 [INFO]\t[TRAIN] Epoch=23/32, Step=42/90, loss=0.002637, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:19:13\n",
      "2021-07-29 20:11:06 [INFO]\t[TRAIN] Epoch=23/32, Step=44/90, loss=0.000654, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:19:11\n",
      "2021-07-29 20:11:09 [INFO]\t[TRAIN] Epoch=23/32, Step=46/90, loss=0.072305, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:19:9\n",
      "2021-07-29 20:11:11 [INFO]\t[TRAIN] Epoch=23/32, Step=48/90, loss=0.009289, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:19:7\n",
      "2021-07-29 20:11:13 [INFO]\t[TRAIN] Epoch=23/32, Step=50/90, loss=0.019685, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:19:4\n",
      "2021-07-29 20:11:15 [INFO]\t[TRAIN] Epoch=23/32, Step=52/90, loss=0.051341, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:19:3\n",
      "2021-07-29 20:11:17 [INFO]\t[TRAIN] Epoch=23/32, Step=54/90, loss=0.003168, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:19:0\n",
      "2021-07-29 20:11:20 [INFO]\t[TRAIN] Epoch=23/32, Step=56/90, loss=0.003281, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:18:58\n",
      "2021-07-29 20:11:22 [INFO]\t[TRAIN] Epoch=23/32, Step=58/90, loss=0.007916, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:18:56\n",
      "2021-07-29 20:11:24 [INFO]\t[TRAIN] Epoch=23/32, Step=60/90, loss=0.007486, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:18:54\n",
      "2021-07-29 20:11:26 [INFO]\t[TRAIN] Epoch=23/32, Step=62/90, loss=0.054592, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:18:52\n",
      "2021-07-29 20:11:28 [INFO]\t[TRAIN] Epoch=23/32, Step=64/90, loss=0.001932, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:18:49\n",
      "2021-07-29 20:11:30 [INFO]\t[TRAIN] Epoch=23/32, Step=66/90, loss=0.012375, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:18:47\n",
      "2021-07-29 20:11:32 [INFO]\t[TRAIN] Epoch=23/32, Step=68/90, loss=0.001303, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:18:45\n",
      "2021-07-29 20:11:35 [INFO]\t[TRAIN] Epoch=23/32, Step=70/90, loss=0.000477, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:18:43\n",
      "2021-07-29 20:11:37 [INFO]\t[TRAIN] Epoch=23/32, Step=72/90, loss=0.003436, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:18:40\n",
      "2021-07-29 20:11:39 [INFO]\t[TRAIN] Epoch=23/32, Step=74/90, loss=0.004118, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:18:38\n",
      "2021-07-29 20:11:42 [INFO]\t[TRAIN] Epoch=23/32, Step=76/90, loss=0.061447, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.11s, eta=0:18:36\n",
      "2021-07-29 20:11:44 [INFO]\t[TRAIN] Epoch=23/32, Step=78/90, loss=0.002142, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.11s, eta=0:18:34\n",
      "2021-07-29 20:11:46 [INFO]\t[TRAIN] Epoch=23/32, Step=80/90, loss=0.038737, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:18:32\n",
      "2021-07-29 20:11:48 [INFO]\t[TRAIN] Epoch=23/32, Step=82/90, loss=0.020829, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:18:30\n",
      "2021-07-29 20:11:50 [INFO]\t[TRAIN] Epoch=23/32, Step=84/90, loss=0.005637, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.11s, eta=0:18:28\n",
      "2021-07-29 20:11:53 [INFO]\t[TRAIN] Epoch=23/32, Step=86/90, loss=0.003062, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.11s, eta=0:18:25\n",
      "2021-07-29 20:11:55 [INFO]\t[TRAIN] Epoch=23/32, Step=88/90, loss=0.002651, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:18:23\n",
      "2021-07-29 20:11:56 [INFO]\t[TRAIN] Epoch=23/32, Step=90/90, loss=0.005112, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:18:21\n",
      "2021-07-29 20:11:56 [INFO]\t[TRAIN] Epoch 23 finished, loss=0.03693, acc1=0.990278, acc2=1.0, lr=2.5e-05 .\n",
      "2021-07-29 20:11:56 [INFO]\tStart to evaluating(total_samples=80, total_steps=10)...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 10/10 [00:18<00:00,  1.85s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2021-07-29 20:12:15 [INFO]\t[EVAL] Finished, Epoch=23, acc1=0.9875, acc2=1.0 .\n",
      "2021-07-29 20:12:15 [INFO]\tModel saved in output/mobilenetv3_small_ssld/epoch_23.\n",
      "2021-07-29 20:12:15 [INFO]\tCurrent evaluated best model in eval_dataset is epoch_5, acc1=0.9875\n",
      "2021-07-29 20:12:22 [INFO]\t[TRAIN] Epoch=24/32, Step=2/90, loss=0.000798, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.31s, eta=0:18:40\n",
      "2021-07-29 20:12:25 [INFO]\t[TRAIN] Epoch=24/32, Step=4/90, loss=0.007861, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.31s, eta=0:18:38\n",
      "2021-07-29 20:12:27 [INFO]\t[TRAIN] Epoch=24/32, Step=6/90, loss=0.003869, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.3s, eta=0:18:34\n",
      "2021-07-29 20:12:29 [INFO]\t[TRAIN] Epoch=24/32, Step=8/90, loss=0.000672, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.3s, eta=0:18:32\n",
      "2021-07-29 20:12:31 [INFO]\t[TRAIN] Epoch=24/32, Step=10/90, loss=0.148031, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.3s, eta=0:18:29\n",
      "2021-07-29 20:12:33 [INFO]\t[TRAIN] Epoch=24/32, Step=12/90, loss=0.103512, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.31s, eta=0:18:27\n",
      "2021-07-29 20:12:35 [INFO]\t[TRAIN] Epoch=24/32, Step=14/90, loss=0.004837, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.3s, eta=0:18:24\n",
      "2021-07-29 20:12:37 [INFO]\t[TRAIN] Epoch=24/32, Step=16/90, loss=0.002415, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.3s, eta=0:18:21\n",
      "2021-07-29 20:12:39 [INFO]\t[TRAIN] Epoch=24/32, Step=18/90, loss=0.020979, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.31s, eta=0:18:19\n",
      "2021-07-29 20:12:42 [INFO]\t[TRAIN] Epoch=24/32, Step=20/90, loss=0.001374, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.33s, eta=0:18:18\n",
      "2021-07-29 20:12:44 [INFO]\t[TRAIN] Epoch=24/32, Step=22/90, loss=0.134981, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:17:59\n",
      "2021-07-29 20:12:46 [INFO]\t[TRAIN] Epoch=24/32, Step=24/90, loss=0.006132, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:17:56\n",
      "2021-07-29 20:12:49 [INFO]\t[TRAIN] Epoch=24/32, Step=26/90, loss=0.00613, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:17:55\n",
      "2021-07-29 20:12:51 [INFO]\t[TRAIN] Epoch=24/32, Step=28/90, loss=0.544997, acc1=0.75, acc2=1.0, lr=2.5e-05, time_each_step=1.11s, eta=0:17:53\n",
      "2021-07-29 20:12:53 [INFO]\t[TRAIN] Epoch=24/32, Step=30/90, loss=0.005041, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.12s, eta=0:17:52\n",
      "2021-07-29 20:12:55 [INFO]\t[TRAIN] Epoch=24/32, Step=32/90, loss=0.01667, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.12s, eta=0:17:49\n",
      "2021-07-29 20:12:57 [INFO]\t[TRAIN] Epoch=24/32, Step=34/90, loss=0.010391, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.11s, eta=0:17:47\n",
      "2021-07-29 20:12:59 [INFO]\t[TRAIN] Epoch=24/32, Step=36/90, loss=0.00486, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:17:44\n",
      "2021-07-29 20:13:01 [INFO]\t[TRAIN] Epoch=24/32, Step=38/90, loss=0.040832, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:17:42\n",
      "2021-07-29 20:13:03 [INFO]\t[TRAIN] Epoch=24/32, Step=40/90, loss=0.505406, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:17:39\n",
      "2021-07-29 20:13:05 [INFO]\t[TRAIN] Epoch=24/32, Step=42/90, loss=0.000914, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:17:36\n",
      "2021-07-29 20:13:07 [INFO]\t[TRAIN] Epoch=24/32, Step=44/90, loss=0.010259, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:17:34\n",
      "2021-07-29 20:13:10 [INFO]\t[TRAIN] Epoch=24/32, Step=46/90, loss=0.000785, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:17:31\n",
      "2021-07-29 20:13:11 [INFO]\t[TRAIN] Epoch=24/32, Step=48/90, loss=0.003212, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:17:28\n",
      "2021-07-29 20:13:13 [INFO]\t[TRAIN] Epoch=24/32, Step=50/90, loss=0.003371, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:17:25\n",
      "2021-07-29 20:13:16 [INFO]\t[TRAIN] Epoch=24/32, Step=52/90, loss=0.004823, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:17:23\n",
      "2021-07-29 20:13:18 [INFO]\t[TRAIN] Epoch=24/32, Step=54/90, loss=0.078222, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:17:21\n",
      "2021-07-29 20:13:20 [INFO]\t[TRAIN] Epoch=24/32, Step=56/90, loss=0.027164, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:17:19\n",
      "2021-07-29 20:13:22 [INFO]\t[TRAIN] Epoch=24/32, Step=58/90, loss=0.015404, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:17:18\n",
      "2021-07-29 20:13:24 [INFO]\t[TRAIN] Epoch=24/32, Step=60/90, loss=0.005991, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:17:16\n",
      "2021-07-29 20:13:26 [INFO]\t[TRAIN] Epoch=24/32, Step=62/90, loss=0.89554, acc1=0.625, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:17:14\n",
      "2021-07-29 20:13:29 [INFO]\t[TRAIN] Epoch=24/32, Step=64/90, loss=0.05793, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:17:12\n",
      "2021-07-29 20:13:31 [INFO]\t[TRAIN] Epoch=24/32, Step=66/90, loss=0.000874, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:17:10\n",
      "2021-07-29 20:13:33 [INFO]\t[TRAIN] Epoch=24/32, Step=68/90, loss=0.057971, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:17:8\n",
      "2021-07-29 20:13:35 [INFO]\t[TRAIN] Epoch=24/32, Step=70/90, loss=0.01941, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:17:6\n",
      "2021-07-29 20:13:37 [INFO]\t[TRAIN] Epoch=24/32, Step=72/90, loss=0.021446, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:17:4\n",
      "2021-07-29 20:13:39 [INFO]\t[TRAIN] Epoch=24/32, Step=74/90, loss=0.00319, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:17:2\n",
      "2021-07-29 20:13:41 [INFO]\t[TRAIN] Epoch=24/32, Step=76/90, loss=0.020722, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:17:0\n",
      "2021-07-29 20:13:43 [INFO]\t[TRAIN] Epoch=24/32, Step=78/90, loss=0.003373, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:16:58\n",
      "2021-07-29 20:13:45 [INFO]\t[TRAIN] Epoch=24/32, Step=80/90, loss=0.024808, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:16:55\n",
      "2021-07-29 20:13:48 [INFO]\t[TRAIN] Epoch=24/32, Step=82/90, loss=0.00045, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:16:53\n",
      "2021-07-29 20:13:50 [INFO]\t[TRAIN] Epoch=24/32, Step=84/90, loss=0.270638, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:16:51\n",
      "2021-07-29 20:13:52 [INFO]\t[TRAIN] Epoch=24/32, Step=86/90, loss=0.019678, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:16:49\n",
      "2021-07-29 20:13:54 [INFO]\t[TRAIN] Epoch=24/32, Step=88/90, loss=0.015596, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:16:47\n",
      "2021-07-29 20:13:55 [INFO]\t[TRAIN] Epoch=24/32, Step=90/90, loss=0.011746, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.01s, eta=0:16:45\n",
      "2021-07-29 20:13:55 [INFO]\t[TRAIN] Epoch 24 finished, loss=0.06656, acc1=0.977778, acc2=1.0, lr=2.5e-05 .\n",
      "2021-07-29 20:13:55 [INFO]\tStart to evaluating(total_samples=80, total_steps=10)...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 10/10 [00:18<00:00,  1.85s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2021-07-29 20:14:14 [INFO]\t[EVAL] Finished, Epoch=24, acc1=0.9875, acc2=1.0 .\n",
      "2021-07-29 20:14:14 [INFO]\tModel saved in output/mobilenetv3_small_ssld/epoch_24.\n",
      "2021-07-29 20:14:14 [INFO]\tCurrent evaluated best model in eval_dataset is epoch_5, acc1=0.9875\n",
      "2021-07-29 20:14:21 [INFO]\t[TRAIN] Epoch=25/32, Step=2/90, loss=0.035712, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.25s, eta=0:16:2\n",
      "2021-07-29 20:14:23 [INFO]\t[TRAIN] Epoch=25/32, Step=4/90, loss=0.079786, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.25s, eta=0:16:0\n",
      "2021-07-29 20:14:25 [INFO]\t[TRAIN] Epoch=25/32, Step=6/90, loss=0.001415, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.26s, eta=0:15:59\n",
      "2021-07-29 20:14:28 [INFO]\t[TRAIN] Epoch=25/32, Step=8/90, loss=0.002092, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.28s, eta=0:15:57\n",
      "2021-07-29 20:14:30 [INFO]\t[TRAIN] Epoch=25/32, Step=10/90, loss=0.007321, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.29s, eta=0:15:56\n",
      "2021-07-29 20:14:32 [INFO]\t[TRAIN] Epoch=25/32, Step=12/90, loss=0.014363, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.28s, eta=0:15:53\n",
      "2021-07-29 20:14:35 [INFO]\t[TRAIN] Epoch=25/32, Step=14/90, loss=0.285643, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.29s, eta=0:15:51\n",
      "2021-07-29 20:14:37 [INFO]\t[TRAIN] Epoch=25/32, Step=16/90, loss=0.00664, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.29s, eta=0:15:48\n",
      "2021-07-29 20:14:39 [INFO]\t[TRAIN] Epoch=25/32, Step=18/90, loss=0.047179, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.31s, eta=0:15:47\n",
      "2021-07-29 20:14:41 [INFO]\t[TRAIN] Epoch=25/32, Step=20/90, loss=0.024481, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.34s, eta=0:15:47\n",
      "2021-07-29 20:14:43 [INFO]\t[TRAIN] Epoch=25/32, Step=22/90, loss=0.003965, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.11s, eta=0:15:28\n",
      "2021-07-29 20:14:45 [INFO]\t[TRAIN] Epoch=25/32, Step=24/90, loss=0.024637, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:15:25\n",
      "2021-07-29 20:14:47 [INFO]\t[TRAIN] Epoch=25/32, Step=26/90, loss=0.011126, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:15:23\n",
      "2021-07-29 20:14:49 [INFO]\t[TRAIN] Epoch=25/32, Step=28/90, loss=0.133061, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:15:20\n",
      "2021-07-29 20:14:52 [INFO]\t[TRAIN] Epoch=25/32, Step=30/90, loss=0.042195, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:15:17\n",
      "2021-07-29 20:14:54 [INFO]\t[TRAIN] Epoch=25/32, Step=32/90, loss=0.084085, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:15:16\n",
      "2021-07-29 20:14:56 [INFO]\t[TRAIN] Epoch=25/32, Step=34/90, loss=0.003601, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:15:13\n",
      "2021-07-29 20:14:58 [INFO]\t[TRAIN] Epoch=25/32, Step=36/90, loss=0.02784, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:15:12\n",
      "2021-07-29 20:15:01 [INFO]\t[TRAIN] Epoch=25/32, Step=38/90, loss=0.081514, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:15:10\n",
      "2021-07-29 20:15:03 [INFO]\t[TRAIN] Epoch=25/32, Step=40/90, loss=0.013521, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:15:8\n",
      "2021-07-29 20:15:05 [INFO]\t[TRAIN] Epoch=25/32, Step=42/90, loss=0.01188, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.11s, eta=0:15:6\n",
      "2021-07-29 20:15:08 [INFO]\t[TRAIN] Epoch=25/32, Step=44/90, loss=0.00249, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.12s, eta=0:15:4\n",
      "2021-07-29 20:15:10 [INFO]\t[TRAIN] Epoch=25/32, Step=46/90, loss=0.049953, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.13s, eta=0:15:3\n",
      "2021-07-29 20:15:12 [INFO]\t[TRAIN] Epoch=25/32, Step=48/90, loss=0.0034, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.15s, eta=0:15:1\n",
      "2021-07-29 20:15:14 [INFO]\t[TRAIN] Epoch=25/32, Step=50/90, loss=0.007695, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.14s, eta=0:14:58\n",
      "2021-07-29 20:15:17 [INFO]\t[TRAIN] Epoch=25/32, Step=52/90, loss=0.00595, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.14s, eta=0:14:56\n",
      "2021-07-29 20:15:19 [INFO]\t[TRAIN] Epoch=25/32, Step=54/90, loss=0.008941, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.14s, eta=0:14:54\n",
      "2021-07-29 20:15:21 [INFO]\t[TRAIN] Epoch=25/32, Step=56/90, loss=0.020863, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.12s, eta=0:14:51\n",
      "2021-07-29 20:15:23 [INFO]\t[TRAIN] Epoch=25/32, Step=58/90, loss=0.003564, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.13s, eta=0:14:49\n",
      "2021-07-29 20:15:25 [INFO]\t[TRAIN] Epoch=25/32, Step=60/90, loss=0.009908, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.12s, eta=0:14:46\n",
      "2021-07-29 20:15:28 [INFO]\t[TRAIN] Epoch=25/32, Step=62/90, loss=0.163387, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.11s, eta=0:14:44\n",
      "2021-07-29 20:15:30 [INFO]\t[TRAIN] Epoch=25/32, Step=64/90, loss=0.014414, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:14:41\n",
      "2021-07-29 20:15:32 [INFO]\t[TRAIN] Epoch=25/32, Step=66/90, loss=0.008642, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:14:39\n",
      "2021-07-29 20:15:34 [INFO]\t[TRAIN] Epoch=25/32, Step=68/90, loss=0.00283, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:14:36\n",
      "2021-07-29 20:15:36 [INFO]\t[TRAIN] Epoch=25/32, Step=70/90, loss=1.702981, acc1=0.5, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:14:34\n",
      "2021-07-29 20:15:38 [INFO]\t[TRAIN] Epoch=25/32, Step=72/90, loss=0.058232, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:14:32\n",
      "2021-07-29 20:15:40 [INFO]\t[TRAIN] Epoch=25/32, Step=74/90, loss=0.003631, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:14:30\n",
      "2021-07-29 20:15:43 [INFO]\t[TRAIN] Epoch=25/32, Step=76/90, loss=0.445967, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:14:28\n",
      "2021-07-29 20:15:45 [INFO]\t[TRAIN] Epoch=25/32, Step=78/90, loss=0.000429, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:14:26\n",
      "2021-07-29 20:15:47 [INFO]\t[TRAIN] Epoch=25/32, Step=80/90, loss=0.001187, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:14:23\n",
      "2021-07-29 20:15:49 [INFO]\t[TRAIN] Epoch=25/32, Step=82/90, loss=0.034626, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:14:21\n",
      "2021-07-29 20:15:51 [INFO]\t[TRAIN] Epoch=25/32, Step=84/90, loss=0.020982, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:14:19\n",
      "2021-07-29 20:15:53 [INFO]\t[TRAIN] Epoch=25/32, Step=86/90, loss=0.048578, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:14:17\n",
      "2021-07-29 20:15:55 [INFO]\t[TRAIN] Epoch=25/32, Step=88/90, loss=0.015439, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:14:15\n",
      "2021-07-29 20:15:56 [INFO]\t[TRAIN] Epoch=25/32, Step=90/90, loss=0.00049, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:14:13\n",
      "2021-07-29 20:15:57 [INFO]\t[TRAIN] Epoch 25 finished, loss=0.061019, acc1=0.979167, acc2=1.0, lr=2.5e-05 .\n",
      "2021-07-29 20:15:57 [INFO]\tStart to evaluating(total_samples=80, total_steps=10)...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 10/10 [00:17<00:00,  1.75s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2021-07-29 20:16:14 [INFO]\t[EVAL] Finished, Epoch=25, acc1=0.9875, acc2=1.0 .\n",
      "2021-07-29 20:16:14 [INFO]\tModel saved in output/mobilenetv3_small_ssld/epoch_25.\n",
      "2021-07-29 20:16:14 [INFO]\tCurrent evaluated best model in eval_dataset is epoch_5, acc1=0.9875\n",
      "2021-07-29 20:16:21 [INFO]\t[TRAIN] Epoch=26/32, Step=2/90, loss=0.04697, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.27s, eta=0:14:11\n",
      "2021-07-29 20:16:24 [INFO]\t[TRAIN] Epoch=26/32, Step=4/90, loss=0.010111, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.28s, eta=0:14:9\n",
      "2021-07-29 20:16:26 [INFO]\t[TRAIN] Epoch=26/32, Step=6/90, loss=0.090239, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.28s, eta=0:14:6\n",
      "2021-07-29 20:16:28 [INFO]\t[TRAIN] Epoch=26/32, Step=8/90, loss=0.058145, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.28s, eta=0:14:4\n",
      "2021-07-29 20:16:30 [INFO]\t[TRAIN] Epoch=26/32, Step=10/90, loss=0.017054, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.28s, eta=0:14:1\n",
      "2021-07-29 20:16:32 [INFO]\t[TRAIN] Epoch=26/32, Step=12/90, loss=0.004827, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.28s, eta=0:13:59\n",
      "2021-07-29 20:16:35 [INFO]\t[TRAIN] Epoch=26/32, Step=14/90, loss=0.00171, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.28s, eta=0:13:56\n",
      "2021-07-29 20:16:37 [INFO]\t[TRAIN] Epoch=26/32, Step=16/90, loss=0.153101, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.28s, eta=0:13:53\n",
      "2021-07-29 20:16:39 [INFO]\t[TRAIN] Epoch=26/32, Step=18/90, loss=0.040339, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.31s, eta=0:13:53\n",
      "2021-07-29 20:16:41 [INFO]\t[TRAIN] Epoch=26/32, Step=20/90, loss=0.011561, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.33s, eta=0:13:52\n",
      "2021-07-29 20:16:43 [INFO]\t[TRAIN] Epoch=26/32, Step=22/90, loss=0.002873, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:13:32\n",
      "2021-07-29 20:16:45 [INFO]\t[TRAIN] Epoch=26/32, Step=24/90, loss=0.302839, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:13:29\n",
      "2021-07-29 20:16:47 [INFO]\t[TRAIN] Epoch=26/32, Step=26/90, loss=0.005151, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:13:26\n",
      "2021-07-29 20:16:49 [INFO]\t[TRAIN] Epoch=26/32, Step=28/90, loss=0.020557, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:13:24\n",
      "2021-07-29 20:16:51 [INFO]\t[TRAIN] Epoch=26/32, Step=30/90, loss=0.239511, acc1=0.75, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:13:22\n",
      "2021-07-29 20:16:53 [INFO]\t[TRAIN] Epoch=26/32, Step=32/90, loss=0.008361, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:13:19\n",
      "2021-07-29 20:16:55 [INFO]\t[TRAIN] Epoch=26/32, Step=34/90, loss=0.424785, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:13:17\n",
      "2021-07-29 20:16:57 [INFO]\t[TRAIN] Epoch=26/32, Step=36/90, loss=0.036861, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:13:14\n",
      "2021-07-29 20:16:59 [INFO]\t[TRAIN] Epoch=26/32, Step=38/90, loss=0.002802, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:13:12\n",
      "2021-07-29 20:17:01 [INFO]\t[TRAIN] Epoch=26/32, Step=40/90, loss=0.001557, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:13:9\n",
      "2021-07-29 20:17:03 [INFO]\t[TRAIN] Epoch=26/32, Step=42/90, loss=0.006464, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:13:8\n",
      "2021-07-29 20:17:06 [INFO]\t[TRAIN] Epoch=26/32, Step=44/90, loss=0.01489, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:13:6\n",
      "2021-07-29 20:17:08 [INFO]\t[TRAIN] Epoch=26/32, Step=46/90, loss=0.011803, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:13:4\n",
      "2021-07-29 20:17:10 [INFO]\t[TRAIN] Epoch=26/32, Step=48/90, loss=0.000706, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:13:2\n",
      "2021-07-29 20:17:12 [INFO]\t[TRAIN] Epoch=26/32, Step=50/90, loss=0.146061, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:13:0\n",
      "2021-07-29 20:17:14 [INFO]\t[TRAIN] Epoch=26/32, Step=52/90, loss=0.078589, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:12:58\n",
      "2021-07-29 20:17:16 [INFO]\t[TRAIN] Epoch=26/32, Step=54/90, loss=0.002137, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:12:56\n",
      "2021-07-29 20:17:18 [INFO]\t[TRAIN] Epoch=26/32, Step=56/90, loss=0.002561, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:12:54\n",
      "2021-07-29 20:17:20 [INFO]\t[TRAIN] Epoch=26/32, Step=58/90, loss=0.059906, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:12:52\n",
      "2021-07-29 20:17:22 [INFO]\t[TRAIN] Epoch=26/32, Step=60/90, loss=0.056803, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:12:50\n",
      "2021-07-29 20:17:24 [INFO]\t[TRAIN] Epoch=26/32, Step=62/90, loss=0.009468, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:12:48\n",
      "2021-07-29 20:17:27 [INFO]\t[TRAIN] Epoch=26/32, Step=64/90, loss=0.470727, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:12:46\n",
      "2021-07-29 20:17:29 [INFO]\t[TRAIN] Epoch=26/32, Step=66/90, loss=0.016705, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:12:44\n",
      "2021-07-29 20:17:32 [INFO]\t[TRAIN] Epoch=26/32, Step=68/90, loss=0.00446, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:12:43\n",
      "2021-07-29 20:17:34 [INFO]\t[TRAIN] Epoch=26/32, Step=70/90, loss=0.012788, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:12:40\n",
      "2021-07-29 20:17:36 [INFO]\t[TRAIN] Epoch=26/32, Step=72/90, loss=0.006353, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:12:39\n",
      "2021-07-29 20:17:38 [INFO]\t[TRAIN] Epoch=26/32, Step=74/90, loss=0.005426, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:12:36\n",
      "2021-07-29 20:17:40 [INFO]\t[TRAIN] Epoch=26/32, Step=76/90, loss=0.003575, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.11s, eta=0:12:34\n",
      "2021-07-29 20:17:42 [INFO]\t[TRAIN] Epoch=26/32, Step=78/90, loss=0.000352, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.12s, eta=0:12:32\n",
      "2021-07-29 20:17:45 [INFO]\t[TRAIN] Epoch=26/32, Step=80/90, loss=0.001403, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.11s, eta=0:12:30\n",
      "2021-07-29 20:17:47 [INFO]\t[TRAIN] Epoch=26/32, Step=82/90, loss=0.000825, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.11s, eta=0:12:28\n",
      "2021-07-29 20:17:49 [INFO]\t[TRAIN] Epoch=26/32, Step=84/90, loss=0.024827, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:12:25\n",
      "2021-07-29 20:17:51 [INFO]\t[TRAIN] Epoch=26/32, Step=86/90, loss=0.004827, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:12:23\n",
      "2021-07-29 20:17:53 [INFO]\t[TRAIN] Epoch=26/32, Step=88/90, loss=0.001157, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:12:21\n",
      "2021-07-29 20:17:54 [INFO]\t[TRAIN] Epoch=26/32, Step=90/90, loss=0.430098, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:12:19\n",
      "2021-07-29 20:17:54 [INFO]\t[TRAIN] Epoch 26 finished, loss=0.049753, acc1=0.981944, acc2=1.0, lr=2.5e-05 .\n",
      "2021-07-29 20:17:54 [INFO]\tStart to evaluating(total_samples=80, total_steps=10)...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 10/10 [00:17<00:00,  1.79s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2021-07-29 20:18:12 [INFO]\t[EVAL] Finished, Epoch=26, acc1=0.975, acc2=1.0 .\n",
      "2021-07-29 20:18:12 [INFO]\tModel saved in output/mobilenetv3_small_ssld/epoch_26.\n",
      "2021-07-29 20:18:12 [INFO]\tCurrent evaluated best model in eval_dataset is epoch_5, acc1=0.9875\n",
      "2021-07-29 20:18:20 [INFO]\t[TRAIN] Epoch=27/32, Step=2/90, loss=0.101389, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.28s, eta=0:12:1\n",
      "2021-07-29 20:18:22 [INFO]\t[TRAIN] Epoch=27/32, Step=4/90, loss=0.011449, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.29s, eta=0:11:59\n",
      "2021-07-29 20:18:24 [INFO]\t[TRAIN] Epoch=27/32, Step=6/90, loss=0.013351, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.28s, eta=0:11:56\n",
      "2021-07-29 20:18:26 [INFO]\t[TRAIN] Epoch=27/32, Step=8/90, loss=0.102225, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.28s, eta=0:11:53\n",
      "2021-07-29 20:18:28 [INFO]\t[TRAIN] Epoch=27/32, Step=10/90, loss=0.067631, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.28s, eta=0:11:51\n",
      "2021-07-29 20:18:30 [INFO]\t[TRAIN] Epoch=27/32, Step=12/90, loss=0.000945, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.28s, eta=0:11:48\n",
      "2021-07-29 20:18:33 [INFO]\t[TRAIN] Epoch=27/32, Step=14/90, loss=0.001393, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.29s, eta=0:11:47\n",
      "2021-07-29 20:18:35 [INFO]\t[TRAIN] Epoch=27/32, Step=16/90, loss=0.053746, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.29s, eta=0:11:44\n",
      "2021-07-29 20:18:37 [INFO]\t[TRAIN] Epoch=27/32, Step=18/90, loss=0.025668, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.3s, eta=0:11:42\n",
      "2021-07-29 20:18:39 [INFO]\t[TRAIN] Epoch=27/32, Step=20/90, loss=0.002402, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.33s, eta=0:11:42\n",
      "2021-07-29 20:18:41 [INFO]\t[TRAIN] Epoch=27/32, Step=22/90, loss=0.001975, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:11:22\n",
      "2021-07-29 20:18:44 [INFO]\t[TRAIN] Epoch=27/32, Step=24/90, loss=0.005177, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:11:21\n",
      "2021-07-29 20:18:46 [INFO]\t[TRAIN] Epoch=27/32, Step=26/90, loss=0.016687, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.12s, eta=0:11:20\n",
      "2021-07-29 20:18:49 [INFO]\t[TRAIN] Epoch=27/32, Step=28/90, loss=0.002772, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.13s, eta=0:11:18\n",
      "2021-07-29 20:18:51 [INFO]\t[TRAIN] Epoch=27/32, Step=30/90, loss=0.027917, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.14s, eta=0:11:17\n",
      "2021-07-29 20:18:53 [INFO]\t[TRAIN] Epoch=27/32, Step=32/90, loss=0.027264, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.15s, eta=0:11:15\n",
      "2021-07-29 20:18:56 [INFO]\t[TRAIN] Epoch=27/32, Step=34/90, loss=0.01051, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.14s, eta=0:11:12\n",
      "2021-07-29 20:18:58 [INFO]\t[TRAIN] Epoch=27/32, Step=36/90, loss=0.11693, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.14s, eta=0:11:10\n",
      "2021-07-29 20:19:00 [INFO]\t[TRAIN] Epoch=27/32, Step=38/90, loss=0.027424, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.15s, eta=0:11:8\n",
      "2021-07-29 20:19:02 [INFO]\t[TRAIN] Epoch=27/32, Step=40/90, loss=0.292373, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.14s, eta=0:11:6\n",
      "2021-07-29 20:19:04 [INFO]\t[TRAIN] Epoch=27/32, Step=42/90, loss=0.014516, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.15s, eta=0:11:4\n",
      "2021-07-29 20:19:06 [INFO]\t[TRAIN] Epoch=27/32, Step=44/90, loss=0.027346, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.12s, eta=0:11:0\n",
      "2021-07-29 20:19:08 [INFO]\t[TRAIN] Epoch=27/32, Step=46/90, loss=0.025067, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:10:56\n",
      "2021-07-29 20:19:10 [INFO]\t[TRAIN] Epoch=27/32, Step=48/90, loss=0.035599, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:10:54\n",
      "2021-07-29 20:19:12 [INFO]\t[TRAIN] Epoch=27/32, Step=50/90, loss=0.010026, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:10:51\n",
      "2021-07-29 20:19:15 [INFO]\t[TRAIN] Epoch=27/32, Step=52/90, loss=0.003751, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:10:49\n",
      "2021-07-29 20:19:17 [INFO]\t[TRAIN] Epoch=27/32, Step=54/90, loss=0.048847, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:10:47\n",
      "2021-07-29 20:19:19 [INFO]\t[TRAIN] Epoch=27/32, Step=56/90, loss=0.112811, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:10:44\n",
      "2021-07-29 20:19:21 [INFO]\t[TRAIN] Epoch=27/32, Step=58/90, loss=0.040778, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:10:42\n",
      "2021-07-29 20:19:23 [INFO]\t[TRAIN] Epoch=27/32, Step=60/90, loss=0.00156, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:10:40\n",
      "2021-07-29 20:19:26 [INFO]\t[TRAIN] Epoch=27/32, Step=62/90, loss=0.008436, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:10:38\n",
      "2021-07-29 20:19:28 [INFO]\t[TRAIN] Epoch=27/32, Step=64/90, loss=0.022804, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:10:36\n",
      "2021-07-29 20:19:30 [INFO]\t[TRAIN] Epoch=27/32, Step=66/90, loss=0.022927, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:10:34\n",
      "2021-07-29 20:19:32 [INFO]\t[TRAIN] Epoch=27/32, Step=68/90, loss=0.003853, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:10:32\n",
      "2021-07-29 20:19:34 [INFO]\t[TRAIN] Epoch=27/32, Step=70/90, loss=0.001141, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:10:30\n",
      "2021-07-29 20:19:36 [INFO]\t[TRAIN] Epoch=27/32, Step=72/90, loss=0.000546, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:10:28\n",
      "2021-07-29 20:19:38 [INFO]\t[TRAIN] Epoch=27/32, Step=74/90, loss=0.017811, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:10:26\n",
      "2021-07-29 20:19:41 [INFO]\t[TRAIN] Epoch=27/32, Step=76/90, loss=0.074723, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:10:24\n",
      "2021-07-29 20:19:43 [INFO]\t[TRAIN] Epoch=27/32, Step=78/90, loss=0.011684, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:10:21\n",
      "2021-07-29 20:19:45 [INFO]\t[TRAIN] Epoch=27/32, Step=80/90, loss=0.015163, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:10:19\n",
      "2021-07-29 20:19:47 [INFO]\t[TRAIN] Epoch=27/32, Step=82/90, loss=0.00295, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:10:17\n",
      "2021-07-29 20:19:49 [INFO]\t[TRAIN] Epoch=27/32, Step=84/90, loss=0.057012, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:10:15\n",
      "2021-07-29 20:19:51 [INFO]\t[TRAIN] Epoch=27/32, Step=86/90, loss=0.228568, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:10:13\n",
      "2021-07-29 20:19:53 [INFO]\t[TRAIN] Epoch=27/32, Step=88/90, loss=0.062215, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:10:11\n",
      "2021-07-29 20:19:55 [INFO]\t[TRAIN] Epoch=27/32, Step=90/90, loss=0.021074, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:10:8\n",
      "2021-07-29 20:19:55 [INFO]\t[TRAIN] Epoch 27 finished, loss=0.03633, acc1=0.9875, acc2=1.0, lr=2.5e-05 .\n",
      "2021-07-29 20:19:55 [INFO]\tStart to evaluating(total_samples=80, total_steps=10)...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 10/10 [00:18<00:00,  1.90s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2021-07-29 20:20:14 [INFO]\t[EVAL] Finished, Epoch=27, acc1=0.9875, acc2=1.0 .\n",
      "2021-07-29 20:20:14 [INFO]\tModel saved in output/mobilenetv3_small_ssld/epoch_27.\n",
      "2021-07-29 20:20:14 [INFO]\tCurrent evaluated best model in eval_dataset is epoch_5, acc1=0.9875\n",
      "2021-07-29 20:20:21 [INFO]\t[TRAIN] Epoch=28/32, Step=2/90, loss=0.001644, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.27s, eta=0:10:17\n",
      "2021-07-29 20:20:23 [INFO]\t[TRAIN] Epoch=28/32, Step=4/90, loss=0.006257, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.28s, eta=0:10:16\n",
      "2021-07-29 20:20:26 [INFO]\t[TRAIN] Epoch=28/32, Step=6/90, loss=0.009116, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.29s, eta=0:10:14\n",
      "2021-07-29 20:20:28 [INFO]\t[TRAIN] Epoch=28/32, Step=8/90, loss=0.00908, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.29s, eta=0:10:11\n",
      "2021-07-29 20:20:30 [INFO]\t[TRAIN] Epoch=28/32, Step=10/90, loss=0.012764, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.29s, eta=0:10:9\n",
      "2021-07-29 20:20:32 [INFO]\t[TRAIN] Epoch=28/32, Step=12/90, loss=0.326881, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.29s, eta=0:10:6\n",
      "2021-07-29 20:20:34 [INFO]\t[TRAIN] Epoch=28/32, Step=14/90, loss=0.00103, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.28s, eta=0:10:3\n",
      "2021-07-29 20:20:36 [INFO]\t[TRAIN] Epoch=28/32, Step=16/90, loss=0.002638, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.28s, eta=0:10:0\n",
      "2021-07-29 20:20:38 [INFO]\t[TRAIN] Epoch=28/32, Step=18/90, loss=0.050797, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.28s, eta=0:9:57\n",
      "2021-07-29 20:20:40 [INFO]\t[TRAIN] Epoch=28/32, Step=20/90, loss=0.185866, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.3s, eta=0:9:56\n",
      "2021-07-29 20:20:42 [INFO]\t[TRAIN] Epoch=28/32, Step=22/90, loss=0.025071, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:9:37\n",
      "2021-07-29 20:20:44 [INFO]\t[TRAIN] Epoch=28/32, Step=24/90, loss=0.024466, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:9:33\n",
      "2021-07-29 20:20:46 [INFO]\t[TRAIN] Epoch=28/32, Step=26/90, loss=0.007217, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:9:31\n",
      "2021-07-29 20:20:48 [INFO]\t[TRAIN] Epoch=28/32, Step=28/90, loss=0.009805, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:9:28\n",
      "2021-07-29 20:20:50 [INFO]\t[TRAIN] Epoch=28/32, Step=30/90, loss=0.09292, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:9:27\n",
      "2021-07-29 20:20:52 [INFO]\t[TRAIN] Epoch=28/32, Step=32/90, loss=1.860184, acc1=0.625, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:9:25\n",
      "2021-07-29 20:20:54 [INFO]\t[TRAIN] Epoch=28/32, Step=34/90, loss=0.13806, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:9:23\n",
      "2021-07-29 20:20:57 [INFO]\t[TRAIN] Epoch=28/32, Step=36/90, loss=0.1044, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:9:21\n",
      "2021-07-29 20:20:59 [INFO]\t[TRAIN] Epoch=28/32, Step=38/90, loss=0.03201, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:9:19\n",
      "2021-07-29 20:21:01 [INFO]\t[TRAIN] Epoch=28/32, Step=40/90, loss=0.144314, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:9:18\n",
      "2021-07-29 20:21:03 [INFO]\t[TRAIN] Epoch=28/32, Step=42/90, loss=0.023908, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:9:16\n",
      "2021-07-29 20:21:05 [INFO]\t[TRAIN] Epoch=28/32, Step=44/90, loss=0.001172, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:9:14\n",
      "2021-07-29 20:21:07 [INFO]\t[TRAIN] Epoch=28/32, Step=46/90, loss=0.00049, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:9:12\n",
      "2021-07-29 20:21:10 [INFO]\t[TRAIN] Epoch=28/32, Step=48/90, loss=0.001842, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:9:10\n",
      "2021-07-29 20:21:12 [INFO]\t[TRAIN] Epoch=28/32, Step=50/90, loss=0.057712, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:9:8\n",
      "2021-07-29 20:21:14 [INFO]\t[TRAIN] Epoch=28/32, Step=52/90, loss=0.001819, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:9:6\n",
      "2021-07-29 20:21:16 [INFO]\t[TRAIN] Epoch=28/32, Step=54/90, loss=0.001262, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:9:4\n",
      "2021-07-29 20:21:18 [INFO]\t[TRAIN] Epoch=28/32, Step=56/90, loss=0.062113, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:9:2\n",
      "2021-07-29 20:21:20 [INFO]\t[TRAIN] Epoch=28/32, Step=58/90, loss=0.002292, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:9:0\n",
      "2021-07-29 20:21:22 [INFO]\t[TRAIN] Epoch=28/32, Step=60/90, loss=0.000447, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:8:57\n",
      "2021-07-29 20:21:24 [INFO]\t[TRAIN] Epoch=28/32, Step=62/90, loss=0.002698, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:8:55\n",
      "2021-07-29 20:21:27 [INFO]\t[TRAIN] Epoch=28/32, Step=64/90, loss=0.005676, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:8:53\n",
      "2021-07-29 20:21:29 [INFO]\t[TRAIN] Epoch=28/32, Step=66/90, loss=0.038331, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:8:51\n",
      "2021-07-29 20:21:31 [INFO]\t[TRAIN] Epoch=28/32, Step=68/90, loss=0.045084, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:8:49\n",
      "2021-07-29 20:21:33 [INFO]\t[TRAIN] Epoch=28/32, Step=70/90, loss=0.046351, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:8:47\n",
      "2021-07-29 20:21:35 [INFO]\t[TRAIN] Epoch=28/32, Step=72/90, loss=0.010624, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:8:45\n",
      "2021-07-29 20:21:38 [INFO]\t[TRAIN] Epoch=28/32, Step=74/90, loss=0.007079, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:8:43\n",
      "2021-07-29 20:21:40 [INFO]\t[TRAIN] Epoch=28/32, Step=76/90, loss=0.007045, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:8:41\n",
      "2021-07-29 20:21:42 [INFO]\t[TRAIN] Epoch=28/32, Step=78/90, loss=0.02206, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.11s, eta=0:8:39\n",
      "2021-07-29 20:21:44 [INFO]\t[TRAIN] Epoch=28/32, Step=80/90, loss=0.011079, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:8:36\n",
      "2021-07-29 20:21:46 [INFO]\t[TRAIN] Epoch=28/32, Step=82/90, loss=0.023686, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.11s, eta=0:8:34\n",
      "2021-07-29 20:21:49 [INFO]\t[TRAIN] Epoch=28/32, Step=84/90, loss=0.012191, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.11s, eta=0:8:32\n",
      "2021-07-29 20:21:51 [INFO]\t[TRAIN] Epoch=28/32, Step=86/90, loss=0.004427, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.11s, eta=0:8:30\n",
      "2021-07-29 20:21:53 [INFO]\t[TRAIN] Epoch=28/32, Step=88/90, loss=0.015767, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:8:28\n",
      "2021-07-29 20:21:54 [INFO]\t[TRAIN] Epoch=28/32, Step=90/90, loss=0.025619, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:8:25\n",
      "2021-07-29 20:21:54 [INFO]\t[TRAIN] Epoch 28 finished, loss=0.063361, acc1=0.980556, acc2=1.0, lr=2.5e-05 .\n",
      "2021-07-29 20:21:54 [INFO]\tStart to evaluating(total_samples=80, total_steps=10)...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 10/10 [00:19<00:00,  1.99s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2021-07-29 20:22:14 [INFO]\t[EVAL] Finished, Epoch=28, acc1=0.975, acc2=1.0 .\n",
      "2021-07-29 20:22:14 [INFO]\tModel saved in output/mobilenetv3_small_ssld/epoch_28.\n",
      "2021-07-29 20:22:14 [INFO]\tCurrent evaluated best model in eval_dataset is epoch_5, acc1=0.9875\n",
      "2021-07-29 20:22:21 [INFO]\t[TRAIN] Epoch=29/32, Step=2/90, loss=0.006899, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.28s, eta=0:8:13\n",
      "2021-07-29 20:22:24 [INFO]\t[TRAIN] Epoch=29/32, Step=4/90, loss=0.004528, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.29s, eta=0:8:11\n",
      "2021-07-29 20:22:26 [INFO]\t[TRAIN] Epoch=29/32, Step=6/90, loss=0.025441, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.31s, eta=0:8:10\n",
      "2021-07-29 20:22:29 [INFO]\t[TRAIN] Epoch=29/32, Step=8/90, loss=0.062144, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.3s, eta=0:8:7\n",
      "2021-07-29 20:22:31 [INFO]\t[TRAIN] Epoch=29/32, Step=10/90, loss=0.003039, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.31s, eta=0:8:5\n",
      "2021-07-29 20:22:33 [INFO]\t[TRAIN] Epoch=29/32, Step=12/90, loss=0.017282, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.3s, eta=0:8:2\n",
      "2021-07-29 20:22:35 [INFO]\t[TRAIN] Epoch=29/32, Step=14/90, loss=0.002284, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.31s, eta=0:8:0\n",
      "2021-07-29 20:22:37 [INFO]\t[TRAIN] Epoch=29/32, Step=16/90, loss=0.010633, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.32s, eta=0:7:58\n",
      "2021-07-29 20:22:40 [INFO]\t[TRAIN] Epoch=29/32, Step=18/90, loss=0.018017, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.34s, eta=0:7:57\n",
      "2021-07-29 20:22:42 [INFO]\t[TRAIN] Epoch=29/32, Step=20/90, loss=0.007613, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.37s, eta=0:7:56\n",
      "2021-07-29 20:22:44 [INFO]\t[TRAIN] Epoch=29/32, Step=22/90, loss=0.001708, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.13s, eta=0:7:37\n",
      "2021-07-29 20:22:46 [INFO]\t[TRAIN] Epoch=29/32, Step=24/90, loss=0.021763, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.12s, eta=0:7:34\n",
      "2021-07-29 20:22:48 [INFO]\t[TRAIN] Epoch=29/32, Step=26/90, loss=0.051317, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.11s, eta=0:7:31\n",
      "2021-07-29 20:22:51 [INFO]\t[TRAIN] Epoch=29/32, Step=28/90, loss=0.053062, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:7:29\n",
      "2021-07-29 20:22:53 [INFO]\t[TRAIN] Epoch=29/32, Step=30/90, loss=0.001067, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.11s, eta=0:7:27\n",
      "2021-07-29 20:22:55 [INFO]\t[TRAIN] Epoch=29/32, Step=32/90, loss=0.001294, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.11s, eta=0:7:25\n",
      "2021-07-29 20:22:57 [INFO]\t[TRAIN] Epoch=29/32, Step=34/90, loss=0.007294, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.11s, eta=0:7:23\n",
      "2021-07-29 20:22:59 [INFO]\t[TRAIN] Epoch=29/32, Step=36/90, loss=0.007284, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:7:20\n",
      "2021-07-29 20:23:02 [INFO]\t[TRAIN] Epoch=29/32, Step=38/90, loss=0.025424, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.11s, eta=0:7:18\n",
      "2021-07-29 20:23:04 [INFO]\t[TRAIN] Epoch=29/32, Step=40/90, loss=0.002328, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:7:15\n",
      "2021-07-29 20:23:06 [INFO]\t[TRAIN] Epoch=29/32, Step=42/90, loss=0.9087, acc1=0.75, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:7:13\n",
      "2021-07-29 20:23:08 [INFO]\t[TRAIN] Epoch=29/32, Step=44/90, loss=0.007824, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:7:11\n",
      "2021-07-29 20:23:10 [INFO]\t[TRAIN] Epoch=29/32, Step=46/90, loss=0.029359, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:7:8\n",
      "2021-07-29 20:23:12 [INFO]\t[TRAIN] Epoch=29/32, Step=48/90, loss=0.000615, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:7:6\n",
      "2021-07-29 20:23:14 [INFO]\t[TRAIN] Epoch=29/32, Step=50/90, loss=0.052784, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:7:4\n",
      "2021-07-29 20:23:17 [INFO]\t[TRAIN] Epoch=29/32, Step=52/90, loss=0.082983, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:7:1\n",
      "2021-07-29 20:23:19 [INFO]\t[TRAIN] Epoch=29/32, Step=54/90, loss=0.051364, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:6:59\n",
      "2021-07-29 20:23:21 [INFO]\t[TRAIN] Epoch=29/32, Step=56/90, loss=0.043745, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:6:57\n",
      "2021-07-29 20:23:23 [INFO]\t[TRAIN] Epoch=29/32, Step=58/90, loss=0.000928, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:6:54\n",
      "2021-07-29 20:23:25 [INFO]\t[TRAIN] Epoch=29/32, Step=60/90, loss=0.048827, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:6:53\n",
      "2021-07-29 20:23:27 [INFO]\t[TRAIN] Epoch=29/32, Step=62/90, loss=0.005551, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:6:50\n",
      "2021-07-29 20:23:30 [INFO]\t[TRAIN] Epoch=29/32, Step=64/90, loss=0.014419, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:6:48\n",
      "2021-07-29 20:23:32 [INFO]\t[TRAIN] Epoch=29/32, Step=66/90, loss=0.01522, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:6:46\n",
      "2021-07-29 20:23:34 [INFO]\t[TRAIN] Epoch=29/32, Step=68/90, loss=0.009159, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:6:44\n",
      "2021-07-29 20:23:36 [INFO]\t[TRAIN] Epoch=29/32, Step=70/90, loss=0.01802, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:6:42\n",
      "2021-07-29 20:23:39 [INFO]\t[TRAIN] Epoch=29/32, Step=72/90, loss=0.018362, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:6:40\n",
      "2021-07-29 20:23:41 [INFO]\t[TRAIN] Epoch=29/32, Step=74/90, loss=0.014731, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:6:38\n",
      "2021-07-29 20:23:43 [INFO]\t[TRAIN] Epoch=29/32, Step=76/90, loss=0.14914, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.11s, eta=0:6:36\n",
      "2021-07-29 20:23:45 [INFO]\t[TRAIN] Epoch=29/32, Step=78/90, loss=0.00487, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.11s, eta=0:6:34\n",
      "2021-07-29 20:23:47 [INFO]\t[TRAIN] Epoch=29/32, Step=80/90, loss=0.001895, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:6:31\n",
      "2021-07-29 20:23:49 [INFO]\t[TRAIN] Epoch=29/32, Step=82/90, loss=0.038573, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.11s, eta=0:6:29\n",
      "2021-07-29 20:23:52 [INFO]\t[TRAIN] Epoch=29/32, Step=84/90, loss=0.006571, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:6:27\n",
      "2021-07-29 20:23:54 [INFO]\t[TRAIN] Epoch=29/32, Step=86/90, loss=0.002363, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.11s, eta=0:6:25\n",
      "2021-07-29 20:23:56 [INFO]\t[TRAIN] Epoch=29/32, Step=88/90, loss=0.03906, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:6:23\n",
      "2021-07-29 20:23:57 [INFO]\t[TRAIN] Epoch=29/32, Step=90/90, loss=0.008396, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:6:20\n",
      "2021-07-29 20:23:57 [INFO]\t[TRAIN] Epoch 29 finished, loss=0.03477, acc1=0.991667, acc2=1.0, lr=2.5e-05 .\n",
      "2021-07-29 20:23:57 [INFO]\tStart to evaluating(total_samples=80, total_steps=10)...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 10/10 [00:17<00:00,  1.79s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2021-07-29 20:24:15 [INFO]\t[EVAL] Finished, Epoch=29, acc1=0.9875, acc2=1.0 .\n",
      "2021-07-29 20:24:16 [INFO]\tModel saved in output/mobilenetv3_small_ssld/epoch_29.\n",
      "2021-07-29 20:24:16 [INFO]\tCurrent evaluated best model in eval_dataset is epoch_5, acc1=0.9875\n",
      "2021-07-29 20:24:22 [INFO]\t[TRAIN] Epoch=30/32, Step=2/90, loss=0.007749, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.28s, eta=0:6:13\n",
      "2021-07-29 20:24:25 [INFO]\t[TRAIN] Epoch=30/32, Step=4/90, loss=0.025283, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.29s, eta=0:6:11\n",
      "2021-07-29 20:24:27 [INFO]\t[TRAIN] Epoch=30/32, Step=6/90, loss=0.382572, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.28s, eta=0:6:7\n",
      "2021-07-29 20:24:29 [INFO]\t[TRAIN] Epoch=30/32, Step=8/90, loss=0.045546, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.27s, eta=0:6:4\n",
      "2021-07-29 20:24:31 [INFO]\t[TRAIN] Epoch=30/32, Step=10/90, loss=0.032082, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.25s, eta=0:6:1\n",
      "2021-07-29 20:24:33 [INFO]\t[TRAIN] Epoch=30/32, Step=12/90, loss=0.003536, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.25s, eta=0:5:58\n",
      "2021-07-29 20:24:35 [INFO]\t[TRAIN] Epoch=30/32, Step=14/90, loss=0.184329, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.24s, eta=0:5:55\n",
      "2021-07-29 20:24:37 [INFO]\t[TRAIN] Epoch=30/32, Step=16/90, loss=0.051836, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.24s, eta=0:5:52\n",
      "2021-07-29 20:24:39 [INFO]\t[TRAIN] Epoch=30/32, Step=18/90, loss=0.014549, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.24s, eta=0:5:50\n",
      "2021-07-29 20:24:41 [INFO]\t[TRAIN] Epoch=30/32, Step=20/90, loss=0.006051, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.27s, eta=0:5:49\n",
      "2021-07-29 20:24:43 [INFO]\t[TRAIN] Epoch=30/32, Step=22/90, loss=0.128257, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:5:31\n",
      "2021-07-29 20:24:45 [INFO]\t[TRAIN] Epoch=30/32, Step=24/90, loss=0.005622, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.03s, eta=0:5:28\n",
      "2021-07-29 20:24:48 [INFO]\t[TRAIN] Epoch=30/32, Step=26/90, loss=0.036896, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:5:27\n",
      "2021-07-29 20:24:50 [INFO]\t[TRAIN] Epoch=30/32, Step=28/90, loss=0.001429, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:5:26\n",
      "2021-07-29 20:24:52 [INFO]\t[TRAIN] Epoch=30/32, Step=30/90, loss=0.001742, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:5:26\n",
      "2021-07-29 20:24:55 [INFO]\t[TRAIN] Epoch=30/32, Step=32/90, loss=0.060435, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:5:24\n",
      "2021-07-29 20:24:57 [INFO]\t[TRAIN] Epoch=30/32, Step=34/90, loss=0.034833, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.11s, eta=0:5:22\n",
      "2021-07-29 20:24:59 [INFO]\t[TRAIN] Epoch=30/32, Step=36/90, loss=0.014277, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.12s, eta=0:5:21\n",
      "2021-07-29 20:25:01 [INFO]\t[TRAIN] Epoch=30/32, Step=38/90, loss=0.002977, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.12s, eta=0:5:18\n",
      "2021-07-29 20:25:04 [INFO]\t[TRAIN] Epoch=30/32, Step=40/90, loss=0.043397, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.13s, eta=0:5:16\n",
      "2021-07-29 20:25:06 [INFO]\t[TRAIN] Epoch=30/32, Step=42/90, loss=0.009904, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.13s, eta=0:5:14\n",
      "2021-07-29 20:25:08 [INFO]\t[TRAIN] Epoch=30/32, Step=44/90, loss=0.017648, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.13s, eta=0:5:12\n",
      "2021-07-29 20:25:10 [INFO]\t[TRAIN] Epoch=30/32, Step=46/90, loss=0.004972, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.12s, eta=0:5:9\n",
      "2021-07-29 20:25:12 [INFO]\t[TRAIN] Epoch=30/32, Step=48/90, loss=0.001561, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.11s, eta=0:5:7\n",
      "2021-07-29 20:25:14 [INFO]\t[TRAIN] Epoch=30/32, Step=50/90, loss=0.002335, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:5:4\n",
      "2021-07-29 20:25:17 [INFO]\t[TRAIN] Epoch=30/32, Step=52/90, loss=0.00263, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:5:2\n",
      "2021-07-29 20:25:19 [INFO]\t[TRAIN] Epoch=30/32, Step=54/90, loss=0.105021, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:4:59\n",
      "2021-07-29 20:25:21 [INFO]\t[TRAIN] Epoch=30/32, Step=56/90, loss=0.001736, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:4:57\n",
      "2021-07-29 20:25:23 [INFO]\t[TRAIN] Epoch=30/32, Step=58/90, loss=0.038285, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:4:55\n",
      "2021-07-29 20:25:25 [INFO]\t[TRAIN] Epoch=30/32, Step=60/90, loss=0.067403, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:4:53\n",
      "2021-07-29 20:25:27 [INFO]\t[TRAIN] Epoch=30/32, Step=62/90, loss=0.035733, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:4:50\n",
      "2021-07-29 20:25:29 [INFO]\t[TRAIN] Epoch=30/32, Step=64/90, loss=0.029849, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:4:48\n",
      "2021-07-29 20:25:32 [INFO]\t[TRAIN] Epoch=30/32, Step=66/90, loss=0.001378, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:4:46\n",
      "2021-07-29 20:25:34 [INFO]\t[TRAIN] Epoch=30/32, Step=68/90, loss=0.039416, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:4:44\n",
      "2021-07-29 20:25:36 [INFO]\t[TRAIN] Epoch=30/32, Step=70/90, loss=0.182937, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:4:42\n",
      "2021-07-29 20:25:38 [INFO]\t[TRAIN] Epoch=30/32, Step=72/90, loss=0.490355, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:4:40\n",
      "2021-07-29 20:25:40 [INFO]\t[TRAIN] Epoch=30/32, Step=74/90, loss=0.014935, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:4:37\n",
      "2021-07-29 20:25:43 [INFO]\t[TRAIN] Epoch=30/32, Step=76/90, loss=0.009772, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:4:35\n",
      "2021-07-29 20:25:45 [INFO]\t[TRAIN] Epoch=30/32, Step=78/90, loss=0.002038, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:4:33\n",
      "2021-07-29 20:25:47 [INFO]\t[TRAIN] Epoch=30/32, Step=80/90, loss=0.005816, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:4:31\n",
      "2021-07-29 20:25:49 [INFO]\t[TRAIN] Epoch=30/32, Step=82/90, loss=0.009088, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:4:29\n",
      "2021-07-29 20:25:51 [INFO]\t[TRAIN] Epoch=30/32, Step=84/90, loss=0.001825, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:4:27\n",
      "2021-07-29 20:25:53 [INFO]\t[TRAIN] Epoch=30/32, Step=86/90, loss=0.006519, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:4:24\n",
      "2021-07-29 20:25:55 [INFO]\t[TRAIN] Epoch=30/32, Step=88/90, loss=0.094452, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:4:22\n",
      "2021-07-29 20:25:56 [INFO]\t[TRAIN] Epoch=30/32, Step=90/90, loss=0.00653, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:4:20\n",
      "2021-07-29 20:25:56 [INFO]\t[TRAIN] Epoch 30 finished, loss=0.043822, acc1=0.984722, acc2=1.0, lr=2.5e-05 .\n",
      "2021-07-29 20:25:56 [INFO]\tStart to evaluating(total_samples=80, total_steps=10)...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 10/10 [00:18<00:00,  1.87s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2021-07-29 20:26:15 [INFO]\t[EVAL] Finished, Epoch=30, acc1=0.975, acc2=1.0 .\n",
      "2021-07-29 20:26:15 [INFO]\tModel saved in output/mobilenetv3_small_ssld/epoch_30.\n",
      "2021-07-29 20:26:15 [INFO]\tCurrent evaluated best model in eval_dataset is epoch_5, acc1=0.9875\n",
      "2021-07-29 20:26:22 [INFO]\t[TRAIN] Epoch=31/32, Step=2/90, loss=0.001274, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.26s, eta=0:4:9\n",
      "2021-07-29 20:26:25 [INFO]\t[TRAIN] Epoch=31/32, Step=4/90, loss=0.01057, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.27s, eta=0:4:8\n",
      "2021-07-29 20:26:27 [INFO]\t[TRAIN] Epoch=31/32, Step=6/90, loss=0.012244, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.27s, eta=0:4:5\n",
      "2021-07-29 20:26:29 [INFO]\t[TRAIN] Epoch=31/32, Step=8/90, loss=0.01303, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.26s, eta=0:4:2\n",
      "2021-07-29 20:26:31 [INFO]\t[TRAIN] Epoch=31/32, Step=10/90, loss=0.008549, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.26s, eta=0:3:59\n",
      "2021-07-29 20:26:33 [INFO]\t[TRAIN] Epoch=31/32, Step=12/90, loss=0.00636, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.27s, eta=0:3:57\n",
      "2021-07-29 20:26:35 [INFO]\t[TRAIN] Epoch=31/32, Step=14/90, loss=0.002387, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.27s, eta=0:3:55\n",
      "2021-07-29 20:26:37 [INFO]\t[TRAIN] Epoch=31/32, Step=16/90, loss=0.002311, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.26s, eta=0:3:52\n",
      "2021-07-29 20:26:40 [INFO]\t[TRAIN] Epoch=31/32, Step=18/90, loss=0.001588, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.28s, eta=0:3:50\n",
      "2021-07-29 20:26:42 [INFO]\t[TRAIN] Epoch=31/32, Step=20/90, loss=0.000962, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.32s, eta=0:3:51\n",
      "2021-07-29 20:26:44 [INFO]\t[TRAIN] Epoch=31/32, Step=22/90, loss=0.000904, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:3:32\n",
      "2021-07-29 20:26:46 [INFO]\t[TRAIN] Epoch=31/32, Step=24/90, loss=0.009477, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:3:30\n",
      "2021-07-29 20:26:48 [INFO]\t[TRAIN] Epoch=31/32, Step=26/90, loss=0.02065, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:3:27\n",
      "2021-07-29 20:26:51 [INFO]\t[TRAIN] Epoch=31/32, Step=28/90, loss=0.006587, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:3:26\n",
      "2021-07-29 20:26:53 [INFO]\t[TRAIN] Epoch=31/32, Step=30/90, loss=0.002677, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:3:24\n",
      "2021-07-29 20:26:55 [INFO]\t[TRAIN] Epoch=31/32, Step=32/90, loss=0.010241, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:3:22\n",
      "2021-07-29 20:26:57 [INFO]\t[TRAIN] Epoch=31/32, Step=34/90, loss=0.199822, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:3:20\n",
      "2021-07-29 20:27:00 [INFO]\t[TRAIN] Epoch=31/32, Step=36/90, loss=0.121324, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.11s, eta=0:3:18\n",
      "2021-07-29 20:27:02 [INFO]\t[TRAIN] Epoch=31/32, Step=38/90, loss=0.035411, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.11s, eta=0:3:16\n",
      "2021-07-29 20:27:04 [INFO]\t[TRAIN] Epoch=31/32, Step=40/90, loss=0.025519, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:3:13\n",
      "2021-07-29 20:27:06 [INFO]\t[TRAIN] Epoch=31/32, Step=42/90, loss=0.018868, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:3:11\n",
      "2021-07-29 20:27:09 [INFO]\t[TRAIN] Epoch=31/32, Step=44/90, loss=0.123749, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.12s, eta=0:3:10\n",
      "2021-07-29 20:27:11 [INFO]\t[TRAIN] Epoch=31/32, Step=46/90, loss=0.001453, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.13s, eta=0:3:8\n",
      "2021-07-29 20:27:13 [INFO]\t[TRAIN] Epoch=31/32, Step=48/90, loss=0.002232, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.14s, eta=0:3:6\n",
      "2021-07-29 20:27:16 [INFO]\t[TRAIN] Epoch=31/32, Step=50/90, loss=0.039053, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.14s, eta=0:3:4\n",
      "2021-07-29 20:27:18 [INFO]\t[TRAIN] Epoch=31/32, Step=52/90, loss=0.016027, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.14s, eta=0:3:1\n",
      "2021-07-29 20:27:20 [INFO]\t[TRAIN] Epoch=31/32, Step=54/90, loss=0.083211, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.14s, eta=0:2:59\n",
      "2021-07-29 20:27:22 [INFO]\t[TRAIN] Epoch=31/32, Step=56/90, loss=0.033278, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.13s, eta=0:2:57\n",
      "2021-07-29 20:27:24 [INFO]\t[TRAIN] Epoch=31/32, Step=58/90, loss=0.000937, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.13s, eta=0:2:55\n",
      "2021-07-29 20:27:27 [INFO]\t[TRAIN] Epoch=31/32, Step=60/90, loss=0.000959, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.14s, eta=0:2:53\n",
      "2021-07-29 20:27:29 [INFO]\t[TRAIN] Epoch=31/32, Step=62/90, loss=0.00532, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.12s, eta=0:2:50\n",
      "2021-07-29 20:27:31 [INFO]\t[TRAIN] Epoch=31/32, Step=64/90, loss=0.027118, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:2:47\n",
      "2021-07-29 20:27:33 [INFO]\t[TRAIN] Epoch=31/32, Step=66/90, loss=0.12047, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:2:45\n",
      "2021-07-29 20:27:35 [INFO]\t[TRAIN] Epoch=31/32, Step=68/90, loss=0.314567, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:2:42\n",
      "2021-07-29 20:27:37 [INFO]\t[TRAIN] Epoch=31/32, Step=70/90, loss=0.020397, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:2:40\n",
      "2021-07-29 20:27:39 [INFO]\t[TRAIN] Epoch=31/32, Step=72/90, loss=0.135622, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:2:38\n",
      "2021-07-29 20:27:42 [INFO]\t[TRAIN] Epoch=31/32, Step=74/90, loss=0.109401, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:2:36\n",
      "2021-07-29 20:27:44 [INFO]\t[TRAIN] Epoch=31/32, Step=76/90, loss=0.024655, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:2:34\n",
      "2021-07-29 20:27:46 [INFO]\t[TRAIN] Epoch=31/32, Step=78/90, loss=0.034233, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:2:31\n",
      "2021-07-29 20:27:48 [INFO]\t[TRAIN] Epoch=31/32, Step=80/90, loss=0.001798, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:2:29\n",
      "2021-07-29 20:27:50 [INFO]\t[TRAIN] Epoch=31/32, Step=82/90, loss=0.002241, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:2:27\n",
      "2021-07-29 20:27:52 [INFO]\t[TRAIN] Epoch=31/32, Step=84/90, loss=0.011679, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:2:25\n",
      "2021-07-29 20:27:55 [INFO]\t[TRAIN] Epoch=31/32, Step=86/90, loss=0.012394, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:2:23\n",
      "2021-07-29 20:27:56 [INFO]\t[TRAIN] Epoch=31/32, Step=88/90, loss=0.000228, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:2:20\n",
      "2021-07-29 20:27:58 [INFO]\t[TRAIN] Epoch=31/32, Step=90/90, loss=0.045685, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.02s, eta=0:2:18\n",
      "2021-07-29 20:27:58 [INFO]\t[TRAIN] Epoch 31 finished, loss=0.035302, acc1=0.983333, acc2=1.0, lr=2.5e-05 .\n",
      "2021-07-29 20:27:58 [INFO]\tStart to evaluating(total_samples=80, total_steps=10)...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 10/10 [00:16<00:00,  1.69s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2021-07-29 20:28:15 [INFO]\t[EVAL] Finished, Epoch=31, acc1=0.975, acc2=1.0 .\n",
      "2021-07-29 20:28:16 [INFO]\tModel saved in output/mobilenetv3_small_ssld/epoch_31.\n",
      "2021-07-29 20:28:16 [INFO]\tCurrent evaluated best model in eval_dataset is epoch_5, acc1=0.9875\n",
      "2021-07-29 20:28:23 [INFO]\t[TRAIN] Epoch=32/32, Step=2/90, loss=0.013563, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.3s, eta=0:2:12\n",
      "2021-07-29 20:28:26 [INFO]\t[TRAIN] Epoch=32/32, Step=4/90, loss=0.002666, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.33s, eta=0:2:11\n",
      "2021-07-29 20:28:28 [INFO]\t[TRAIN] Epoch=32/32, Step=6/90, loss=0.008228, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.32s, eta=0:2:8\n",
      "2021-07-29 20:28:30 [INFO]\t[TRAIN] Epoch=32/32, Step=8/90, loss=0.002802, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.32s, eta=0:2:5\n",
      "2021-07-29 20:28:32 [INFO]\t[TRAIN] Epoch=32/32, Step=10/90, loss=0.011376, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.33s, eta=0:2:4\n",
      "2021-07-29 20:28:34 [INFO]\t[TRAIN] Epoch=32/32, Step=12/90, loss=0.008316, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.32s, eta=0:2:0\n",
      "2021-07-29 20:28:37 [INFO]\t[TRAIN] Epoch=32/32, Step=14/90, loss=0.002233, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.32s, eta=0:1:57\n",
      "2021-07-29 20:28:39 [INFO]\t[TRAIN] Epoch=32/32, Step=16/90, loss=0.001102, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.32s, eta=0:1:55\n",
      "2021-07-29 20:28:41 [INFO]\t[TRAIN] Epoch=32/32, Step=18/90, loss=0.015689, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.35s, eta=0:1:54\n",
      "2021-07-29 20:28:43 [INFO]\t[TRAIN] Epoch=32/32, Step=20/90, loss=0.012853, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.37s, eta=0:1:53\n",
      "2021-07-29 20:28:45 [INFO]\t[TRAIN] Epoch=32/32, Step=22/90, loss=0.021103, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:1:31\n",
      "2021-07-29 20:28:47 [INFO]\t[TRAIN] Epoch=32/32, Step=24/90, loss=0.01185, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:1:28\n",
      "2021-07-29 20:28:49 [INFO]\t[TRAIN] Epoch=32/32, Step=26/90, loss=0.00503, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:1:26\n",
      "2021-07-29 20:28:52 [INFO]\t[TRAIN] Epoch=32/32, Step=28/90, loss=0.005425, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:1:24\n",
      "2021-07-29 20:28:54 [INFO]\t[TRAIN] Epoch=32/32, Step=30/90, loss=0.036143, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:1:21\n",
      "2021-07-29 20:28:56 [INFO]\t[TRAIN] Epoch=32/32, Step=32/90, loss=0.003165, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:1:19\n",
      "2021-07-29 20:28:58 [INFO]\t[TRAIN] Epoch=32/32, Step=34/90, loss=0.037871, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:1:18\n",
      "2021-07-29 20:29:00 [INFO]\t[TRAIN] Epoch=32/32, Step=36/90, loss=0.04932, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:1:16\n",
      "2021-07-29 20:29:02 [INFO]\t[TRAIN] Epoch=32/32, Step=38/90, loss=0.049251, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:1:13\n",
      "2021-07-29 20:29:04 [INFO]\t[TRAIN] Epoch=32/32, Step=40/90, loss=0.008235, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:1:11\n",
      "2021-07-29 20:29:06 [INFO]\t[TRAIN] Epoch=32/32, Step=42/90, loss=0.017213, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:1:9\n",
      "2021-07-29 20:29:09 [INFO]\t[TRAIN] Epoch=32/32, Step=44/90, loss=0.004726, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:1:6\n",
      "2021-07-29 20:29:11 [INFO]\t[TRAIN] Epoch=32/32, Step=46/90, loss=0.127065, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:1:5\n",
      "2021-07-29 20:29:13 [INFO]\t[TRAIN] Epoch=32/32, Step=48/90, loss=0.001382, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:1:3\n",
      "2021-07-29 20:29:15 [INFO]\t[TRAIN] Epoch=32/32, Step=50/90, loss=0.001492, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:1:1\n",
      "2021-07-29 20:29:17 [INFO]\t[TRAIN] Epoch=32/32, Step=52/90, loss=0.009758, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:0:58\n",
      "2021-07-29 20:29:19 [INFO]\t[TRAIN] Epoch=32/32, Step=54/90, loss=0.000676, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:0:55\n",
      "2021-07-29 20:29:21 [INFO]\t[TRAIN] Epoch=32/32, Step=56/90, loss=0.015413, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:0:53\n",
      "2021-07-29 20:29:24 [INFO]\t[TRAIN] Epoch=32/32, Step=58/90, loss=0.017228, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:0:51\n",
      "2021-07-29 20:29:26 [INFO]\t[TRAIN] Epoch=32/32, Step=60/90, loss=0.764225, acc1=0.75, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:0:49\n",
      "2021-07-29 20:29:28 [INFO]\t[TRAIN] Epoch=32/32, Step=62/90, loss=0.03236, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.07s, eta=0:0:47\n",
      "2021-07-29 20:29:30 [INFO]\t[TRAIN] Epoch=32/32, Step=64/90, loss=0.041944, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:0:45\n",
      "2021-07-29 20:29:32 [INFO]\t[TRAIN] Epoch=32/32, Step=66/90, loss=0.012451, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:0:42\n",
      "2021-07-29 20:29:34 [INFO]\t[TRAIN] Epoch=32/32, Step=68/90, loss=0.019511, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.04s, eta=0:0:40\n",
      "2021-07-29 20:29:36 [INFO]\t[TRAIN] Epoch=32/32, Step=70/90, loss=0.022563, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.05s, eta=0:0:38\n",
      "2021-07-29 20:29:39 [INFO]\t[TRAIN] Epoch=32/32, Step=72/90, loss=0.001409, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.06s, eta=0:0:36\n",
      "2021-07-29 20:29:41 [INFO]\t[TRAIN] Epoch=32/32, Step=74/90, loss=0.003237, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.09s, eta=0:0:35\n",
      "2021-07-29 20:29:43 [INFO]\t[TRAIN] Epoch=32/32, Step=76/90, loss=0.020041, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.1s, eta=0:0:33\n",
      "2021-07-29 20:29:46 [INFO]\t[TRAIN] Epoch=32/32, Step=78/90, loss=0.003709, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.12s, eta=0:0:31\n",
      "2021-07-29 20:29:48 [INFO]\t[TRAIN] Epoch=32/32, Step=80/90, loss=0.004875, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.13s, eta=0:0:29\n",
      "2021-07-29 20:29:50 [INFO]\t[TRAIN] Epoch=32/32, Step=82/90, loss=0.014279, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.12s, eta=0:0:26\n",
      "2021-07-29 20:29:52 [INFO]\t[TRAIN] Epoch=32/32, Step=84/90, loss=0.123219, acc1=0.875, acc2=1.0, lr=2.5e-05, time_each_step=1.12s, eta=0:0:24\n",
      "2021-07-29 20:29:54 [INFO]\t[TRAIN] Epoch=32/32, Step=86/90, loss=0.001436, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.12s, eta=0:0:22\n",
      "2021-07-29 20:29:56 [INFO]\t[TRAIN] Epoch=32/32, Step=88/90, loss=0.023147, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.12s, eta=0:0:19\n",
      "2021-07-29 20:29:58 [INFO]\t[TRAIN] Epoch=32/32, Step=90/90, loss=0.001625, acc1=1.0, acc2=1.0, lr=2.5e-05, time_each_step=1.08s, eta=0:0:17\n",
      "2021-07-29 20:29:58 [INFO]\t[TRAIN] Epoch 32 finished, loss=0.038402, acc1=0.9875, acc2=1.0, lr=2.5e-05 .\n",
      "2021-07-29 20:29:58 [INFO]\tStart to evaluating(total_samples=80, total_steps=10)...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 10/10 [00:17<00:00,  1.80s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2021-07-29 20:30:16 [INFO]\t[EVAL] Finished, Epoch=32, acc1=0.975, acc2=1.0 .\n",
      "2021-07-29 20:30:16 [INFO]\tModel saved in output/mobilenetv3_small_ssld/epoch_32.\n",
      "2021-07-29 20:30:16 [INFO]\tCurrent evaluated best model in eval_dataset is epoch_5, acc1=0.9875\n"
     ]
    }
   ],
   "source": [
    "model = pdx.cls.MobileNetV3_small_ssld(num_classes=2)\r\n",
    "model.train(num_epochs=32,\r\n",
    "            train_dataset=train_dataset,\r\n",
    "            train_batch_size=8,\r\n",
    "            eval_dataset=eval_dataset,\r\n",
    "            lr_decay_epochs=[4, 6, 8],\r\n",
    "            save_interval_epochs=1,\r\n",
    "            learning_rate=0.025,\r\n",
    "            save_dir='output/mobilenetv3_small_ssld',\r\n",
    "            # resume_checkpoint='output/mobilenetv3_small_ssld/epoch_18',\r\n",
    "            use_vdl=True)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": false
   },
   "source": [
    "### 训练结果\n",
    "![](https://ai-studio-static-online.cdn.bcebos.com/9709e55d214447e9a2345c31be5f649ed4ad43cc8399436f95880931453e5d16)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": false
   },
   "source": [
    "# 五、开始预测"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": false
   },
   "source": [
    "## 1.环境配置"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "# 设置使用0号GPU卡（如无GPU，执行此代码后仍然会使用CPU训练模型）\r\n",
    "import matplotlib\r\n",
    "matplotlib.use('Agg') \r\n",
    "import os\r\n",
    "os.environ['CUDA_VISIBLE_DEVICES'] = '0'\r\n",
    "import paddlex as pdx"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": false
   },
   "source": [
    "## 2.预测数据集生成"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "# 预测数据集val_list\r\n",
    "val_list=[]\r\n",
    "for i in range(1,401,1):\r\n",
    "# for i in range(1,201,1):\r\n",
    "    filename='T'+ str(i).zfill(4)+'.jpg'\r\n",
    "    # print(filename)\r\n",
    "    val_list.append(filename+'\\n')\r\n",
    "\r\n",
    "with open('val_list.txt','w') as f:\r\n",
    "    f.writelines(val_list)\r\n",
    "    \r\n",
    "val_list=[]\r\n",
    "with open('val_list.txt', 'r') as f:\r\n",
    "    for line in f:\r\n",
    "        line='dataset/PALM-Testing400-Images/'+line\r\n",
    "        val_list.append(line.split('\\n')[0])\r\n",
    "        # print(line.split('\\n')[0])\r\n",
    "# print(val_list)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "400\n"
     ]
    }
   ],
   "source": [
    "print(len(val_list))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": false
   },
   "source": [
    "## 4.预测结果"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/paddle/fluid/layers/math_op_patch.py:298: UserWarning: /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/paddlex/cv/nets/mobilenet_v3.py:231\n",
      "The behavior of expression A * B has been unified with elementwise_mul(X, Y, axis=-1) from Paddle 2.0. If your code works well in the older versions but crashes in this version, try to use elementwise_mul(X, Y, axis=0) instead of A * B. This transitional warning will be dropped in the future.\n",
      "  op_type, op_type, EXPRESSION_MAP[method_name]))\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2021-07-29 20:44:50 [INFO]\tModel[MobileNetV3_small_ssld] loaded.\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99996746}, {'category_id': 0, 'category': '0', 'score': 3.256773e-05}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99440926}, {'category_id': 1, 'category': '1', 'score': 0.0055906908}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.999905}, {'category_id': 1, 'category': '1', 'score': 9.5048505e-05}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9369297}, {'category_id': 0, 'category': '0', 'score': 0.06307025}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9968761}, {'category_id': 0, 'category': '0', 'score': 0.0031238354}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9994512}, {'category_id': 1, 'category': '1', 'score': 0.0005487417}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99670094}, {'category_id': 0, 'category': '0', 'score': 0.003298993}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99999917}, {'category_id': 0, 'category': '0', 'score': 8.8519414e-07}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9994265}, {'category_id': 0, 'category': '0', 'score': 0.0005735666}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9998275}, {'category_id': 0, 'category': '0', 'score': 0.00017251496}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999945}, {'category_id': 0, 'category': '0', 'score': 5.5197315e-06}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9989907}, {'category_id': 0, 'category': '0', 'score': 0.0010093182}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9926555}, {'category_id': 0, 'category': '0', 'score': 0.0073444564}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.96291685}, {'category_id': 0, 'category': '0', 'score': 0.037083197}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9846534}, {'category_id': 0, 'category': '0', 'score': 0.015346625}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99998736}, {'category_id': 1, 'category': '1', 'score': 1.2595578e-05}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9999957}, {'category_id': 1, 'category': '1', 'score': 4.28643e-06}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999976}, {'category_id': 0, 'category': '0', 'score': 2.4110202e-06}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9995517}, {'category_id': 1, 'category': '1', 'score': 0.00044826043}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9640608}, {'category_id': 0, 'category': '0', 'score': 0.035939183}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.997537}, {'category_id': 1, 'category': '1', 'score': 0.002462966}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99991393}, {'category_id': 1, 'category': '1', 'score': 8.606456e-05}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9994855}, {'category_id': 0, 'category': '0', 'score': 0.00051449664}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99762446}, {'category_id': 1, 'category': '1', 'score': 0.0023755697}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99995315}, {'category_id': 1, 'category': '1', 'score': 4.6829013e-05}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999964}, {'category_id': 0, 'category': '0', 'score': 3.5769294e-06}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9989115}, {'category_id': 1, 'category': '1', 'score': 0.0010885436}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9996842}, {'category_id': 1, 'category': '1', 'score': 0.0003157477}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999912}, {'category_id': 0, 'category': '0', 'score': 8.850457e-06}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.997726}, {'category_id': 1, 'category': '1', 'score': 0.002274008}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9998369}, {'category_id': 1, 'category': '1', 'score': 0.00016308048}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9997745}, {'category_id': 1, 'category': '1', 'score': 0.00022543568}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99920446}, {'category_id': 1, 'category': '1', 'score': 0.0007955688}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99999976}, {'category_id': 0, 'category': '0', 'score': 2.01405e-07}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99590355}, {'category_id': 0, 'category': '0', 'score': 0.004096428}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 1.0}, {'category_id': 0, 'category': '0', 'score': 1.7822901e-09}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99999917}, {'category_id': 0, 'category': '0', 'score': 8.71266e-07}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.98532575}, {'category_id': 0, 'category': '0', 'score': 0.014674219}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9999896}, {'category_id': 1, 'category': '1', 'score': 1.0422564e-05}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.96640855}, {'category_id': 1, 'category': '1', 'score': 0.033591487}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9715613}, {'category_id': 0, 'category': '0', 'score': 0.028438667}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99991286}, {'category_id': 1, 'category': '1', 'score': 8.715225e-05}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9889791}, {'category_id': 0, 'category': '0', 'score': 0.011020891}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99627507}, {'category_id': 1, 'category': '1', 'score': 0.0037249988}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99943393}, {'category_id': 1, 'category': '1', 'score': 0.0005660926}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9997663}, {'category_id': 1, 'category': '1', 'score': 0.00023368286}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9999893}, {'category_id': 1, 'category': '1', 'score': 1.0737227e-05}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99985135}, {'category_id': 1, 'category': '1', 'score': 0.00014868288}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9994147}, {'category_id': 1, 'category': '1', 'score': 0.00058530644}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99988186}, {'category_id': 0, 'category': '0', 'score': 0.00011815308}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999999}, {'category_id': 0, 'category': '0', 'score': 7.584462e-08}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99982953}, {'category_id': 1, 'category': '1', 'score': 0.00017042903}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9998616}, {'category_id': 1, 'category': '1', 'score': 0.00013833385}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 1.0}, {'category_id': 0, 'category': '0', 'score': 1.9769297e-08}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.999619}, {'category_id': 0, 'category': '0', 'score': 0.00038098815}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.8449566}, {'category_id': 1, 'category': '1', 'score': 0.15504344}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9930292}, {'category_id': 1, 'category': '1', 'score': 0.0069707995}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999865}, {'category_id': 0, 'category': '0', 'score': 1.3521347e-05}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999999}, {'category_id': 0, 'category': '0', 'score': 9.081482e-08}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9673486}, {'category_id': 1, 'category': '1', 'score': 0.032651424}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99982315}, {'category_id': 0, 'category': '0', 'score': 0.00017687766}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.984054}, {'category_id': 1, 'category': '1', 'score': 0.01594597}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.998086}, {'category_id': 1, 'category': '1', 'score': 0.0019140654}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 1.0}, {'category_id': 0, 'category': '0', 'score': 1.542618e-08}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.59812427}, {'category_id': 1, 'category': '1', 'score': 0.40187573}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999641}, {'category_id': 0, 'category': '0', 'score': 3.5845293e-05}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9995338}, {'category_id': 0, 'category': '0', 'score': 0.00046619924}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9991296}, {'category_id': 1, 'category': '1', 'score': 0.00087041507}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 1.0}, {'category_id': 0, 'category': '0', 'score': 5.6058322e-09}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99995947}, {'category_id': 1, 'category': '1', 'score': 4.0514675e-05}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99999654}, {'category_id': 0, 'category': '0', 'score': 3.4199236e-06}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99537647}, {'category_id': 0, 'category': '0', 'score': 0.0046235523}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99999964}, {'category_id': 0, 'category': '0', 'score': 3.8840452e-07}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99917275}, {'category_id': 0, 'category': '0', 'score': 0.0008272286}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9898526}, {'category_id': 0, 'category': '0', 'score': 0.010147401}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99993813}, {'category_id': 1, 'category': '1', 'score': 6.1820145e-05}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9999839}, {'category_id': 1, 'category': '1', 'score': 1.6034475e-05}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9985989}, {'category_id': 1, 'category': '1', 'score': 0.0014011454}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9997248}, {'category_id': 0, 'category': '0', 'score': 0.00027523586}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.98003346}, {'category_id': 0, 'category': '0', 'score': 0.019966586}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.96043146}, {'category_id': 0, 'category': '0', 'score': 0.039568514}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9787976}, {'category_id': 0, 'category': '0', 'score': 0.021202365}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99511933}, {'category_id': 1, 'category': '1', 'score': 0.0048807166}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.999519}, {'category_id': 1, 'category': '1', 'score': 0.0004809762}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9983119}, {'category_id': 0, 'category': '0', 'score': 0.0016881413}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9973285}, {'category_id': 0, 'category': '0', 'score': 0.002671491}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 1.0}, {'category_id': 0, 'category': '0', 'score': 8.690469e-09}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999912}, {'category_id': 0, 'category': '0', 'score': 8.790782e-06}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.999905}, {'category_id': 1, 'category': '1', 'score': 9.502765e-05}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9998344}, {'category_id': 1, 'category': '1', 'score': 0.0001655217}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999689}, {'category_id': 0, 'category': '0', 'score': 3.1072326e-05}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 1.0}, {'category_id': 0, 'category': '0', 'score': 1.6787459e-08}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.98529667}, {'category_id': 1, 'category': '1', 'score': 0.014703345}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9184908}, {'category_id': 1, 'category': '1', 'score': 0.08150914}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99847823}, {'category_id': 1, 'category': '1', 'score': 0.0015217279}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9434492}, {'category_id': 1, 'category': '1', 'score': 0.056550805}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 1.0}, {'category_id': 0, 'category': '0', 'score': 8.2455615e-10}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99510634}, {'category_id': 1, 'category': '1', 'score': 0.004893679}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9999218}, {'category_id': 1, 'category': '1', 'score': 7.825082e-05}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.998765}, {'category_id': 0, 'category': '0', 'score': 0.0012350631}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99819523}, {'category_id': 0, 'category': '0', 'score': 0.0018047598}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.999987}, {'category_id': 0, 'category': '0', 'score': 1.2982603e-05}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99318826}, {'category_id': 1, 'category': '1', 'score': 0.006811769}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99997795}, {'category_id': 1, 'category': '1', 'score': 2.208313e-05}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.999252}, {'category_id': 0, 'category': '0', 'score': 0.000747967}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.999944}, {'category_id': 0, 'category': '0', 'score': 5.6020075e-05}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 1.0}, {'category_id': 0, 'category': '0', 'score': 4.448707e-10}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9999589}, {'category_id': 1, 'category': '1', 'score': 4.1073505e-05}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9998411}, {'category_id': 0, 'category': '0', 'score': 0.00015882948}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99459237}, {'category_id': 0, 'category': '0', 'score': 0.0054076593}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99983203}, {'category_id': 1, 'category': '1', 'score': 0.00016789156}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9998447}, {'category_id': 1, 'category': '1', 'score': 0.00015534322}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99999833}, {'category_id': 0, 'category': '0', 'score': 1.6356227e-06}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9998405}, {'category_id': 0, 'category': '0', 'score': 0.00015942853}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99987376}, {'category_id': 0, 'category': '0', 'score': 0.00012621784}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 1.0}, {'category_id': 0, 'category': '0', 'score': 5.5810517e-08}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.97872704}, {'category_id': 1, 'category': '1', 'score': 0.021272942}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9924454}, {'category_id': 1, 'category': '1', 'score': 0.0075546377}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99978703}, {'category_id': 1, 'category': '1', 'score': 0.00021299822}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99184555}, {'category_id': 1, 'category': '1', 'score': 0.008154522}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9997943}, {'category_id': 1, 'category': '1', 'score': 0.0002057683}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9997266}, {'category_id': 0, 'category': '0', 'score': 0.00027344158}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999597}, {'category_id': 0, 'category': '0', 'score': 4.031584e-05}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99999774}, {'category_id': 0, 'category': '0', 'score': 2.2255995e-06}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9992347}, {'category_id': 1, 'category': '1', 'score': 0.00076530175}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.999742}, {'category_id': 0, 'category': '0', 'score': 0.00025796334}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9995889}, {'category_id': 0, 'category': '0', 'score': 0.00041112024}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99988425}, {'category_id': 1, 'category': '1', 'score': 0.000115735114}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9997261}, {'category_id': 1, 'category': '1', 'score': 0.0002738501}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99999344}, {'category_id': 0, 'category': '0', 'score': 6.5824493e-06}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9941519}, {'category_id': 0, 'category': '0', 'score': 0.005848075}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.57687944}, {'category_id': 1, 'category': '1', 'score': 0.4231206}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999976}, {'category_id': 0, 'category': '0', 'score': 2.3875873e-06}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99994326}, {'category_id': 0, 'category': '0', 'score': 5.6782366e-05}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.96958923}, {'category_id': 1, 'category': '1', 'score': 0.030410787}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999974}, {'category_id': 0, 'category': '0', 'score': 2.6045855e-06}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9080642}, {'category_id': 0, 'category': '0', 'score': 0.091935806}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99978334}, {'category_id': 1, 'category': '1', 'score': 0.00021670538}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999975}, {'category_id': 0, 'category': '0', 'score': 2.5233437e-06}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.56129396}, {'category_id': 1, 'category': '1', 'score': 0.43870604}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.91133726}, {'category_id': 0, 'category': '0', 'score': 0.088662736}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9996841}, {'category_id': 0, 'category': '0', 'score': 0.00031591242}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99999964}, {'category_id': 0, 'category': '0', 'score': 4.0970795e-07}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99929965}, {'category_id': 1, 'category': '1', 'score': 0.00070039835}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99116045}, {'category_id': 0, 'category': '0', 'score': 0.008839619}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9897441}, {'category_id': 1, 'category': '1', 'score': 0.010255898}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9999913}, {'category_id': 1, 'category': '1', 'score': 8.7066655e-06}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99979395}, {'category_id': 0, 'category': '0', 'score': 0.00020608344}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9999856}, {'category_id': 1, 'category': '1', 'score': 1.4468321e-05}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9998134}, {'category_id': 0, 'category': '0', 'score': 0.0001866298}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99999917}, {'category_id': 0, 'category': '0', 'score': 8.039862e-07}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.6112352}, {'category_id': 0, 'category': '0', 'score': 0.38876486}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99525213}, {'category_id': 0, 'category': '0', 'score': 0.004747853}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999995}, {'category_id': 0, 'category': '0', 'score': 5.295465e-07}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999548}, {'category_id': 0, 'category': '0', 'score': 4.5127617e-05}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99996126}, {'category_id': 1, 'category': '1', 'score': 3.878781e-05}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99997115}, {'category_id': 1, 'category': '1', 'score': 2.8847708e-05}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99999964}, {'category_id': 0, 'category': '0', 'score': 4.020169e-07}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9983455}, {'category_id': 0, 'category': '0', 'score': 0.0016544838}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99989593}, {'category_id': 0, 'category': '0', 'score': 0.00010406923}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99914753}, {'category_id': 1, 'category': '1', 'score': 0.00085250253}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9997613}, {'category_id': 1, 'category': '1', 'score': 0.00023876493}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99273324}, {'category_id': 1, 'category': '1', 'score': 0.0072667464}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.999828}, {'category_id': 1, 'category': '1', 'score': 0.00017203072}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9995413}, {'category_id': 1, 'category': '1', 'score': 0.00045878696}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99999}, {'category_id': 0, 'category': '0', 'score': 1.0004376e-05}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999987}, {'category_id': 0, 'category': '0', 'score': 1.3603857e-06}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99994326}, {'category_id': 1, 'category': '1', 'score': 5.6688707e-05}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99985945}, {'category_id': 1, 'category': '1', 'score': 0.00014047329}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99975175}, {'category_id': 0, 'category': '0', 'score': 0.00024824595}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99553716}, {'category_id': 1, 'category': '1', 'score': 0.0044628815}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99984515}, {'category_id': 0, 'category': '0', 'score': 0.00015482742}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.999962}, {'category_id': 0, 'category': '0', 'score': 3.80596e-05}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 1.0}, {'category_id': 0, 'category': '0', 'score': 7.520429e-09}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999981}, {'category_id': 0, 'category': '0', 'score': 1.944798e-06}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.999997}, {'category_id': 0, 'category': '0', 'score': 3.0307672e-06}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999989}, {'category_id': 0, 'category': '0', 'score': 1.0930686e-06}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99999404}, {'category_id': 0, 'category': '0', 'score': 6.012387e-06}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99979585}, {'category_id': 1, 'category': '1', 'score': 0.00020413131}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9998517}, {'category_id': 0, 'category': '0', 'score': 0.00014830213}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99999976}, {'category_id': 0, 'category': '0', 'score': 1.882493e-07}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99999595}, {'category_id': 0, 'category': '0', 'score': 4.0062896e-06}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.98170704}, {'category_id': 0, 'category': '0', 'score': 0.018292995}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9999385}, {'category_id': 1, 'category': '1', 'score': 6.148937e-05}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99925476}, {'category_id': 1, 'category': '1', 'score': 0.0007452317}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9998367}, {'category_id': 1, 'category': '1', 'score': 0.00016333694}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9999994}, {'category_id': 1, 'category': '1', 'score': 5.5916263e-07}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99965763}, {'category_id': 0, 'category': '0', 'score': 0.0003424263}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99908924}, {'category_id': 1, 'category': '1', 'score': 0.0009108017}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999995}, {'category_id': 0, 'category': '0', 'score': 4.6183905e-07}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.78138584}, {'category_id': 0, 'category': '0', 'score': 0.21861418}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.94956464}, {'category_id': 1, 'category': '1', 'score': 0.050435398}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99970895}, {'category_id': 1, 'category': '1', 'score': 0.00029107882}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99999917}, {'category_id': 0, 'category': '0', 'score': 8.8519414e-07}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99392694}, {'category_id': 1, 'category': '1', 'score': 0.00607314}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999957}, {'category_id': 0, 'category': '0', 'score': 4.313971e-06}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9998253}, {'category_id': 1, 'category': '1', 'score': 0.0001747715}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 1.0}, {'category_id': 0, 'category': '0', 'score': 1.2486021e-08}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9995944}, {'category_id': 1, 'category': '1', 'score': 0.00040565926}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9998398}, {'category_id': 1, 'category': '1', 'score': 0.00016020235}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9985251}, {'category_id': 0, 'category': '0', 'score': 0.0014749483}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9999893}, {'category_id': 1, 'category': '1', 'score': 1.07595215e-05}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 1.0}, {'category_id': 0, 'category': '0', 'score': 2.557098e-08}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9998198}, {'category_id': 1, 'category': '1', 'score': 0.00018020505}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99988806}, {'category_id': 1, 'category': '1', 'score': 0.000111874855}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9941519}, {'category_id': 0, 'category': '0', 'score': 0.0058480944}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999609}, {'category_id': 0, 'category': '0', 'score': 3.91314e-05}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999962}, {'category_id': 0, 'category': '0', 'score': 3.834192e-06}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9997979}, {'category_id': 0, 'category': '0', 'score': 0.00020212193}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99999785}, {'category_id': 0, 'category': '0', 'score': 2.1610458e-06}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999993}, {'category_id': 0, 'category': '0', 'score': 6.9357077e-07}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99978393}, {'category_id': 1, 'category': '1', 'score': 0.00021603673}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999995}, {'category_id': 0, 'category': '0', 'score': 4.326532e-07}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9997845}, {'category_id': 1, 'category': '1', 'score': 0.00021548315}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9998554}, {'category_id': 1, 'category': '1', 'score': 0.00014461465}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99997795}, {'category_id': 1, 'category': '1', 'score': 2.206974e-05}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9927436}, {'category_id': 1, 'category': '1', 'score': 0.0072563402}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99906904}, {'category_id': 0, 'category': '0', 'score': 0.0009310291}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.7988736}, {'category_id': 0, 'category': '0', 'score': 0.20112644}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99957067}, {'category_id': 0, 'category': '0', 'score': 0.0004292964}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99999976}, {'category_id': 0, 'category': '0', 'score': 2.2735325e-07}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999999}, {'category_id': 0, 'category': '0', 'score': 1.6282785e-07}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999999}, {'category_id': 0, 'category': '0', 'score': 7.776698e-08}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99973625}, {'category_id': 1, 'category': '1', 'score': 0.0002637858}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9511932}, {'category_id': 0, 'category': '0', 'score': 0.04880676}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9896824}, {'category_id': 1, 'category': '1', 'score': 0.01031759}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9806341}, {'category_id': 0, 'category': '0', 'score': 0.019365838}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9997266}, {'category_id': 1, 'category': '1', 'score': 0.0002733722}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99995303}, {'category_id': 1, 'category': '1', 'score': 4.696358e-05}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99287486}, {'category_id': 1, 'category': '1', 'score': 0.0071251625}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 1.0}, {'category_id': 0, 'category': '0', 'score': 1.4114331e-09}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99805045}, {'category_id': 0, 'category': '0', 'score': 0.0019495757}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.96056867}, {'category_id': 1, 'category': '1', 'score': 0.039431356}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9160371}, {'category_id': 1, 'category': '1', 'score': 0.08396286}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9511148}, {'category_id': 0, 'category': '0', 'score': 0.04888515}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9548029}, {'category_id': 0, 'category': '0', 'score': 0.04519715}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999274}, {'category_id': 0, 'category': '0', 'score': 7.265176e-05}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99999726}, {'category_id': 0, 'category': '0', 'score': 2.7522078e-06}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.7479136}, {'category_id': 0, 'category': '0', 'score': 0.25208634}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999999}, {'category_id': 0, 'category': '0', 'score': 1.6367025e-07}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 1.0}, {'category_id': 0, 'category': '0', 'score': 1.3163465e-08}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 1.0}, {'category_id': 0, 'category': '0', 'score': 3.1021134e-08}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9801032}, {'category_id': 1, 'category': '1', 'score': 0.01989679}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999994}, {'category_id': 0, 'category': '0', 'score': 6.218309e-07}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.999977}, {'category_id': 1, 'category': '1', 'score': 2.3058477e-05}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999999}, {'category_id': 0, 'category': '0', 'score': 1.09582864e-07}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9999956}, {'category_id': 1, 'category': '1', 'score': 4.3522036e-06}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99354607}, {'category_id': 1, 'category': '1', 'score': 0.0064539094}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9968009}, {'category_id': 1, 'category': '1', 'score': 0.0031990435}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999999}, {'category_id': 0, 'category': '0', 'score': 1.2536569e-07}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.999995}, {'category_id': 0, 'category': '0', 'score': 5.000713e-06}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9368333}, {'category_id': 1, 'category': '1', 'score': 0.06316669}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.6600434}, {'category_id': 0, 'category': '0', 'score': 0.3399566}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99983907}, {'category_id': 1, 'category': '1', 'score': 0.00016085272}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99991107}, {'category_id': 1, 'category': '1', 'score': 8.892357e-05}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99997103}, {'category_id': 0, 'category': '0', 'score': 2.8974451e-05}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.98233837}, {'category_id': 1, 'category': '1', 'score': 0.017661545}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9545464}, {'category_id': 1, 'category': '1', 'score': 0.04545364}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99992204}, {'category_id': 1, 'category': '1', 'score': 7.7973426e-05}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999994}, {'category_id': 0, 'category': '0', 'score': 6.039346e-07}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99999976}, {'category_id': 0, 'category': '0', 'score': 2.487525e-07}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99934405}, {'category_id': 1, 'category': '1', 'score': 0.0006559908}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999995}, {'category_id': 0, 'category': '0', 'score': 4.845102e-07}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999596}, {'category_id': 0, 'category': '0', 'score': 4.0418818e-05}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99961215}, {'category_id': 1, 'category': '1', 'score': 0.0003878235}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999988}, {'category_id': 0, 'category': '0', 'score': 1.2173017e-06}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99964416}, {'category_id': 1, 'category': '1', 'score': 0.00035589177}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999926}, {'category_id': 0, 'category': '0', 'score': 7.357519e-06}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.98858345}, {'category_id': 1, 'category': '1', 'score': 0.011416508}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9992599}, {'category_id': 0, 'category': '0', 'score': 0.00074011757}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99973506}, {'category_id': 0, 'category': '0', 'score': 0.00026491517}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.999889}, {'category_id': 0, 'category': '0', 'score': 0.00011096413}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 1.0}, {'category_id': 0, 'category': '0', 'score': 1.4021739e-08}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9998443}, {'category_id': 1, 'category': '1', 'score': 0.00015560917}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.98687565}, {'category_id': 0, 'category': '0', 'score': 0.013124378}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 1.0}, {'category_id': 0, 'category': '0', 'score': 3.372634e-08}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9847254}, {'category_id': 1, 'category': '1', 'score': 0.015274533}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99999845}, {'category_id': 0, 'category': '0', 'score': 1.5554634e-06}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999814}, {'category_id': 0, 'category': '0', 'score': 1.8560135e-05}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9998965}, {'category_id': 1, 'category': '1', 'score': 0.00010349071}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99965787}, {'category_id': 1, 'category': '1', 'score': 0.00034210226}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9997085}, {'category_id': 0, 'category': '0', 'score': 0.00029147978}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9999832}, {'category_id': 1, 'category': '1', 'score': 1.6819125e-05}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9998883}, {'category_id': 1, 'category': '1', 'score': 0.00011171987}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9989825}, {'category_id': 1, 'category': '1', 'score': 0.0010174297}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9968009}, {'category_id': 1, 'category': '1', 'score': 0.0031990435}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9977276}, {'category_id': 1, 'category': '1', 'score': 0.0022724052}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999969}, {'category_id': 0, 'category': '0', 'score': 3.0478304e-06}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.6624462}, {'category_id': 1, 'category': '1', 'score': 0.33755374}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9989366}, {'category_id': 1, 'category': '1', 'score': 0.0010634146}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9998276}, {'category_id': 1, 'category': '1', 'score': 0.00017233295}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99138767}, {'category_id': 1, 'category': '1', 'score': 0.00861229}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99712473}, {'category_id': 1, 'category': '1', 'score': 0.0028752633}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99999726}, {'category_id': 1, 'category': '1', 'score': 2.7166127e-06}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99783176}, {'category_id': 1, 'category': '1', 'score': 0.0021682302}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99988604}, {'category_id': 1, 'category': '1', 'score': 0.00011398676}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.88623035}, {'category_id': 1, 'category': '1', 'score': 0.11376967}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99986196}, {'category_id': 1, 'category': '1', 'score': 0.0001380815}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99999976}, {'category_id': 0, 'category': '0', 'score': 2.379599e-07}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999981}, {'category_id': 0, 'category': '0', 'score': 1.8926218e-06}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9999056}, {'category_id': 1, 'category': '1', 'score': 9.444838e-05}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99918765}, {'category_id': 1, 'category': '1', 'score': 0.00081229996}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99999964}, {'category_id': 0, 'category': '0', 'score': 3.6054746e-07}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9998553}, {'category_id': 1, 'category': '1', 'score': 0.00014465104}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99898595}, {'category_id': 1, 'category': '1', 'score': 0.0010140884}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999999}, {'category_id': 0, 'category': '0', 'score': 1.1675297e-07}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9851757}, {'category_id': 1, 'category': '1', 'score': 0.0148242}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9917493}, {'category_id': 1, 'category': '1', 'score': 0.008250788}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9993137}, {'category_id': 1, 'category': '1', 'score': 0.0006863045}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.96180993}, {'category_id': 1, 'category': '1', 'score': 0.03819007}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99999785}, {'category_id': 0, 'category': '0', 'score': 2.1296896e-06}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99763715}, {'category_id': 0, 'category': '0', 'score': 0.0023628485}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99918574}, {'category_id': 1, 'category': '1', 'score': 0.0008142157}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99091303}, {'category_id': 0, 'category': '0', 'score': 0.009086974}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999981}, {'category_id': 0, 'category': '0', 'score': 1.9605222e-06}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.98192906}, {'category_id': 1, 'category': '1', 'score': 0.018070964}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.96904415}, {'category_id': 1, 'category': '1', 'score': 0.030955886}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99855155}, {'category_id': 1, 'category': '1', 'score': 0.0014484712}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99999774}, {'category_id': 0, 'category': '0', 'score': 2.251482e-06}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 1.0}, {'category_id': 0, 'category': '0', 'score': 3.320549e-08}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99999964}, {'category_id': 0, 'category': '0', 'score': 3.3199765e-07}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9883178}, {'category_id': 1, 'category': '1', 'score': 0.011682275}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9992729}, {'category_id': 1, 'category': '1', 'score': 0.0007271684}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99756086}, {'category_id': 1, 'category': '1', 'score': 0.0024391483}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99987113}, {'category_id': 0, 'category': '0', 'score': 0.0001288967}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99993885}, {'category_id': 0, 'category': '0', 'score': 6.1178915e-05}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.8205215}, {'category_id': 0, 'category': '0', 'score': 0.17947851}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99996233}, {'category_id': 1, 'category': '1', 'score': 3.765432e-05}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99999976}, {'category_id': 0, 'category': '0', 'score': 2.9032262e-07}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99998856}, {'category_id': 1, 'category': '1', 'score': 1.1406658e-05}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9988821}, {'category_id': 1, 'category': '1', 'score': 0.001117857}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9838562}, {'category_id': 0, 'category': '0', 'score': 0.016143728}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9998053}, {'category_id': 1, 'category': '1', 'score': 0.00019474015}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9999536}, {'category_id': 1, 'category': '1', 'score': 4.6362846e-05}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9999232}, {'category_id': 1, 'category': '1', 'score': 7.672044e-05}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.62141585}, {'category_id': 1, 'category': '1', 'score': 0.37858415}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99982554}, {'category_id': 1, 'category': '1', 'score': 0.00017454568}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99993753}, {'category_id': 0, 'category': '0', 'score': 6.244119e-05}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99999523}, {'category_id': 1, 'category': '1', 'score': 4.7102258e-06}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99998474}, {'category_id': 0, 'category': '0', 'score': 1.5246074e-05}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99999845}, {'category_id': 0, 'category': '0', 'score': 1.5092526e-06}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999436}, {'category_id': 0, 'category': '0', 'score': 5.6365006e-05}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9992918}, {'category_id': 1, 'category': '1', 'score': 0.0007081638}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999999}, {'category_id': 0, 'category': '0', 'score': 1.4516361e-07}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99998677}, {'category_id': 0, 'category': '0', 'score': 1.32482955e-05}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999995}, {'category_id': 0, 'category': '0', 'score': 5.281102e-07}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99998224}, {'category_id': 0, 'category': '0', 'score': 1.7813582e-05}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9990694}, {'category_id': 1, 'category': '1', 'score': 0.0009306077}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9980812}, {'category_id': 0, 'category': '0', 'score': 0.0019187697}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999999}, {'category_id': 0, 'category': '0', 'score': 8.46124e-08}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99996114}, {'category_id': 0, 'category': '0', 'score': 3.8851555e-05}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99994516}, {'category_id': 0, 'category': '0', 'score': 5.4787713e-05}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999068}, {'category_id': 0, 'category': '0', 'score': 9.3266455e-05}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9998373}, {'category_id': 0, 'category': '0', 'score': 0.0001627201}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.6467517}, {'category_id': 1, 'category': '1', 'score': 0.35324833}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999999}, {'category_id': 0, 'category': '0', 'score': 1.2962505e-07}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99996006}, {'category_id': 1, 'category': '1', 'score': 3.9888248e-05}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99997973}, {'category_id': 1, 'category': '1', 'score': 2.0215377e-05}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999893}, {'category_id': 0, 'category': '0', 'score': 1.0737309e-05}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99968636}, {'category_id': 0, 'category': '0', 'score': 0.00031363138}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99997914}, {'category_id': 1, 'category': '1', 'score': 2.0862639e-05}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9858366}, {'category_id': 1, 'category': '1', 'score': 0.014163394}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9966271}, {'category_id': 1, 'category': '1', 'score': 0.0033728916}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99997234}, {'category_id': 0, 'category': '0', 'score': 2.765005e-05}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99983954}, {'category_id': 1, 'category': '1', 'score': 0.00016043823}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99195874}, {'category_id': 1, 'category': '1', 'score': 0.008041312}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99844104}, {'category_id': 0, 'category': '0', 'score': 0.0015589471}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999987}, {'category_id': 0, 'category': '0', 'score': 1.3706984e-06}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99999654}, {'category_id': 0, 'category': '0', 'score': 3.4517564e-06}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.95705944}, {'category_id': 0, 'category': '0', 'score': 0.04294052}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99842393}, {'category_id': 0, 'category': '0', 'score': 0.0015761206}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99954885}, {'category_id': 0, 'category': '0', 'score': 0.0004511633}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99992466}, {'category_id': 0, 'category': '0', 'score': 7.531302e-05}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999982}, {'category_id': 0, 'category': '0', 'score': 1.8279447e-06}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99941695}, {'category_id': 0, 'category': '0', 'score': 0.00058306585}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9999174}, {'category_id': 1, 'category': '1', 'score': 8.257082e-05}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9967409}, {'category_id': 1, 'category': '1', 'score': 0.0032591748}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99797887}, {'category_id': 0, 'category': '0', 'score': 0.0020211346}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99775225}, {'category_id': 0, 'category': '0', 'score': 0.0022478036}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999709}, {'category_id': 0, 'category': '0', 'score': 2.9127295e-05}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99943346}, {'category_id': 1, 'category': '1', 'score': 0.0005665087}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9995474}, {'category_id': 1, 'category': '1', 'score': 0.00045258264}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.85746616}, {'category_id': 1, 'category': '1', 'score': 0.14253385}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9999771}, {'category_id': 1, 'category': '1', 'score': 2.2851322e-05}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.999984}, {'category_id': 1, 'category': '1', 'score': 1.6005235e-05}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9975635}, {'category_id': 1, 'category': '1', 'score': 0.0024365718}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99995375}, {'category_id': 0, 'category': '0', 'score': 4.6226338e-05}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999999}, {'category_id': 0, 'category': '0', 'score': 7.701653e-08}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9968472}, {'category_id': 1, 'category': '1', 'score': 0.0031527486}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.99982554}, {'category_id': 1, 'category': '1', 'score': 0.00017454568}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9975126}, {'category_id': 1, 'category': '1', 'score': 0.0024874725}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999963}, {'category_id': 0, 'category': '0', 'score': 3.720049e-06}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.99999976}, {'category_id': 0, 'category': '0', 'score': 2.3848446e-07}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999995}, {'category_id': 0, 'category': '0', 'score': 4.865875e-07}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999994}, {'category_id': 0, 'category': '0', 'score': 5.6871613e-07}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9983783}, {'category_id': 0, 'category': '0', 'score': 0.0016216702}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 1.0}, {'category_id': 0, 'category': '0', 'score': 1.093248e-08}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 1.0}, {'category_id': 0, 'category': '0', 'score': 1.2634143e-08}]\n",
      "Predict Result: [{'category_id': 0, 'category': '0', 'score': 0.9747789}, {'category_id': 1, 'category': '1', 'score': 0.02522114}]\n",
      "Predict Result: [{'category_id': 1, 'category': '1', 'score': 0.9999924}, {'category_id': 0, 'category': '0', 'score': 7.670853e-06}]\n"
     ]
    }
   ],
   "source": [
    "import paddlex as pdx\r\n",
    "\r\n",
    "result_list=[]\r\n",
    "model = pdx.load_model('output/mobilenetv3_small_ssld/best_model')\r\n",
    "for image_name in val_list:\r\n",
    "    result = model.predict(image_name, topk=2)\r\n",
    "    result_list.append(result)\r\n",
    "    print(\"Predict Result:\", result)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": false
   },
   "source": [
    "## 5.结果检查"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[{'category_id': 1, 'category': '1', 'score': 0.99996746}, {'category_id': 0, 'category': '0', 'score': 3.256773e-05}]\n",
      "1 0.99996746\n",
      "0 3.256773e-05\n"
     ]
    }
   ],
   "source": [
    "item = result_list[0]\r\n",
    "print(item)\r\n",
    "print(item[0]['category_id'],item[0]['score'])\r\n",
    "print(item[1]['category_id'],item[1]['score'])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": false
   },
   "source": [
    "# 六、结果提交"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": false
   },
   "source": [
    "## 1.构造pandas dataframe"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "# 结果列\r\n",
    "pd_B=[]\r\n",
    "for item in result_list:\r\n",
    "    # print(item)\r\n",
    "    if item[0]['category_id']==1:\r\n",
    "        pd_B.append(item[0]['score'])\r\n",
    "    else:\r\n",
    "        pd_B.append(item[1]['score'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "# 文件名列\r\n",
    "pd_A=[]\r\n",
    "with open('val_list.txt', 'r') as f:\r\n",
    "    for line in f:\r\n",
    "        pd_A.append(line.split('\\n')[0])\r\n",
    "        # print(line.split('\\n')[0])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "# 构造pandas的DataFrame\r\n",
    "import pandas as pd\r\n",
    "df= pd.DataFrame({'FileName': pd_A, 'PM Risk':pd_B})"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": false
   },
   "source": [
    "## 2.保存数据到csv文件"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "# 保存为提交文件\r\n",
    "df.to_csv(\"Classification_Results.csv\", index=None)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": false
   },
   "source": [
    "## 3.打压缩包下载提交"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "!zip -q Classification_Results.zip Classification_Results.csv"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": false
   },
   "source": [
    "# 七、分析总结\n",
    "## 1.提高图片尺寸，相应的可以提高预测精度\n",
    "## 2.使用其它数据增强方式\n",
    "## 3.更改模型 调整参数"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "PaddlePaddle 2.0.0b0 (Python 3.5)",
   "language": "python",
   "name": "py35-paddle1.2.0"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 1
}
